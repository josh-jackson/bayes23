<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>Bayesian Statistics 2023 - mlm</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">mlm</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="mlm-review" class="slide level2">
<h2>MLM review</h2>
<p><span class="math display">\[{\hat{Y}}_{i} = b_{0} + b_{1}X_{i} +  ... +\epsilon_{i}\]</span></p>
<p><span class="math display">\[{\hat{Y}}_{ij} = b_{0} + b_{1}X_{ij} + ... +\epsilon_{i}\]</span> Where j refers to some clustering or grouping variable and i refers to the observations within j</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>data <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/josh-jackson/bayes/master/mlm.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>mlm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>mlm <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">sample_n_of</span>(<span class="dv">20</span>, ID) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> CON, <span class="at">group =</span> ID, <span class="at">fill =</span> ID)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID)),<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="empty-model" class="slide level2">
<h2>Empty model</h2>
<p>Level 1 <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \varepsilon_{ij}\]</span></p>
<p>Level 2 <span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span></p>
<p><span class="math display">\[{U}_{0j} \sim \mathcal{N}(0, \tau_{00}^{2})\]</span> <span class="math display">\[{e}_{ij} \sim \mathcal{N}(0, \sigma^{2})\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mlm <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">sample_n_of</span>(<span class="dv">8</span>, ID) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> CON, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID)), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span><span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"><p><span class="math display">\[{Y}_{ij} = \gamma_{00} + U_{0j}  + \varepsilon_{ij}\]</span></p>
<p>Akin to ANOVA if we treat <span class="math inline">\(U_{0j}\)</span> as between subjects variance &amp; <span class="math inline">\(\varepsilon_{ij}\)</span> as within subjects variance.</p>
</section>
<section id="random-and-fixed-effects" class="slide level2">
<h2>Random and fixed effects</h2>
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span> Combined: <span class="math display">\[{Y}_{ij} = \gamma_{00} + U_{0j}  + \varepsilon_{ij}\]</span></p>
<p><span class="math inline">\(U_{0j}\)</span> is considered a random effect, as it is varies across our grouping</p>
<p><span class="math inline">\(\gamma_{00}\)</span> is considered a fixed effect, as it is what is fixed (average) across our grouping</p>
</section>
<section id="level-1-predictors" class="slide level2">
<h2>Level 1 predictors</h2>
<p>Level 1 is where you have data that repeats within your grouping or clustering data. Is your cluster classrooms? Then students are level 1. Is your cluster people? Then observations are level 1.</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Notice on the subscript of X that these predictors vary across group (j) and within the group (i) So if your grouping (j) is people, then i refers to different observations.</p>
</section>
<section class="slide level2">

<p>Level 2 takes the parameters at level 1 and decomposes them into a fixed component ( <span class="math inline">\(\gamma\)</span> ) that reflects the average and, if desired, the individual deviations around that fixed effect (U).</p>
<p>level 1 <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10}\]</span></p>
</section>
<section class="slide level2">

<p>Level 1:</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2:<br>
<span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} + U_{1j}\]</span></p>
<p>Combined <span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{10}(X_{ij})+ U_{0j} + U_{1j}(X_{ij}) + \varepsilon_{ij}\]</span></p>
<p>Can think of a persons score divided up into a fixed component as well as the random component.</p>
<p><span class="math display">\[{\beta}_{16} = \gamma_{10} \pm U_{16}\]</span></p>
</section>
<section id="error-structure" class="slide level2">
<h2>Error structure</h2>
<p>The residual structure, where the random effects are again normally distributed with a mean of zero, but this time one must also consider covariance in addition to variance.</p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim \mathcal{N} \begin{pmatrix}
  0,      \tau_{00}^{2} &amp; \tau_{01}\\
  0,  \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
<p>Note that it is possible to have a different error structure for the random effects</p>
<p><span class="math display">\[{e}_{ij} \sim \mathcal{N}(0, \sigma^{2})\]</span></p>
</section>
<section id="multiple-level-1-predictors" class="slide level2">
<h2>Multiple level 1 predictors</h2>
<p>Level 1:</p>
<p><span class="math display">\[{Y}_{ijk} = \beta_{0j}  + \beta_{1j}X_{ij} + \beta_{2j}Z_{ik} + \varepsilon_{ijk}\]</span> Level 2:<br>
<span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} + U_{1j}\]</span> <span class="math display">\[{\beta}_{2k} = \gamma_{20} + U_{2k}\]</span></p>
</section>
<section id="level-2-predictors" class="slide level2">
<h2>Level 2 predictors</h2>
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \gamma_{01}G_{j} +   U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10} + U_{1j}\]</span></p>
<p>Combined <span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{01}G_{j}+  \gamma_{10} (X_{ij}) + U_{0j} + U_{1j}(X_{ij}) + \varepsilon_{ij}\]</span> <span class="math display">\[{Y}_{ij} = [\gamma_{00} + \gamma_{01}G_{j}+ U_{0j}]  + [(\gamma_{10}  + U_{1j})(X_{ij})] + \varepsilon_{ij}\]</span></p>
</section>
<section id="cross-level-interactions" class="slide level2">
<h2>Cross level interactions</h2>
<p>level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \gamma_{01}G_{j} +   U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10} + \gamma_{11}G_{j} + U_{1j}\]</span><br>
<span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{01}G_{j}+  \gamma_{10} (X_{ij}) + \gamma_{11}(G_{j}*X{ij}) +  U_{0j} + U_{1j}(X{ij}) + \varepsilon_{ij}\]</span></p>
<p><span class="math display">\[{Y}_{ij} = [\gamma_{00} + U_{0j} +\gamma_{01}G_{j}] + [(\gamma_{10}  + \gamma_{11}G_{j}+  U_{1j})(X{ij})] + \varepsilon_{ij}\]</span></p>
</section>
<section id="centering" class="slide level2">
<h2>Centering</h2>
<p>As a rule, each level-1 predictor is usually really 2 predictor variables. It is important to separate within-group from between group variance. Failing to do so will “smush” between and within variance to level 1.</p>
<p>Example: student SES at level 1, with schools at level 2. Some kids have more money than other kids in their school Some schools have more money than other schools</p>
<p>Fortunately it is easy to separate this</p>
</section>
<section class="slide level2">

<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}(X_{ij}- \bar{X_j}) + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \bar{X_j} +   U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} + \bar{X_j} + U_{1j}\]</span></p>
</section>
<section id="mlm-as-default-and-make-it-maximum" class="slide level2">
<h2>MLM as default and make it maximum</h2>
<p>If you have data like this you should analyze like this! If you don’t, then you are losing information (GEE being a potential exception).</p>
<p>The question often is about which random effects to fit. There are multiple opinions, but mine is to start maximum, and then work downward (ie simplify) if necessary/consistent with theory. It doesn’t really hurt to include them, especially within Bayesian estimation!</p>
</section>
<section id="mlm-intuitions" class="slide level2">
<h2>MLM intuitions</h2>
<p>Anytime you have repeated DVs you should use MLM as opposed to doing aggregation outside the model. While that should be your default, it is helpful to conceptualize why it is helpful.</p>
<ol type="1">
<li>Aggregation is bad</li>
<li>Regressions within regressions (ie coefficients as outcomes)</li>
<li>Variance decomposition<br>
</li>
<li>Learning from other data through pooling/shrinkage</li>
<li>Parameters that depend on parameters</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>simp<span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="sc">~</span>ID, <span class="sc">~</span>group,  <span class="sc">~</span>test.score, <span class="sc">~</span>study,</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">3</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>What is the between person association between study and score?</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>What is the within person association?</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="ways-to-think-about-mlms" class="slide level2">
<h2>4 ways to think about MLMs</h2>
<ol type="1">
<li>Different levels of analysis (average/person specific or between/within)<br>
</li>
<li>Regressions within regressions (ie coefficients as outcomes)<br>
</li>
<li>Variance decomposition<br>
</li>
<li>Learning from other data through pooling/shrinkage</li>
</ol>
</section>
<section id="standard-regression" class="slide level2">
<h2>Standard regression</h2>
<p><span class="math display">\[{Y}_{i} = b_{0} + b_{1}X_{1} + b_{2}X_{2} + b_{3}X_{3}+... +\epsilon_{i}\]</span></p>
<p><span class="math display">\[\hat{Y}_{i} = b_{0} + b_{1}X_{1} + b_{2}X_{2} + b_{3}X_{3}+...\]</span></p>
<p>Parameters are considered fixed where one regression value corresponds to everyone. I.e., that association between X1 and Y is the same for everyone.</p>
<p>Each person has a Y, denoted by the subscript i, and each has a residual associated with them, also designated by i.</p>
</section>
<section id="handling-multiple-dvs" class="slide level2">
<h2>Handling multiple DVs?</h2>
<p>But what if people had more than 1 DV, like we do with time? What do you do with multiple items, multiple trials, multiple ____ ?</p>
<p>Two options: 1. Collapse and average across.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">library</span>(broom)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>simp<span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="sc">~</span>ID, <span class="sc">~</span>group,  <span class="sc">~</span>test.score, <span class="sc">~</span>study,</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">3</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,</span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Could aggragate across group</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="aggregation-obscures-hypotheses" class="slide level2">
<h2>Aggregation obscures hypotheses</h2>
<ul>
<li><p>Between person H1: Do students who study more get better grades?</p></li>
<li><p>Within person H2: When a student studies, do they get better grades?</p></li>
<li><p>H1 and H2 are independent from one another! Aggregation collapses the two. When you have nested data with many DVs (longitudinal but also almost any experimental situation) it is important to not aggregate.</p></li>
</ul>
</section>
<section id="stroop-example" class="slide level2">
<h2>Stroop example</h2>
<p>We calculate stroop scores by looking at repeated trials of congruent vs not congruent. This is dummy coded such that the <span class="math inline">\(\beta_{1}\)</span> reflects the average stroop effect. How much slower are people in incongruent trials?</p>
<p><span class="math display">\[Y_{i} = \beta_{0} + \beta_{1}X_{1} + \varepsilon_i\]</span></p>
</section>
<section class="slide level2">

<p>What if we ran a separate regression for everyone? We can then think of <span class="math inline">\(\beta_{1}\)</span> as a PERSON SPECIFIC EFFECT. What is the stoop effect for you?</p>
<p>We could think of <span class="math inline">\(\beta_{1}\)</span> as a random variable where people deviate on stroop effect from the average (ie fixed effect). You can then treat this as a regression, complete with a residual.</p>
<p><span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Z_i+ U_{1i}\]</span></p>
</section>
<section id="regressions-within-regressions" class="slide level2">
<h2>regressions within regressions</h2>
<p>Helps to take multilevel and split it into the different levels.</p>
<p>Level 1 is the smallest unit of analysis (students, waves, trials, family members)</p>
<p>Level 2 variables are what level 1 variables are “nested” in (people, schools, counties, families, dyads)</p>
<p>We are going to use level one components to run a regression, all the while level 1 is also estimating a regression</p>
</section>
<section class="slide level2">

<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial,i}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Age_i+ U_{1i}\]</span></p>
<p>Our B1 coefficient indexes the stroop effect. However, people differ on this stroop effect. There is some average effect (fixed effect) that people vary around. Each person has some personal <span class="math inline">\(\beta_1\)</span>, which we find using Level 1 data. From there we can also ask questions (with regressions) about that random variable.</p>
</section>
<section class="slide level2">

<p>People differ on the stroop</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>example <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2021/master/example.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>example<span class="sc">$</span>year <span class="ot">&lt;-</span> example<span class="sc">$</span>week</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>ex.random <span class="ot">&lt;-</span> example <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>  distinct <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">sample_n</span>(<span class="dv">3</span>) </span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>example2 <span class="ot">&lt;-</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">left_join</span>(ex.random, example)  </span>
<span id="cb6-12"><a href="#cb6-12"></a>  </span>
<span id="cb6-13"><a href="#cb6-13"></a>g2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(example2,</span>
<span id="cb6-14"><a href="#cb6-14"></a>   <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span><span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span>ID) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">13</span>) <span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">"stroop effect"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"trials"</span>) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">geom_label</span>(<span class="at">label=</span><span class="st">"Grand mean "</span>,  <span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>.<span class="dv">13</span>,</span>
<span id="cb6-17"><a href="#cb6-17"></a>    <span class="at">label.size =</span> <span class="fl">0.15</span>) </span>
<span id="cb6-18"><a href="#cb6-18"></a>g2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb7-2"><a href="#cb7-2"></a>example <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">do</span>(<span class="at">avg =</span> <span class="fu">tidy</span>(<span class="fu">lm</span>(SMN7 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">unnest</span>(avg) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">stat_dotsinterval</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="diferent-levels-and-regressions-within-regressions" class="slide level2">
<h2>diferent levels and regressions within regressions</h2>
<p>To sum up the first two ways to think about regression, we take a relationship that could be simplified by aggregation, but instead we ask regression questions at different levels of analysis.</p>
<p>At level 1 we can ask lower-unit questions e.g., if trials are nested within person, what predicts lengthier trials?</p>
<p>Longitudinally, if level 1 is observations, then we can ask level 1/observation level questions like if you’re with people do you then feel happier</p>
</section>
<section class="slide level2">

<p>At level 2 we can ask broader-unit questions. E.g., is age associated with stroop differences</p>
<p>Longitudinally, if level 2 is people, then we can ask level 2/person level questions like if you have more social support are you happier</p>
<p>Both levels are simple regressions. Level 2 uses coefficients from level 1 as DVs. Level 1 variables are time varying, level 2 variables are time invariant</p>
</section>
<section id="variance-decomposition" class="slide level2">
<h2>variance decomposition</h2>
<p>For standard regression, we think of error as existing in one big bucket called <span class="math inline">\(\varepsilon\)</span> . Everything that we do not know goes into that bucket, from measurement error to unmeasured important factors.</p>
<p>For MLMs we will be breaking up ( <span class="math inline">\(\varepsilon\)</span> ) into multiple buckets. These useful “buckets” (Us) are what we refer to as random/varying effects.</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial}\]</span> <span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Z_i+ U_{1i}\]</span></p>
</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="btw.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="win.png"></p>
</div>
</div>
</section>
<section class="slide level2">

<p>Random effects used to be error, but they are going to be useful going forward.</p>
<p>We will treat them as variables themselves e.g.&nbsp;individual differences in how people change</p>
<p>They index how much people DIFFER on some effect. e.g.&nbsp;does everyone change the same, or are there differences in how people change?</p>
<p>We can relate the random effects to other random effects e.g., do people who increase on X also start higher on X.</p>
</section>
<section id="shrinkagepartial-pooling" class="slide level2">
<h2>shrinkage/partial pooling</h2>
<ul>
<li><p>We treat our group variable as coming from a population. All groups are alike (because they are from the same population), but different in their own way. Because of this it is helpful to use information from other groups to help make predictions.</p></li>
<li><p>We do this in standard regression where we make predictions based on values from the whole dataset (not just binned Xs). A similar analogy for MLM is running a regression for each group. We want to pool as this leads to better predictions as we are not overfitting our data!</p></li>
</ul>
</section>
<section class="slide level2">

<p>If we take our simplified stroop effect model, where we are only looking at reaction time as a DV (ignoring the different types of trials) we could fit a model like this (an empty model)</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} +  \varepsilon_{trial}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span></p>
<p>Where does <span class="math inline">\(U_{0i}\)</span> come from? If we calculated each by hand, through taking the average reaction time for a person i and subtracting that from the grand mean reaction time, would that equal <span class="math inline">\(U_{0i}\)</span> ?</p>
</section>
<section id="complete-partial-and-no-pooling" class="slide level2">
<h2>Complete, partial and no pooling</h2>
<ul>
<li><p>Complete assumes everyone is the same, with <span class="math inline">\(U_{0i}\)</span> being zero for everyone.</p></li>
<li><p>No pooling is if we calculate every person’s effect with a regression, subtracting out he grand mean average.</p></li>
<li><p>Partial pooling is in the middle, a weighted average between the two. For those with fewer trials there is less information for a particular individual, thus the complete pooling estimate will be given more weight. If someone has a lot of data, there weighted average is closer to no pooling.</p></li>
<li><p>Partial pooling prevents both over and under fitting of your data, leading to increased out of sample predictions.</p></li>
</ul>
</section>
<section id="complete-pooling" class="slide level2">
<h2>Complete pooling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-2"><a href="#cb8-2"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section id="no-pooling" class="slide level2">
<h2>No Pooling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> ID) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="partial-pooling-aka-shrinkage" class="slide level2">
<h2>Partial pooling aka shrinkage</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID, <span class="at">colour =</span> ID)) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span><span class="fu">scale_color_viridis</span>()<span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study amount"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch"></section>
<section id="parameters-that-depend-on-other-parameters" class="slide level2">
<h2>Parameters that depend on other parameters</h2>
<p>The extent of shrinkage depends on a few things (eg number of observations per group) but also depends on our priors. This is known as a hyperprior</p>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma_i)\]</span> <span class="math display">\[\mu_i  = \beta_{0[j]}\]</span></p>
<p><span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="hyperprior" class="slide level2">
<h2>Hyperprior</h2>
<p>We now have a prior for the population of effects. This is a little different from what we are used to. We typically put a prior directly on parameters. Here, because are using a multi-level model, we are interested in the population of intercepts, not just a single intercept.</p>
<p>Intercept in simple regression –&gt; a (prior/posterior) distribution of possible scores</p>
<p>Intercept in mlm –&gt; a distribution of group/clusters of intercepts.</p>
<p>Note how the population we are sampling from can have some distribution (mu, sigma), and that is different from the observed distribution of mu or the distribution of sigma</p>
</section>
<section id="parameters-that-depend-on-parameters" class="slide level2">
<h2>Parameters that depend on parameters</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># normal density</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">library</span>(beyonce)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a>bp <span class="ot">&lt;-</span> <span class="fu">beyonce_palette</span>(<span class="dv">128</span>, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-13"><a href="#cb11-13"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-14"><a href="#cb11-14"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb11-15"><a href="#cb11-15"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-17"><a href="#cb11-17"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-18"><a href="#cb11-18"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"italic(M)[0]"</span>, <span class="st">"italic(S)[0]"</span>), </span>
<span id="cb11-19"><a href="#cb11-19"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-23"><a href="#cb11-23"></a></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co"># half-normal density</span></span>
<span id="cb11-25"><a href="#cb11-25"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb11-26"><a href="#cb11-26"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-27"><a href="#cb11-27"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-30"><a href="#cb11-30"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-31"><a href="#cb11-31"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb11-32"><a href="#cb11-32"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-34"><a href="#cb11-34"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-35"><a href="#cb11-35"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma][0]"</span>, </span>
<span id="cb11-36"><a href="#cb11-36"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-37"><a href="#cb11-37"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-38"><a href="#cb11-38"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-39"><a href="#cb11-39"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-40"><a href="#cb11-40"></a></span>
<span id="cb11-41"><a href="#cb11-41"></a>my_arrow <span class="ot">&lt;-</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)</span>
<span id="cb11-42"><a href="#cb11-42"></a></span>
<span id="cb11-43"><a href="#cb11-43"></a></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="co"># a second normal density</span></span>
<span id="cb11-45"><a href="#cb11-45"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb11-46"><a href="#cb11-46"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-47"><a href="#cb11-47"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb11-48"><a href="#cb11-48"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-49"><a href="#cb11-49"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-50"><a href="#cb11-50"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-51"><a href="#cb11-51"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb11-52"><a href="#cb11-52"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-54"><a href="#cb11-54"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-55"><a href="#cb11-55"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"italic(M)[1]"</span>, <span class="st">"italic(S)[1]"</span>), </span>
<span id="cb11-56"><a href="#cb11-56"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-57"><a href="#cb11-57"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-58"><a href="#cb11-58"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-59"><a href="#cb11-59"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-60"><a href="#cb11-60"></a></span>
<span id="cb11-61"><a href="#cb11-61"></a><span class="co"># a second half-normal density</span></span>
<span id="cb11-62"><a href="#cb11-62"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb11-63"><a href="#cb11-63"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-64"><a href="#cb11-64"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb11-65"><a href="#cb11-65"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-66"><a href="#cb11-66"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-67"><a href="#cb11-67"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-68"><a href="#cb11-68"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb11-69"><a href="#cb11-69"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-70"><a href="#cb11-70"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-71"><a href="#cb11-71"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-72"><a href="#cb11-72"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma][1]"</span>, </span>
<span id="cb11-73"><a href="#cb11-73"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-74"><a href="#cb11-74"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-75"><a href="#cb11-75"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-76"><a href="#cb11-76"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-77"><a href="#cb11-77"></a></span>
<span id="cb11-78"><a href="#cb11-78"></a><span class="co"># four annotated arrows</span></span>
<span id="cb11-79"><a href="#cb11-79"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb11-80"><a href="#cb11-80"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">35</span>, .<span class="dv">65</span>, .<span class="dv">95</span>),</span>
<span id="cb11-81"><a href="#cb11-81"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb11-82"><a href="#cb11-82"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">32</span>, .<span class="dv">4</span>, .<span class="dv">65</span>, .<span class="dv">72</span>),</span>
<span id="cb11-83"><a href="#cb11-83"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-84"><a href="#cb11-84"></a>  </span>
<span id="cb11-85"><a href="#cb11-85"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb11-86"><a href="#cb11-86"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb11-87"><a href="#cb11-87"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-88"><a href="#cb11-88"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-89"><a href="#cb11-89"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">35</span>, .<span class="dv">625</span>, .<span class="dv">78</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb11-90"><a href="#cb11-90"></a>           <span class="at">label =</span> <span class="st">"'~'"</span>,</span>
<span id="cb11-91"><a href="#cb11-91"></a>           <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-92"><a href="#cb11-92"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-93"><a href="#cb11-93"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb11-94"><a href="#cb11-94"></a></span>
<span id="cb11-95"><a href="#cb11-95"></a><span class="co"># third normal density</span></span>
<span id="cb11-96"><a href="#cb11-96"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb11-97"><a href="#cb11-97"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-98"><a href="#cb11-98"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb11-99"><a href="#cb11-99"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-100"><a href="#cb11-100"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-101"><a href="#cb11-101"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-102"><a href="#cb11-102"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb11-103"><a href="#cb11-103"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-104"><a href="#cb11-104"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-105"><a href="#cb11-105"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-106"><a href="#cb11-106"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"mu[0]"</span>, <span class="st">"sigma[0]"</span>), </span>
<span id="cb11-107"><a href="#cb11-107"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-108"><a href="#cb11-108"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-109"><a href="#cb11-109"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-110"><a href="#cb11-110"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-111"><a href="#cb11-111"></a></span>
<span id="cb11-112"><a href="#cb11-112"></a><span class="co"># fourth normal density</span></span>
<span id="cb11-113"><a href="#cb11-113"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb11-114"><a href="#cb11-114"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-115"><a href="#cb11-115"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb11-116"><a href="#cb11-116"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-117"><a href="#cb11-117"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-118"><a href="#cb11-118"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-119"><a href="#cb11-119"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb11-120"><a href="#cb11-120"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-121"><a href="#cb11-121"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-122"><a href="#cb11-122"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-123"><a href="#cb11-123"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"mu[1]"</span>, <span class="st">"sigma[1]"</span>), </span>
<span id="cb11-124"><a href="#cb11-124"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-125"><a href="#cb11-125"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-126"><a href="#cb11-126"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-127"><a href="#cb11-127"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-128"><a href="#cb11-128"></a></span>
<span id="cb11-129"><a href="#cb11-129"></a><span class="co"># two annotated arrows</span></span>
<span id="cb11-130"><a href="#cb11-130"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb11-131"><a href="#cb11-131"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">82</span>),</span>
<span id="cb11-132"><a href="#cb11-132"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb11-133"><a href="#cb11-133"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">36</span>, .<span class="dv">55</span>),</span>
<span id="cb11-134"><a href="#cb11-134"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-135"><a href="#cb11-135"></a>  </span>
<span id="cb11-136"><a href="#cb11-136"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb11-137"><a href="#cb11-137"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb11-138"><a href="#cb11-138"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-139"><a href="#cb11-139"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-140"><a href="#cb11-140"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">33</span>, .<span class="dv">64</span>, .<span class="dv">77</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb11-141"><a href="#cb11-141"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"italic(j)"</span>, <span class="st">"'~'"</span>, <span class="st">"italic(j)"</span>),</span>
<span id="cb11-142"><a href="#cb11-142"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb11-143"><a href="#cb11-143"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-144"><a href="#cb11-144"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-145"><a href="#cb11-145"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb11-146"><a href="#cb11-146"></a></span>
<span id="cb11-147"><a href="#cb11-147"></a><span class="co"># exponential density</span></span>
<span id="cb11-148"><a href="#cb11-148"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb11-149"><a href="#cb11-149"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-150"><a href="#cb11-150"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dexp</span>(x, <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dexp</span>(x, <span class="dv">2</span>))))) <span class="sc">+</span></span>
<span id="cb11-151"><a href="#cb11-151"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-152"><a href="#cb11-152"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-153"><a href="#cb11-153"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-154"><a href="#cb11-154"></a>           <span class="at">label =</span> <span class="st">"exp"</span>,</span>
<span id="cb11-155"><a href="#cb11-155"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-156"><a href="#cb11-156"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-157"><a href="#cb11-157"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-158"><a href="#cb11-158"></a>           <span class="at">label =</span> <span class="st">"italic(K)"</span>,</span>
<span id="cb11-159"><a href="#cb11-159"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-160"><a href="#cb11-160"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-161"><a href="#cb11-161"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-162"><a href="#cb11-162"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-163"><a href="#cb11-163"></a></span>
<span id="cb11-164"><a href="#cb11-164"></a><span class="co"># likelihood formula</span></span>
<span id="cb11-165"><a href="#cb11-165"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb11-166"><a href="#cb11-166"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb11-167"><a href="#cb11-167"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb11-168"><a href="#cb11-168"></a>         <span class="at">label =</span> <span class="st">"beta[0][italic(j)]+beta[1][italic(j)]*italic(x)[italic(i)*'|'*italic(j)]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-169"><a href="#cb11-169"></a>  </span>
<span id="cb11-170"><a href="#cb11-170"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-171"><a href="#cb11-171"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb11-172"><a href="#cb11-172"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-173"><a href="#cb11-173"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-174"><a href="#cb11-174"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb11-175"><a href="#cb11-175"></a></span>
<span id="cb11-176"><a href="#cb11-176"></a><span class="co"># half-normal density</span></span>
<span id="cb11-177"><a href="#cb11-177"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb11-178"><a href="#cb11-178"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-179"><a href="#cb11-179"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb11-180"><a href="#cb11-180"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-181"><a href="#cb11-181"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-182"><a href="#cb11-182"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-183"><a href="#cb11-183"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb11-184"><a href="#cb11-184"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-185"><a href="#cb11-185"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-186"><a href="#cb11-186"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-187"><a href="#cb11-187"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma]"</span>, </span>
<span id="cb11-188"><a href="#cb11-188"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-189"><a href="#cb11-189"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-190"><a href="#cb11-190"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-191"><a href="#cb11-191"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-192"><a href="#cb11-192"></a></span>
<span id="cb11-193"><a href="#cb11-193"></a><span class="co"># four annotated arrows</span></span>
<span id="cb11-194"><a href="#cb11-194"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb11-195"><a href="#cb11-195"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">43</span>, .<span class="dv">43</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb11-196"><a href="#cb11-196"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">55</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb11-197"><a href="#cb11-197"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">43</span>, <span class="fl">1.225</span>, <span class="fl">1.5</span>, <span class="fl">1.75</span>),</span>
<span id="cb11-198"><a href="#cb11-198"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">15</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-199"><a href="#cb11-199"></a>  </span>
<span id="cb11-200"><a href="#cb11-200"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb11-201"><a href="#cb11-201"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb11-202"><a href="#cb11-202"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-203"><a href="#cb11-203"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-204"><a href="#cb11-204"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">7</span>, <span class="fl">1.38</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">22</span>, .<span class="dv">65</span>, .<span class="dv">6</span>),</span>
<span id="cb11-205"><a href="#cb11-205"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"'='"</span>, <span class="st">"'='"</span>, <span class="st">"'~'"</span>),</span>
<span id="cb11-206"><a href="#cb11-206"></a>           <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb11-207"><a href="#cb11-207"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-208"><a href="#cb11-208"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-209"><a href="#cb11-209"></a>           <span class="at">x =</span> .<span class="dv">43</span>, <span class="at">y =</span> .<span class="dv">7</span>,</span>
<span id="cb11-210"><a href="#cb11-210"></a>           <span class="at">label =</span> <span class="st">"nu*minute+1"</span>,</span>
<span id="cb11-211"><a href="#cb11-211"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-212"><a href="#cb11-212"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-213"><a href="#cb11-213"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb11-214"><a href="#cb11-214"></a></span>
<span id="cb11-215"><a href="#cb11-215"></a><span class="co"># student-t density</span></span>
<span id="cb11-216"><a href="#cb11-216"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb11-217"><a href="#cb11-217"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-218"><a href="#cb11-218"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dt</span>(x, <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dt</span>(x, <span class="dv">3</span>))))) <span class="sc">+</span></span>
<span id="cb11-219"><a href="#cb11-219"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-220"><a href="#cb11-220"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-221"><a href="#cb11-221"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb11-222"><a href="#cb11-222"></a>           <span class="at">label =</span> <span class="st">"student t"</span>,</span>
<span id="cb11-223"><a href="#cb11-223"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-224"><a href="#cb11-224"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb11-225"><a href="#cb11-225"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb11-226"><a href="#cb11-226"></a>           <span class="at">label =</span> <span class="st">"nu~~mu[italic(i)*'|'*italic(j)]~~sigma"</span>,</span>
<span id="cb11-227"><a href="#cb11-227"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb11-228"><a href="#cb11-228"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb11-229"><a href="#cb11-229"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-230"><a href="#cb11-230"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb11-231"><a href="#cb11-231"></a></span>
<span id="cb11-232"><a href="#cb11-232"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb11-233"><a href="#cb11-233"></a>p14 <span class="ot">&lt;-</span></span>
<span id="cb11-234"><a href="#cb11-234"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb11-235"><a href="#cb11-235"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb11-236"><a href="#cb11-236"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"italic(i)*'|'*italic(j)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-237"><a href="#cb11-237"></a>  </span>
<span id="cb11-238"><a href="#cb11-238"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-239"><a href="#cb11-239"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb11-240"><a href="#cb11-240"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb11-241"><a href="#cb11-241"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb11-242"><a href="#cb11-242"></a>               <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">arrow =</span> my_arrow) <span class="sc">+</span></span>
<span id="cb11-243"><a href="#cb11-243"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-244"><a href="#cb11-244"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb11-245"><a href="#cb11-245"></a></span>
<span id="cb11-246"><a href="#cb11-246"></a><span class="co"># some text</span></span>
<span id="cb11-247"><a href="#cb11-247"></a>p15 <span class="ot">&lt;-</span></span>
<span id="cb11-248"><a href="#cb11-248"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb11-249"><a href="#cb11-249"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb11-250"><a href="#cb11-250"></a>         <span class="at">label =</span> <span class="st">"italic(y)[italic(i)*'|'*italic(j)]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-251"><a href="#cb11-251"></a>  </span>
<span id="cb11-252"><a href="#cb11-252"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-253"><a href="#cb11-253"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb11-254"><a href="#cb11-254"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-255"><a href="#cb11-255"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb11-256"><a href="#cb11-256"></a></span>
<span id="cb11-257"><a href="#cb11-257"></a><span class="co"># define the layout</span></span>
<span id="cb11-258"><a href="#cb11-258"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb11-259"><a href="#cb11-259"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb11-260"><a href="#cb11-260"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb11-261"><a href="#cb11-261"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb11-262"><a href="#cb11-262"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">13</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb11-263"><a href="#cb11-263"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb11-264"><a href="#cb11-264"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb11-265"><a href="#cb11-265"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb11-266"><a href="#cb11-266"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">5</span>),</span>
<span id="cb11-267"><a href="#cb11-267"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb11-268"><a href="#cb11-268"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb11-269"><a href="#cb11-269"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb11-270"><a href="#cb11-270"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb11-271"><a href="#cb11-271"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb11-272"><a href="#cb11-272"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb11-273"><a href="#cb11-273"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">13</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>)</span>
<span id="cb11-274"><a href="#cb11-274"></a>)</span>
<span id="cb11-275"><a href="#cb11-275"></a></span>
<span id="cb11-276"><a href="#cb11-276"></a><span class="co"># combine and plot!</span></span>
<span id="cb11-277"><a href="#cb11-277"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p5 <span class="sc">+</span> p9 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p8 <span class="sc">+</span> p13 <span class="sc">+</span> p12 <span class="sc">+</span> p14 <span class="sc">+</span> p15) <span class="sc">+</span> </span>
<span id="cb11-278"><a href="#cb11-278"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb11-279"><a href="#cb11-279"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb11-280"><a href="#cb11-280"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb12-2"><a href="#cb12-2"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb12-4"><a href="#cb12-4"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb12-5"><a href="#cb12-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb12-6"><a href="#cb12-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd), </span>
<span id="cb12-7"><a href="#cb12-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb12-8"><a href="#cb12-8"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb12-9"><a href="#cb12-9"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb12-10"><a href="#cb12-10"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb12-11"><a href="#cb12-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>      <span class="at">file =</span> <span class="st">"mlm.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you think about parameters you are estimating the number of priors are simple. But in terms of what those priors represent, they are providing a prior on a prior. The intercept and the SD are both providing estimates of means. We could model this 1 parameter (anova or index coded) or 2 (mlm)</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     5431     8578

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.20 1.00     7203    10549

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     9902    11403

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Notice we have one less parameter we are estimating.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>mlm<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb15-3"><a href="#cb15-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> ,</span>
<span id="cb15-4"><a href="#cb15-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb15-5"><a href="#cb15-5"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb15-6"><a href="#cb15-6"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb15-9"><a href="#cb15-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>      <span class="at">file =</span> <span class="st">"mlm.2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">summary</span>(mlm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.00     0.18     0.20 1.00    16615    11267

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.07      0.00     0.07     0.08 1.00    10474     9132

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>, <span class="st">"loo"</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>mlm<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.2</span>, <span class="st">"loo"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">loo_compare</span>(mlm<span class="fl">.1</span>, mlm<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      elpd_diff se_diff
mlm.1   0.0       0.0  
mlm.2 -58.1       8.8  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Notice how the intercept is the same in each of these models. Even the CIs. Conceptually they are different though. The intercept is directly modeled in the standard regression. In the MLM it is better thought of as the map of the distribution of random effects.</p>
<p>The population is larger than what we have. This is true for almost anything we do. We sample paradigms, we sample people, we usually never have a full population under our study. Don’t we want to model that variation?</p>
</section>
<section class="slide level2">

<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma)\]</span> <span class="math display">\[\mu_i  = \beta_{0[j]}\]</span> This line indicates we have varying intercepts that vary over individual j. Much like going from level 1 -&gt; 2, we do priors on that parameter. Indicates that there is a distribution FOR EACH PERSON/GROUP. The distribution needs a prior. <span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="parameters-that-depend-on-parameters-1" class="slide level2">
<h2>Parameters that depend on parameters</h2>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>With mlm we treated means as coming from a population of means. And thus there was a best guess of the mean (intercept) and variation around that guess (SD). With anova we ignored the variation. But we could, in bayes, still examine that variation. Lets fit an index model, where each person gets a mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>mlm<span class="sc">$</span>ID.f <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mlm<span class="sc">$</span>ID)</span>
<span id="cb20-2"><a href="#cb20-2"></a>mlm.id <span class="ot">&lt;-</span> </span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb20-4"><a href="#cb20-4"></a>      CON <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ID.f ,</span>
<span id="cb20-5"><a href="#cb20-5"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb20-7"><a href="#cb20-7"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb20-8"><a href="#cb20-8"></a>      <span class="at">file =</span> <span class="st">"mlm.id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>This is similar to a “fixed effect” model, something that is popular in econometrics. It, in contrast to the random effect model, does not model random effects.</p>
<p>Why do we want to model random effects? Variance decomposition which leads to increased power.</p>
<p>Also, 1. we can include group/cluster level predictors, which fixed effect cannot. 2. it makes an assumption about whether the clusters are random or not. Psych they are almost always random (people, site, orgs) whereas for econometrics they aren’t (country, state).</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">summary</span>(mlm.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 0 + ID.f 
   Data: mlm (Number of observations: 225) 
  Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Population-Level Effects: 
        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
ID.f6       0.19      0.03     0.14     0.24 1.00    12843     4563
ID.f29      0.12      0.03     0.06     0.19 1.00    12890     4381
ID.f34      0.11      0.03     0.04     0.17 1.00    11125     3396
ID.f36      0.16      0.03     0.09     0.22 1.00    10520     4353
ID.f37      0.19      0.03     0.13     0.24 1.00    13971     4513
ID.f48      0.22      0.03     0.16     0.28 1.00    11877     3672
ID.f53      0.19      0.03     0.12     0.25 1.00    12973     3832
ID.f54      0.25      0.03     0.19     0.30 1.00    10693     4209
ID.f58      0.24      0.03     0.18     0.29 1.00    11734     3630
ID.f61      0.09      0.03     0.02     0.15 1.00    11095     4131
ID.f66      0.24      0.03     0.18     0.30 1.00    10702     3905
ID.f67      0.20      0.02     0.15     0.25 1.00    12121     4120
ID.f69      0.21      0.03     0.14     0.27 1.00    11762     4351
ID.f71      0.06      0.03     0.00     0.11 1.00    12658     4033
ID.f74      0.20      0.03     0.15     0.26 1.00    12824     4541
ID.f75      0.27      0.03     0.21     0.34 1.00    13089     4330
ID.f76      0.10      0.03     0.05     0.15 1.00    11192     4021
ID.f78      0.24      0.03     0.19     0.30 1.00    13957     4076
ID.f79      0.13      0.03     0.06     0.20 1.00    11956     3914
ID.f80      0.14      0.03     0.07     0.20 1.00    10268     4029
ID.f81      0.24      0.03     0.19     0.30 1.00    11554     4247
ID.f82      0.33      0.02     0.28     0.37 1.00    10263     4261
ID.f85      0.16      0.03     0.09     0.22 1.00    12539     4150
ID.f86      0.12      0.03     0.05     0.18 1.00    10475     4054
ID.f87      0.11      0.03     0.05     0.18 1.00    13807     4300
ID.f89      0.14      0.03     0.08     0.19 1.00    11419     4313
ID.f91      0.17      0.03     0.12     0.23 1.00    12721     4282
ID.f92      0.20      0.03     0.15     0.26 1.00    11862     4418
ID.f93      0.25      0.03     0.20     0.31 1.00    12602     3651
ID.f94      0.12      0.03     0.06     0.17 1.00    11041     3875
ID.f96      0.23      0.03     0.16     0.30 1.00    12876     3812
ID.f97      0.25      0.02     0.20     0.29 1.00    10826     4330
ID.f98      0.14      0.02     0.09     0.19 1.00     9621     4076
ID.f99      0.18      0.02     0.13     0.23 1.00    12074     4029
ID.f101     0.25      0.03     0.19     0.30 1.00    13398     4000
ID.f102     0.19      0.02     0.14     0.23 1.00    11928     4485
ID.f103     0.15      0.03     0.09     0.22 1.00    12408     4337
ID.f104     0.17      0.03     0.11     0.24 1.00    11784     4181
ID.f105     0.16      0.03     0.11     0.22 1.00    10588     3372
ID.f106     0.20      0.03     0.14     0.25 1.00    12531     4475
ID.f110     0.18      0.03     0.13     0.24 1.00    11621     3912
ID.f112     0.09      0.03     0.04     0.15 1.00    12749     4372
ID.f114     0.13      0.03     0.08     0.19 1.00    13131     4640
ID.f115     0.14      0.03     0.09     0.20 1.00    11539     4158
ID.f116     0.14      0.03     0.09     0.20 1.00    11704     4916
ID.f120     0.35      0.03     0.29     0.42 1.00    11116     4498
ID.f122     0.17      0.03     0.12     0.22 1.00    13135     4066
ID.f125     0.20      0.03     0.14     0.25 1.00    10812     4172
ID.f127     0.23      0.03     0.17     0.28 1.00    12523     4304
ID.f129     0.13      0.03     0.06     0.20 1.00    12336     3775
ID.f135     0.30      0.03     0.24     0.35 1.00    11249     4325
ID.f136     0.29      0.03     0.24     0.34 1.00    12910     4060
ID.f137     0.29      0.03     0.23     0.36 1.00    11799     3709
ID.f140     0.13      0.03     0.06     0.19 1.00    12368     4573
ID.f141     0.19      0.03     0.13     0.26 1.00    11270     4112
ID.f142     0.18      0.03     0.11     0.24 1.00    11910     3756
ID.f143     0.31      0.03     0.25     0.38 1.00    11943     4100
ID.f144     0.17      0.03     0.11     0.24 1.00    10872     4346
ID.f146     0.21      0.03     0.14     0.28 1.00    12834     3844
ID.f149     0.23      0.03     0.16     0.30 1.00    13499     4048
ID.f150     0.20      0.03     0.14     0.27 1.00    11754     4112
ID.f152     0.22      0.03     0.16     0.29 1.00    12196     3979
ID.f153     0.15      0.03     0.08     0.21 1.00    11960     4349
ID.f155     0.14      0.03     0.08     0.21 1.00    12799     4708
ID.f156     0.14      0.03     0.08     0.19 1.00    11804     4149
ID.f159     0.12      0.03     0.06     0.19 1.00    12160     3926
ID.f160     0.18      0.03     0.11     0.24 1.00    12500     4331
ID.f162     0.39      0.03     0.34     0.45 1.00    11956     4512
ID.f163     0.13      0.03     0.07     0.20 1.00    13493     4058
ID.f165     0.20      0.03     0.13     0.26 1.00    10433     3473
ID.f167     0.13      0.03     0.06     0.20 1.00    11378     3996
ID.f169     0.24      0.03     0.18     0.31 1.00    10844     3478
ID.f171     0.23      0.03     0.16     0.29 1.00    11715     4200
ID.f174     0.26      0.03     0.20     0.33 1.00    12807     4506
ID.f182     0.19      0.03     0.12     0.25 1.00    14151     4268
ID.f187     0.06      0.03    -0.00     0.13 1.00    11480     3807
ID.f189     0.22      0.03     0.16     0.29 1.00    10615     3896
ID.f190     0.13      0.03     0.06     0.19 1.00    11900     4110
ID.f193     0.21      0.03     0.14     0.27 1.00    11690     3406
ID.f194     0.12      0.03     0.05     0.19 1.00    11769     4036
ID.f201     0.19      0.03     0.12     0.25 1.00    12564     4307
ID.f204     0.29      0.03     0.22     0.35 1.00    11331     4479
ID.f205     0.19      0.03     0.13     0.26 1.00    12142     4243
ID.f208     0.20      0.03     0.14     0.27 1.00    11908     4093
ID.f209     0.21      0.03     0.15     0.28 1.00    12056     4303
ID.f211     0.14      0.03     0.07     0.21 1.00    12298     4843
ID.f214     0.28      0.03     0.21     0.34 1.00    11659     4294
ID.f219     0.23      0.03     0.16     0.30 1.00    13161     3850
ID.f222     0.14      0.03     0.07     0.20 1.00    11313     4140
ID.f223     0.17      0.03     0.10     0.23 1.00    12990     4250
ID.f229     0.14      0.03     0.07     0.21 1.00    11559     4131

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     3458     3621

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">posterior_samples</span>(mlm.id) <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">pivot_longer</span>(b_ID.f6<span class="sc">:</span>b_ID.f91, <span class="at">names_to=</span><span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(value), <span class="at">sd=</span><span class="fu">sd</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
   mean     sd
  &lt;dbl&gt;  &lt;dbl&gt;
1 0.177 0.0698</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb25-2"><a href="#cb25-2"></a>posterior<span class="sc">::</span><span class="fu">summarise_draws</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 99 × 10
   variable        mean   median      sd     mad      q5      q95  rhat ess_bulk
   &lt;chr&gt;          &lt;num&gt;    &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt; &lt;num&gt;    &lt;num&gt;
 1 b_Intercept  1.89e-1  1.89e-1 0.00677 0.00668  0.178   2.00e-1  1.00    7203.
 2 sd_ID__Int…  5.66e-2  5.63e-2 0.00566 0.00548  0.0478  6.64e-2  1.00    5431.
 3 sigma        4.74e-2  4.73e-2 0.00289 0.00286  0.0429  5.24e-2  1.00    9902.
 4 r_ID[6,Int…  1.74e-4  1.27e-4 0.0252  0.0249  -0.0413  4.16e-2  1.00   27182.
 5 r_ID[29,In… -4.84e-2 -4.82e-2 0.0296  0.0297  -0.0969  2.79e-4  1.00   29535.
 6 r_ID[34,In… -6.14e-2 -6.14e-2 0.0292  0.0291  -0.109  -1.40e-2  1.00   27144.
 7 r_ID[36,In… -2.24e-2 -2.25e-2 0.0293  0.0293  -0.0711  2.57e-2  1.00   31028.
 8 r_ID[37,In… -3.33e-3 -3.41e-3 0.0252  0.0251  -0.0447  3.82e-2  1.00   28836.
 9 r_ID[48,In…  2.35e-2  2.34e-2 0.0251  0.0248  -0.0177  6.42e-2  1.00   25902.
10 r_ID[53,In…  2.34e-4  2.52e-4 0.0287  0.0284  -0.0472  4.78e-2  1.00   31644.
# ℹ 89 more rows
# ℹ 1 more variable: ess_tail &lt;num&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>What does it mean that we are learning from our data? Or that the priors are based on our data?</p>
<p>Well we set up the prior for values we are not directly estimating. We are instead using those priors plus data to help us create estimates that are informed by the prior but also by the data.</p>
</section>
<section id="partial-poolingshrinkage" class="slide level2">
<h2>Partial pooling/Shrinkage</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma_i)\]</span></p>
<p><span class="math display">\[\mu_i  = \beta_{0[i]}\]</span></p>
<p><span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span></p>
<p><span class="math display">\[\sigma_0 \sim {\operatorname{Normal}(0, 1.5)}\]</span></p>
<p><span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
<p><span class="math inline">\(\sigma_0\)</span> can turn on/off/adjust shrinkage. Setting SD to zero says everyone is the same. Infinite SD says all groups are unrelated (no pooling). In the middle gives you partial pooling. We use our prior of <span class="math inline">\(\sigma_0\)</span> plus our data to get an estimate of the prior for <span class="math inline">\(\beta_{0[j]}\)</span>. This is how we accurately partial pool.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     5431     8578

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.20 1.00     7203    10549

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     9902    11403

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">get_variables</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"         "sd_ID__Intercept"    "sigma"              
  [4] "r_ID[6,Intercept]"   "r_ID[29,Intercept]"  "r_ID[34,Intercept]" 
  [7] "r_ID[36,Intercept]"  "r_ID[37,Intercept]"  "r_ID[48,Intercept]" 
 [10] "r_ID[53,Intercept]"  "r_ID[54,Intercept]"  "r_ID[58,Intercept]" 
 [13] "r_ID[61,Intercept]"  "r_ID[66,Intercept]"  "r_ID[67,Intercept]" 
 [16] "r_ID[69,Intercept]"  "r_ID[71,Intercept]"  "r_ID[74,Intercept]" 
 [19] "r_ID[75,Intercept]"  "r_ID[76,Intercept]"  "r_ID[78,Intercept]" 
 [22] "r_ID[79,Intercept]"  "r_ID[80,Intercept]"  "r_ID[81,Intercept]" 
 [25] "r_ID[82,Intercept]"  "r_ID[85,Intercept]"  "r_ID[86,Intercept]" 
 [28] "r_ID[87,Intercept]"  "r_ID[89,Intercept]"  "r_ID[91,Intercept]" 
 [31] "r_ID[92,Intercept]"  "r_ID[93,Intercept]"  "r_ID[94,Intercept]" 
 [34] "r_ID[96,Intercept]"  "r_ID[97,Intercept]"  "r_ID[98,Intercept]" 
 [37] "r_ID[99,Intercept]"  "r_ID[101,Intercept]" "r_ID[102,Intercept]"
 [40] "r_ID[103,Intercept]" "r_ID[104,Intercept]" "r_ID[105,Intercept]"
 [43] "r_ID[106,Intercept]" "r_ID[110,Intercept]" "r_ID[112,Intercept]"
 [46] "r_ID[114,Intercept]" "r_ID[115,Intercept]" "r_ID[116,Intercept]"
 [49] "r_ID[120,Intercept]" "r_ID[122,Intercept]" "r_ID[125,Intercept]"
 [52] "r_ID[127,Intercept]" "r_ID[129,Intercept]" "r_ID[135,Intercept]"
 [55] "r_ID[136,Intercept]" "r_ID[137,Intercept]" "r_ID[140,Intercept]"
 [58] "r_ID[141,Intercept]" "r_ID[142,Intercept]" "r_ID[143,Intercept]"
 [61] "r_ID[144,Intercept]" "r_ID[146,Intercept]" "r_ID[149,Intercept]"
 [64] "r_ID[150,Intercept]" "r_ID[152,Intercept]" "r_ID[153,Intercept]"
 [67] "r_ID[155,Intercept]" "r_ID[156,Intercept]" "r_ID[159,Intercept]"
 [70] "r_ID[160,Intercept]" "r_ID[162,Intercept]" "r_ID[163,Intercept]"
 [73] "r_ID[165,Intercept]" "r_ID[167,Intercept]" "r_ID[169,Intercept]"
 [76] "r_ID[171,Intercept]" "r_ID[174,Intercept]" "r_ID[182,Intercept]"
 [79] "r_ID[187,Intercept]" "r_ID[189,Intercept]" "r_ID[190,Intercept]"
 [82] "r_ID[193,Intercept]" "r_ID[194,Intercept]" "r_ID[201,Intercept]"
 [85] "r_ID[204,Intercept]" "r_ID[205,Intercept]" "r_ID[208,Intercept]"
 [88] "r_ID[209,Intercept]" "r_ID[211,Intercept]" "r_ID[214,Intercept]"
 [91] "r_ID[219,Intercept]" "r_ID[222,Intercept]" "r_ID[223,Intercept]"
 [94] "r_ID[229,Intercept]" "prior_Intercept"     "prior_sigma"        
 [97] "prior_sd_ID"         "lprior"              "lp__"               
[100] "accept_stat__"       "treedepth__"         "stepsize__"         
[103] "divergent__"         "n_leapfrog__"        "energy__"           </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 6
# Groups:   ID, term [91]
      ID term          r_ID .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6 Intercept  0.00486      1          1     1
 2     6 Intercept  0.00189      1          2     2
 3     6 Intercept  0.0203       1          3     3
 4     6 Intercept -0.0463       1          4     4
 5     6 Intercept  0.0358       1          5     5
 6     6 Intercept -0.0305       1          6     6
 7     6 Intercept  0.0108       1          7     7
 8     6 Intercept  0.00562      1          8     8
 9     6 Intercept  0.00230      1          9     9
10     6 Intercept  0.0235       1         10    10
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
<p>16000 samples (4 chains * 4k iterations) * 91 people</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 5
# Groups:   ID [91]
      ID     r_ID .chain .iteration .draw
   &lt;int&gt;    &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6  0.00486      1          1     1
 2     6  0.00189      1          2     2
 3     6  0.0203       1          3     3
 4     6 -0.0463       1          4     4
 5     6  0.0358       1          5     5
 6     6 -0.0305       1          6     6
 7     6  0.0108       1          7     7
 8     6  0.00562      1          8     8
 9     6  0.00230      1          9     9
10     6  0.0235       1         10    10
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3"></a> <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 8
      ID term           r_ID   .lower   .upper .width .point .interval
   &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1     6 Intercept  0.000127 -0.0495   0.0492    0.95 median qi       
 2    29 Intercept -0.0482   -0.106    0.00947   0.95 median qi       
 3    34 Intercept -0.0614   -0.120   -0.00548   0.95 median qi       
 4    36 Intercept -0.0225   -0.0795   0.0348    0.95 median qi       
 5    37 Intercept -0.00341  -0.0522   0.0459    0.95 median qi       
 6    48 Intercept  0.0234   -0.0255   0.0728    0.95 median qi       
 7    53 Intercept  0.000252 -0.0556   0.0569    0.95 median qi       
 8    54 Intercept  0.0452   -0.00413  0.0937    0.95 median qi       
 9    58 Intercept  0.0370   -0.0125   0.0867    0.95 median qi       
10    61 Intercept -0.0743   -0.131   -0.0168    0.95 median qi       
# ℹ 81 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> r_ID), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="st">"orange is model based, black circles are observed means"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Think back to {lme4} and <code>ranef</code> <code>coef</code> and <code>fixef</code> functions.</p>
<p>What do each of these describe?</p>
<p>What scale is our random effects (typically) in?</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 7
# Groups:   ID, term [91]
   .chain .iteration .draw b_Intercept    ID term          r_ID
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
 1      1          1     1       0.201     6 Intercept  0.00486
 2      1          1     1       0.201    29 Intercept -0.0310 
 3      1          1     1       0.201    34 Intercept -0.124  
 4      1          1     1       0.201    36 Intercept -0.105  
 5      1          1     1       0.201    37 Intercept -0.0349 
 6      1          1     1       0.201    48 Intercept  0.0250 
 7      1          1     1       0.201    53 Intercept -0.0462 
 8      1          1     1       0.201    54 Intercept  0.0262 
 9      1          1     1       0.201    58 Intercept -0.0356 
10      1          1     1       0.201    61 Intercept -0.0765 
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3"></a>   <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 8
# Groups:   ID, term [91]
   .chain .iteration .draw b_Intercept    ID term          r_ID person_I
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
 1      1          1     1       0.201     6 Intercept  0.00486   0.206 
 2      1          1     1       0.201    29 Intercept -0.0310    0.170 
 3      1          1     1       0.201    34 Intercept -0.124     0.0769
 4      1          1     1       0.201    36 Intercept -0.105     0.0961
 5      1          1     1       0.201    37 Intercept -0.0349    0.166 
 6      1          1     1       0.201    48 Intercept  0.0250    0.226 
 7      1          1     1       0.201    53 Intercept -0.0462    0.155 
 8      1          1     1       0.201    54 Intercept  0.0262    0.227 
 9      1          1     1       0.201    58 Intercept -0.0356    0.165 
10      1          1     1       0.201    61 Intercept -0.0765    0.124 
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">


<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>   <span class="fu">median_qi</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_I), <span class="at">x =</span> person_I, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="fu">geom_pointinterval</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-40-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>set prior for random effect to almost zero.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>mlm<span class="fl">.1</span>p <span class="ot">&lt;-</span> </span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb43-3"><a href="#cb43-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb43-4"><a href="#cb43-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb43-5"><a href="#cb43-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">00001</span>), <span class="at">class =</span> sd), </span>
<span id="cb43-6"><a href="#cb43-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb43-7"><a href="#cb43-7"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb43-8"><a href="#cb43-8"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb43-9"><a href="#cb43-9"></a>      <span class="at">file =</span> <span class="st">"mlm.1p"</span>,</span>
<span id="cb43-10"><a href="#cb43-10"></a>       <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb43-11"><a href="#cb43-11"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.00      0.00     0.00     0.00 1.00     9457     6383

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.00     0.18     0.20 1.00    15396     8212

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.07      0.00     0.07     0.08 1.00    17206     8431

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> person_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb46-10"><a href="#cb46-10"></a>  <span class="st">"partial pooling"</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.1849846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-43-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>set SD prior for no pooling</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>mlm<span class="fl">.1</span>p2 <span class="ot">&lt;-</span> </span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb47-3"><a href="#cb47-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb47-4"><a href="#cb47-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb47-5"><a href="#cb47-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">250</span>, <span class="dv">1</span>), <span class="at">class =</span> sd), </span>
<span id="cb47-6"><a href="#cb47-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(.<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb47-7"><a href="#cb47-7"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb47-8"><a href="#cb47-8"></a>      <span class="at">file =</span> <span class="st">"mlm.1p2"</span>,</span>
<span id="cb47-9"><a href="#cb47-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb47-10"><a href="#cb47-10"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)    62.57    108.26     0.05   251.23 1.54        7       32

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    -0.13      0.56    -1.20     0.20 1.53        7       18

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.02      170      202

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb50-5"><a href="#cb50-5"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> person_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb50-10"><a href="#cb50-10"></a>  <span class="st">"partial pooling"</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.1849846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-46-1.png" width="960" class="r-stretch"></section>
<section id="level-1-predictors-1" class="slide level2">
<h2>level 1 predictors</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma)\]</span> <span class="math display">\[\mu_i  = \beta_{0[j]} + \beta_{1[j]}Time_{ij}\]</span></p>
<p><span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu}, \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\beta_{1[j]} \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section class="slide level2">

<p>Notice how the slope variable was not a hyper prior. What does that mean? That means it is not random. People can still differ, but only based on the equation we set up for it. That is, there are fixed effects based on different gammas, but not Us to represent random variation. To do so we would need a parameter for that, and we dont have it.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">get_prior</span>(CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class      coef group resp dpar nlpar lb ub
                 (flat)         b                                      
                 (flat)         b      time                            
 student_t(3, 0.2, 2.5) Intercept                                      
   student_t(3, 0, 2.5)        sd                                  0   
   student_t(3, 0, 2.5)        sd              ID                  0   
   student_t(3, 0, 2.5)        sd Intercept    ID                  0   
   student_t(3, 0, 2.5)     sigma                                  0   
       source
      default
 (vectorized)
      default
      default
 (vectorized)
 (vectorized)
      default</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>mlm<span class="fl">.3</span> <span class="ot">&lt;-</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb53-3"><a href="#cb53-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb53-4"><a href="#cb53-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb53-5"><a href="#cb53-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb53-6"><a href="#cb53-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd), </span>
<span id="cb53-7"><a href="#cb53-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb53-8"><a href="#cb53-8"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb53-9"><a href="#cb53-9"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb53-10"><a href="#cb53-10"></a>      <span class="at">file =</span> <span class="st">"mlm.3"</span>,</span>
<span id="cb53-11"><a href="#cb53-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb53-12"><a href="#cb53-12"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">summary</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + time + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     4257     6307

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.21 1.00     6326     8742
time         -0.00      0.00    -0.01     0.00 1.00    15278    10371

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     7244     9241

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">posterior_summary</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate    Est.Error          Q2.5         Q97.5
b_Intercept          1.939778e-01  0.007941985  1.783368e-01  2.094254e-01
b_time              -2.636000e-03  0.002165885 -6.873653e-03  1.649770e-03
sd_ID__Intercept     5.670837e-02  0.005571281  4.645314e-02  6.833351e-02
sigma                4.731651e-02  0.002933124  4.196708e-02  5.345535e-02
r_ID[6,Intercept]    7.365707e-03  0.025731804 -4.367414e-02  5.821149e-02
r_ID[29,Intercept]  -4.294873e-02  0.029602225 -1.008998e-01  1.533892e-02
r_ID[34,Intercept]  -5.512252e-02  0.029627013 -1.132857e-01  2.337104e-03
r_ID[36,Intercept]  -2.083782e-02  0.029330151 -7.816040e-02  3.704874e-02
r_ID[37,Intercept]   3.067380e-03  0.025565571 -4.731446e-02  5.359054e-02
r_ID[48,Intercept]   2.951456e-02  0.025676401 -2.115828e-02  7.813181e-02
r_ID[53,Intercept]   5.874492e-03  0.029856691 -5.283035e-02  6.536125e-02
r_ID[54,Intercept]   5.006500e-02  0.025608086  4.810638e-05  1.002139e-01
r_ID[58,Intercept]   3.834425e-02  0.025261551 -1.115868e-02  8.767775e-02
r_ID[61,Intercept]  -6.933273e-02  0.030370893 -1.299183e-01 -1.011322e-02
r_ID[66,Intercept]   4.217768e-02  0.025383115 -7.443768e-03  9.188301e-02
r_ID[67,Intercept]   1.257196e-02  0.022487627 -3.205021e-02  5.690846e-02
r_ID[69,Intercept]   1.245007e-02  0.028283827 -4.267907e-02  6.764206e-02
r_ID[71,Intercept]  -1.047749e-01  0.025845371 -1.561854e-01 -5.381433e-02
r_ID[74,Intercept]   1.398717e-02  0.025809763 -3.709893e-02  6.371352e-02
r_ID[75,Intercept]   5.987898e-02  0.029557278  1.383434e-03  1.178726e-01
r_ID[76,Intercept]  -7.260905e-02  0.025454351 -1.221176e-01 -2.262357e-02
r_ID[78,Intercept]   4.727447e-02  0.025351671 -2.274342e-03  9.614280e-02
r_ID[79,Intercept]  -4.332142e-02  0.028666740 -9.985444e-02  1.304572e-02
r_ID[80,Intercept]  -3.338615e-02  0.029541447 -9.094584e-02  2.533545e-02
r_ID[81,Intercept]   4.468282e-02  0.025875362 -6.213619e-03  9.557265e-02
r_ID[82,Intercept]   1.196305e-01  0.023087407  7.458592e-02  1.645894e-01
r_ID[85,Intercept]  -2.679339e-02  0.029353325 -8.403728e-02  3.087414e-02
r_ID[86,Intercept]  -5.671391e-02  0.029230758 -1.136282e-01  3.135088e-04
r_ID[87,Intercept]  -5.975400e-02  0.029549718 -1.178488e-01 -1.269038e-03
r_ID[89,Intercept]  -4.511241e-02  0.025045894 -9.477729e-02  2.825421e-03
r_ID[91,Intercept]  -1.486806e-02  0.024972710 -6.344995e-02  3.439783e-02
r_ID[92,Intercept]   9.563044e-03  0.025025885 -3.959121e-02  5.777742e-02
r_ID[93,Intercept]   5.072168e-02  0.025598349  1.323002e-04  1.005786e-01
r_ID[94,Intercept]  -5.874171e-02  0.025411099 -1.092914e-01 -8.160009e-03
r_ID[96,Intercept]   2.818653e-02  0.029353220 -2.908296e-02  8.658670e-02
r_ID[97,Intercept]   4.945016e-02  0.022988076  4.232164e-03  9.418137e-02
r_ID[98,Intercept]  -4.307168e-02  0.022528705 -8.648116e-02  1.596159e-03
r_ID[99,Intercept]  -6.629387e-03  0.022677651 -5.223577e-02  3.809565e-02
r_ID[101,Intercept]  4.371327e-02  0.025646964 -5.980274e-03  9.505591e-02
r_ID[102,Intercept] -1.811568e-03  0.022695382 -4.594051e-02  4.173026e-02
r_ID[103,Intercept] -2.853653e-02  0.029094790 -8.549110e-02  2.765629e-02
r_ID[104,Intercept] -1.360900e-02  0.028906597 -6.990044e-02  4.352810e-02
r_ID[105,Intercept] -2.286403e-02  0.024966927 -7.191176e-02  2.593100e-02
r_ID[106,Intercept]  5.628244e-03  0.024981489 -4.317290e-02  5.544271e-02
r_ID[110,Intercept] -6.389311e-03  0.024917289 -5.561549e-02  4.297960e-02
r_ID[112,Intercept] -7.805704e-02  0.026077638 -1.279965e-01 -2.638628e-02
r_ID[114,Intercept] -4.684630e-02  0.025042693 -9.589051e-02  2.599923e-03
r_ID[115,Intercept] -3.976937e-02  0.025453806 -8.994426e-02  9.789406e-03
r_ID[116,Intercept] -3.771538e-02  0.025579645 -8.742118e-02  1.232891e-02
r_ID[120,Intercept]  1.178067e-01  0.030028491  5.752295e-02  1.759070e-01
r_ID[122,Intercept] -1.677586e-02  0.025399997 -6.669110e-02  3.353763e-02
r_ID[125,Intercept]  3.746859e-03  0.024943794 -4.546805e-02  5.274863e-02
r_ID[127,Intercept]  2.906199e-02  0.025004532 -2.001918e-02  7.819544e-02
r_ID[129,Intercept] -4.615920e-02  0.029026790 -1.037133e-01  1.100142e-02
r_ID[135,Intercept]  8.640316e-02  0.025686968  3.545103e-02  1.361081e-01
r_ID[136,Intercept]  8.146483e-02  0.025217564  3.175153e-02  1.307380e-01
r_ID[137,Intercept]  7.395952e-02  0.029820192  1.527080e-02  1.319618e-01
r_ID[140,Intercept] -4.801843e-02  0.029336401 -1.062262e-01  9.242976e-03
r_ID[141,Intercept]  8.448914e-04  0.029249215 -5.552762e-02  5.766044e-02
r_ID[142,Intercept] -9.227819e-03  0.028767228 -6.629232e-02  4.712142e-02
r_ID[143,Intercept]  8.738596e-02  0.029511533  2.963071e-02  1.456204e-01
r_ID[144,Intercept] -1.222306e-02  0.028904798 -6.811663e-02  4.430095e-02
r_ID[146,Intercept]  1.445459e-02  0.029339331 -4.333197e-02  7.337600e-02
r_ID[149,Intercept]  2.840905e-02  0.029568929 -2.970203e-02  8.622119e-02
r_ID[150,Intercept]  7.910038e-03  0.028939123 -4.910080e-02  6.439652e-02
r_ID[152,Intercept]  2.220899e-02  0.029334756 -3.506017e-02  8.006732e-02
r_ID[153,Intercept] -3.221761e-02  0.029199198 -8.986935e-02  2.521008e-02
r_ID[155,Intercept] -3.478631e-02  0.029375299 -9.197716e-02  2.408389e-02
r_ID[156,Intercept] -4.411287e-02  0.025175593 -9.328570e-02  5.002319e-03
r_ID[159,Intercept] -5.043752e-02  0.029382589 -1.074262e-01  7.965986e-03
r_ID[160,Intercept] -1.055755e-02  0.029468714 -6.866319e-02  4.713833e-02
r_ID[162,Intercept]  1.637661e-01  0.026439019  1.120089e-01  2.153536e-01
r_ID[163,Intercept] -4.217885e-02  0.028785853 -9.885516e-02  1.447865e-02
r_ID[165,Intercept]  4.545892e-03  0.028671107 -5.099875e-02  6.074066e-02
r_ID[167,Intercept] -4.280409e-02  0.029181786 -9.924144e-02  1.514441e-02
r_ID[169,Intercept]  3.984291e-02  0.029837732 -1.903054e-02  9.779733e-02
r_ID[171,Intercept]  2.788781e-02  0.028920065 -2.942898e-02  8.414554e-02
r_ID[174,Intercept]  5.355908e-02  0.029840769 -4.715711e-03  1.135731e-01
r_ID[182,Intercept] -2.492706e-03  0.029204541 -5.964457e-02  5.556924e-02
r_ID[187,Intercept] -9.319717e-02  0.029464066 -1.509185e-01 -3.504916e-02
r_ID[189,Intercept]  2.339273e-02  0.029181630 -3.322005e-02  8.081186e-02
r_ID[190,Intercept] -4.719972e-02  0.029364728 -1.051792e-01  1.023142e-02
r_ID[193,Intercept]  1.141311e-02  0.029434456 -4.779079e-02  6.914981e-02
r_ID[194,Intercept] -5.174900e-02  0.029157372 -1.086822e-01  4.818244e-03
r_ID[201,Intercept] -2.137385e-03  0.029070034 -5.854123e-02  5.556658e-02
r_ID[204,Intercept]  7.169953e-02  0.029254127  1.368136e-02  1.286256e-01
r_ID[205,Intercept]  1.979349e-03  0.029721402 -5.680617e-02  5.954486e-02
r_ID[208,Intercept]  1.064491e-02  0.029233673 -4.750901e-02  6.694176e-02
r_ID[209,Intercept]  1.683285e-02  0.029066014 -3.975163e-02  7.372425e-02
r_ID[211,Intercept] -3.793040e-02  0.028752381 -9.470966e-02  1.796184e-02
r_ID[214,Intercept]  6.336997e-02  0.029137329  5.668194e-03  1.203804e-01
r_ID[219,Intercept]  3.046883e-02  0.029501518 -2.767228e-02  8.822436e-02
r_ID[222,Intercept] -3.982453e-02  0.029002719 -9.701049e-02  1.709380e-02
r_ID[223,Intercept] -1.668723e-02  0.028616785 -7.312110e-02  3.966887e-02
r_ID[229,Intercept] -3.656376e-02  0.029415896 -9.406351e-02  2.126052e-02
prior_Intercept      3.628099e-03  1.490858166 -2.903607e+00  2.929187e+00
prior_b             -6.182730e-03  1.513961622 -2.962613e+00  3.007680e+00
prior_sigma          9.932137e-01  1.005350563  2.528490e-02  3.682698e+00
prior_sd_ID          1.195759e+00  0.898614921  4.316324e-02  3.350468e+00
lprior              -3.336070e+00  0.002985242 -3.342260e+00 -3.330640e+00
lp__                 2.304329e+02 11.002378103  2.078374e+02  2.510074e+02</code></pre>
</div>
</div>
</section>
<section id="random-slopes" class="slide level2">
<h2>Random slopes</h2>
<ol type="1">
<li><p>Modeling the joint population of intercepts and slopes, which means by modeling their covariance. We will use joint multivariate Gaussian distribution b/c it is max entropy distribution</p></li>
<li><p>Involves lots of interactions</p></li>
</ol>
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \gamma_{01}G_{j} +   U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10} + \gamma_{11}G_{j} + U_{1j}\]</span></p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim \mathcal{N} \begin{pmatrix}
  0,      \tau_{00}^{2} &amp; \tau_{01}\\
  0,  \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
</section>
<section id="random-slopes-1" class="slide level2">
<h2>Random slopes</h2>
<p><span class="math display">\[y_i \sim \text{Normal}(\mu, \sigma)\]</span> <span class="math display">\[\mu_i = \beta_{0j} + \beta_{1j}X_{ij}\]</span> <span class="math display">\[(\beta_{0j}, \beta_{1j}) \sim \text{MVNormal}  ([\beta_0, \beta_1], \Sigma)\]</span></p>
<p><span class="math display">\[\Sigma =
\left(\begin{array}{cc}
\sigma_{\beta_0}&amp;0\\
0&amp;\sigma_{\beta_1}
\end{array}\right)R
\left(\begin{array}{cc}
\sigma_{\beta_0}&amp;0\\
0&amp;\sigma_{\beta_1}
\end{array}\right)\]</span> <span class="math display">\[\beta_0 \sim \text{Normal}(0, 1)\]</span></p>
<p><span class="math display">\[\beta_1 \sim \text{Normal}(0, 1)\]</span> <span class="math display">\[\sigma_{\beta_0} \sim \text{Exponential}(1)\]</span> <span class="math display">\[\sigma_{\beta_1} \sim \text{Exponential}(1)\]</span> <span class="math display">\[\sigma \sim \text{Exponential}(1)\]</span> <span class="math display">\[R \sim \text{LKJcorr(2)}\]</span></p>
</section>
<section class="slide level2">

<p>where Σ is the covariance matrix</p>
<p><span class="math display">\[\Sigma =
\left(\begin{array}{cc}
\sigma^2_{\beta_0}&amp;\sigma_{\beta_0}\sigma_{\beta_1}\rho\\
\sigma_{\beta_0}\sigma_{\beta_1}\rho&amp;\sigma^2_{\beta_1}
\end{array}\right)\]</span></p>
<p>and R is the correlation matrix R = <span class="math inline">\(\begin{bmatrix} 1 &amp; \rho \\ \rho &amp; 1 \end{bmatrix}\)</span>.</p>
<p>With more random effects, this matrix expands.</p>
</section>
<section id="lkj" class="slide level2">
<h2>lkj</h2>
<p>Our regularizing prior for correlation matrices. Has one parameter to tune the potential associations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb58-2"><a href="#cb58-2"></a></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="fu">expand.grid</span>(</span>
<span id="cb58-4"><a href="#cb58-4"></a>  <span class="at">eta =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb58-5"><a href="#cb58-5"></a>  <span class="at">K =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(<span class="fu">ordered</span>(eta)), <span class="at">dist =</span> <span class="st">"lkjcorr_marginal"</span>, <span class="at">arg1 =</span> K, <span class="at">arg2 =</span> eta)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8"></a>  <span class="fu">stat_dist_slab</span>() <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="fu">paste0</span>(K, <span class="st">"x"</span>, K)) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-11"><a href="#cb58-11"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb58-12"><a href="#cb58-12"></a>      <span class="st">"LKJ(eta) prior on different matrix sizes:</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb58-13"><a href="#cb58-13"></a>    ),</span>
<span id="cb58-14"><a href="#cb58-14"></a>    <span class="at">y =</span> <span class="st">"eta"</span>,</span>
<span id="cb58-15"><a href="#cb58-15"></a>    <span class="at">x =</span> <span class="st">"Marginal correlation"</span></span>
<span id="cb58-16"><a href="#cb58-16"></a>  ) <span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-51-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">get_prior</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb59-2"><a href="#cb59-2"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> ID),</span>
<span id="cb59-3"><a href="#cb59-3"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class      coef group resp dpar nlpar lb ub
                 (flat)         b                                      
                 (flat)         b      time                            
                 lkj(1)       cor                                      
                 lkj(1)       cor              ID                      
 student_t(3, 0.2, 2.5) Intercept                                      
   student_t(3, 0, 2.5)        sd                                  0   
   student_t(3, 0, 2.5)        sd              ID                  0   
   student_t(3, 0, 2.5)        sd Intercept    ID                  0   
   student_t(3, 0, 2.5)        sd      time    ID                  0   
   student_t(3, 0, 2.5)     sigma                                  0   
       source
      default
 (vectorized)
      default
 (vectorized)
      default
      default
 (vectorized)
 (vectorized)
 (vectorized)
      default</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>mlm<span class="fl">.4</span> <span class="ot">&lt;-</span> </span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb61-3"><a href="#cb61-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> ID),</span>
<span id="cb61-4"><a href="#cb61-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb61-5"><a href="#cb61-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb61-6"><a href="#cb61-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb61-7"><a href="#cb61-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> time, <span class="at">group =</span> ID), </span>
<span id="cb61-8"><a href="#cb61-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb61-9"><a href="#cb61-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb61-10"><a href="#cb61-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb61-11"><a href="#cb61-11"></a>      <span class="at">file =</span> <span class="st">"mlm.4"</span>,</span>
<span id="cb61-12"><a href="#cb61-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb61-13"><a href="#cb61-13"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">summary</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + time + (1 + time | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)           0.06      0.01     0.05     0.07 1.00     3680     5470
sd(time)                0.00      0.00     0.00     0.01 1.00     1392     1534
cor(Intercept,time)    -0.09      0.40    -0.78     0.74 1.00    10248     7901

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.21 1.00     4864     5920
time         -0.00      0.00    -0.01     0.00 1.00    10374     9299

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     3584     4201

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>p.mlm4 <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(mlm<span class="fl">.4</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb64-3"><a href="#cb64-3"></a></span>
<span id="cb64-4"><a href="#cb64-4"></a>r_2 <span class="ot">&lt;-</span> </span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="fu">rlkjcorr</span>(<span class="dv">1000</span>, <span class="at">K =</span> <span class="dv">2</span>, <span class="at">eta =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb64-7"><a href="#cb64-7"></a></span>
<span id="cb64-8"><a href="#cb64-8"></a>p.mlm4 <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="#cb64-9"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> r_2, <span class="fu">aes</span>(<span class="at">x =</span> V2),</span>
<span id="cb64-11"><a href="#cb64-11"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> cor_ID__Intercept__time),</span>
<span id="cb64-13"><a href="#cb64-13"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb64-14"><a href="#cb64-14"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">1.1</span>, </span>
<span id="cb64-15"><a href="#cb64-15"></a>           <span class="at">label =</span> <span class="st">"posterior"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">family =</span> <span class="st">"Courier"</span>) <span class="sc">+</span></span>
<span id="cb64-16"><a href="#cb64-16"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> .<span class="dv">2</span>, <span class="at">y =</span> <span class="fl">1.35</span>, </span>
<span id="cb64-17"><a href="#cb64-17"></a>           <span class="at">label =</span> <span class="st">"prior"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">family =</span> <span class="st">"Courier"</span>) <span class="sc">+</span></span>
<span id="cb64-18"><a href="#cb64-18"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb64-19"><a href="#cb64-19"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Correlation between intercepts</span><span class="sc">\n</span><span class="st">and slopes, prior and posterior"</span>,</span>
<span id="cb64-20"><a href="#cb64-20"></a>  <span class="at">x =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-55-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>partially_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.4</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb65-4"><a href="#cb65-4"></a></span>
<span id="cb65-5"><a href="#cb65-5"></a></span>
<span id="cb65-6"><a href="#cb65-6"></a>un_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb65-7"><a href="#cb65-7"></a>  mlm <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>  <span class="fu">group_by</span>(ID, time) <span class="sc">%&gt;%</span></span>
<span id="cb65-9"><a href="#cb65-9"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(CON)) <span class="sc">%&gt;%</span></span>
<span id="cb65-10"><a href="#cb65-10"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> time, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb65-11"><a href="#cb65-11"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb65-12"><a href="#cb65-12"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb65-13"><a href="#cb65-13"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb65-14"><a href="#cb65-14"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-15"><a href="#cb65-15"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-16"><a href="#cb65-16"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb65-17"><a href="#cb65-17"></a></span>
<span id="cb65-18"><a href="#cb65-18"></a>params <span class="ot">&lt;-</span></span>
<span id="cb65-19"><a href="#cb65-19"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb65-20"><a href="#cb65-20"></a>  <span class="fu">bind_rows</span>(partially_pooled_params, un_pooled_params) <span class="sc">%&gt;%</span></span>
<span id="cb65-21"><a href="#cb65-21"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb65-22"><a href="#cb65-22"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb65-23"><a href="#cb65-23"></a></span>
<span id="cb65-24"><a href="#cb65-24"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb65-25"><a href="#cb65-25"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb65-26"><a href="#cb65-26"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-27"><a href="#cb65-27"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-28"><a href="#cb65-28"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-29"><a href="#cb65-29"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-30"><a href="#cb65-30"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-31"><a href="#cb65-31"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">6</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-32"><a href="#cb65-32"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-33"><a href="#cb65-33"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">8</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-34"><a href="#cb65-34"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-35"><a href="#cb65-35"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> .<span class="dv">99</span>,  <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb65-36"><a href="#cb65-36"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb65-37"><a href="#cb65-37"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb65-38"><a href="#cb65-38"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb65-39"><a href="#cb65-39"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb65-40"><a href="#cb65-40"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(params<span class="sc">$</span>time),</span>
<span id="cb65-41"><a href="#cb65-41"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(params<span class="sc">$</span>Intercept))</span>
<span id="cb65-42"><a href="#cb65-42"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-56-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">get_variables</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"             "b_time"                 
  [3] "sd_ID__Intercept"        "sd_ID__time"            
  [5] "cor_ID__Intercept__time" "sigma"                  
  [7] "r_ID[6,Intercept]"       "r_ID[29,Intercept]"     
  [9] "r_ID[34,Intercept]"      "r_ID[36,Intercept]"     
 [11] "r_ID[37,Intercept]"      "r_ID[48,Intercept]"     
 [13] "r_ID[53,Intercept]"      "r_ID[54,Intercept]"     
 [15] "r_ID[58,Intercept]"      "r_ID[61,Intercept]"     
 [17] "r_ID[66,Intercept]"      "r_ID[67,Intercept]"     
 [19] "r_ID[69,Intercept]"      "r_ID[71,Intercept]"     
 [21] "r_ID[74,Intercept]"      "r_ID[75,Intercept]"     
 [23] "r_ID[76,Intercept]"      "r_ID[78,Intercept]"     
 [25] "r_ID[79,Intercept]"      "r_ID[80,Intercept]"     
 [27] "r_ID[81,Intercept]"      "r_ID[82,Intercept]"     
 [29] "r_ID[85,Intercept]"      "r_ID[86,Intercept]"     
 [31] "r_ID[87,Intercept]"      "r_ID[89,Intercept]"     
 [33] "r_ID[91,Intercept]"      "r_ID[92,Intercept]"     
 [35] "r_ID[93,Intercept]"      "r_ID[94,Intercept]"     
 [37] "r_ID[96,Intercept]"      "r_ID[97,Intercept]"     
 [39] "r_ID[98,Intercept]"      "r_ID[99,Intercept]"     
 [41] "r_ID[101,Intercept]"     "r_ID[102,Intercept]"    
 [43] "r_ID[103,Intercept]"     "r_ID[104,Intercept]"    
 [45] "r_ID[105,Intercept]"     "r_ID[106,Intercept]"    
 [47] "r_ID[110,Intercept]"     "r_ID[112,Intercept]"    
 [49] "r_ID[114,Intercept]"     "r_ID[115,Intercept]"    
 [51] "r_ID[116,Intercept]"     "r_ID[120,Intercept]"    
 [53] "r_ID[122,Intercept]"     "r_ID[125,Intercept]"    
 [55] "r_ID[127,Intercept]"     "r_ID[129,Intercept]"    
 [57] "r_ID[135,Intercept]"     "r_ID[136,Intercept]"    
 [59] "r_ID[137,Intercept]"     "r_ID[140,Intercept]"    
 [61] "r_ID[141,Intercept]"     "r_ID[142,Intercept]"    
 [63] "r_ID[143,Intercept]"     "r_ID[144,Intercept]"    
 [65] "r_ID[146,Intercept]"     "r_ID[149,Intercept]"    
 [67] "r_ID[150,Intercept]"     "r_ID[152,Intercept]"    
 [69] "r_ID[153,Intercept]"     "r_ID[155,Intercept]"    
 [71] "r_ID[156,Intercept]"     "r_ID[159,Intercept]"    
 [73] "r_ID[160,Intercept]"     "r_ID[162,Intercept]"    
 [75] "r_ID[163,Intercept]"     "r_ID[165,Intercept]"    
 [77] "r_ID[167,Intercept]"     "r_ID[169,Intercept]"    
 [79] "r_ID[171,Intercept]"     "r_ID[174,Intercept]"    
 [81] "r_ID[182,Intercept]"     "r_ID[187,Intercept]"    
 [83] "r_ID[189,Intercept]"     "r_ID[190,Intercept]"    
 [85] "r_ID[193,Intercept]"     "r_ID[194,Intercept]"    
 [87] "r_ID[201,Intercept]"     "r_ID[204,Intercept]"    
 [89] "r_ID[205,Intercept]"     "r_ID[208,Intercept]"    
 [91] "r_ID[209,Intercept]"     "r_ID[211,Intercept]"    
 [93] "r_ID[214,Intercept]"     "r_ID[219,Intercept]"    
 [95] "r_ID[222,Intercept]"     "r_ID[223,Intercept]"    
 [97] "r_ID[229,Intercept]"     "r_ID[6,time]"           
 [99] "r_ID[29,time]"           "r_ID[34,time]"          
[101] "r_ID[36,time]"           "r_ID[37,time]"          
[103] "r_ID[48,time]"           "r_ID[53,time]"          
[105] "r_ID[54,time]"           "r_ID[58,time]"          
[107] "r_ID[61,time]"           "r_ID[66,time]"          
[109] "r_ID[67,time]"           "r_ID[69,time]"          
[111] "r_ID[71,time]"           "r_ID[74,time]"          
[113] "r_ID[75,time]"           "r_ID[76,time]"          
[115] "r_ID[78,time]"           "r_ID[79,time]"          
[117] "r_ID[80,time]"           "r_ID[81,time]"          
[119] "r_ID[82,time]"           "r_ID[85,time]"          
[121] "r_ID[86,time]"           "r_ID[87,time]"          
[123] "r_ID[89,time]"           "r_ID[91,time]"          
[125] "r_ID[92,time]"           "r_ID[93,time]"          
[127] "r_ID[94,time]"           "r_ID[96,time]"          
[129] "r_ID[97,time]"           "r_ID[98,time]"          
[131] "r_ID[99,time]"           "r_ID[101,time]"         
[133] "r_ID[102,time]"          "r_ID[103,time]"         
[135] "r_ID[104,time]"          "r_ID[105,time]"         
[137] "r_ID[106,time]"          "r_ID[110,time]"         
[139] "r_ID[112,time]"          "r_ID[114,time]"         
[141] "r_ID[115,time]"          "r_ID[116,time]"         
[143] "r_ID[120,time]"          "r_ID[122,time]"         
[145] "r_ID[125,time]"          "r_ID[127,time]"         
[147] "r_ID[129,time]"          "r_ID[135,time]"         
[149] "r_ID[136,time]"          "r_ID[137,time]"         
[151] "r_ID[140,time]"          "r_ID[141,time]"         
[153] "r_ID[142,time]"          "r_ID[143,time]"         
[155] "r_ID[144,time]"          "r_ID[146,time]"         
[157] "r_ID[149,time]"          "r_ID[150,time]"         
[159] "r_ID[152,time]"          "r_ID[153,time]"         
[161] "r_ID[155,time]"          "r_ID[156,time]"         
[163] "r_ID[159,time]"          "r_ID[160,time]"         
[165] "r_ID[162,time]"          "r_ID[163,time]"         
[167] "r_ID[165,time]"          "r_ID[167,time]"         
[169] "r_ID[169,time]"          "r_ID[171,time]"         
[171] "r_ID[174,time]"          "r_ID[182,time]"         
[173] "r_ID[187,time]"          "r_ID[189,time]"         
[175] "r_ID[190,time]"          "r_ID[193,time]"         
[177] "r_ID[194,time]"          "r_ID[201,time]"         
[179] "r_ID[204,time]"          "r_ID[205,time]"         
[181] "r_ID[208,time]"          "r_ID[209,time]"         
[183] "r_ID[211,time]"          "r_ID[214,time]"         
[185] "r_ID[219,time]"          "r_ID[222,time]"         
[187] "r_ID[223,time]"          "r_ID[229,time]"         
[189] "lprior"                  "lp__"                   
[191] "accept_stat__"           "treedepth__"            
[193] "stepsize__"              "divergent__"            
[195] "n_leapfrog__"            "energy__"               </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID,term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,184,000 × 6
# Groups:   ID, term [182]
      ID term         r_ID .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6 Intercept -0.0305      1          1     1
 2     6 Intercept  0.0222      1          2     2
 3     6 Intercept  0.0429      1          3     3
 4     6 Intercept  0.0735      1          4     4
 5     6 Intercept  0.0423      1          5     5
 6     6 Intercept -0.0271      1          6     6
 7     6 Intercept  0.0114      1          7     7
 8     6 Intercept  0.0146      1          8     8
 9     6 Intercept  0.0356      1          9     9
10     6 Intercept -0.0478      1         10    10
# ℹ 2,183,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">spread_draws</span>(b_time, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="fu">mutate</span>(<span class="at">person_t =</span> b_time <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="#cb70-5"></a> <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 14
# Groups:   ID [91]
      ID term    b_time b_time.lower b_time.upper     r_ID r_ID.lower r_ID.upper
   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1     6 time  -0.00285     -0.00733      0.00148  2.26e-5   -0.00993    0.0104 
 2    29 time  -0.00285     -0.00733      0.00148 -3.77e-4   -0.0135     0.00798
 3    34 time  -0.00285     -0.00733      0.00148 -6.00e-4   -0.0150     0.00669
 4    36 time  -0.00285     -0.00733      0.00148  1.38e-4   -0.00916    0.0130 
 5    37 time  -0.00285     -0.00733      0.00148 -2.17e-4   -0.0123     0.00748
 6    48 time  -0.00285     -0.00733      0.00148 -2.82e-5   -0.0108     0.00890
 7    53 time  -0.00285     -0.00733      0.00148 -2.33e-4   -0.0128     0.00789
 8    54 time  -0.00285     -0.00733      0.00148  2.22e-4   -0.00844    0.0112 
 9    58 time  -0.00285     -0.00733      0.00148  5.06e-4   -0.00714    0.0159 
10    61 time  -0.00285     -0.00733      0.00148 -5.52e-5   -0.0103     0.0104 
# ℹ 81 more rows
# ℹ 6 more variables: person_t &lt;dbl&gt;, person_t.lower &lt;dbl&gt;,
#   person_t.upper &lt;dbl&gt;, .width &lt;dbl&gt;, .point &lt;chr&gt;, .interval &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>  <span class="fu">spread_draws</span>(b_time, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-4"><a href="#cb72-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_time <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>  <span class="fu">geom_pointinterval</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-60-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>coef = fixef + raneff</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">ranef</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ID
, , Intercept

        Estimate  Est.Error          Q2.5         Q97.5
6    0.007615453 0.03252224 -0.0578827275  0.0737854450
29  -0.038522996 0.03441149 -0.1055137500  0.0320436775
34  -0.047083982 0.03618702 -0.1162136750  0.0270344450
36  -0.022320498 0.03162196 -0.0870033775  0.0388022725
37   0.007656584 0.03146658 -0.0524625450  0.0740345600
48   0.031615185 0.03122640 -0.0279744650  0.0944293925
53   0.010476539 0.03486882 -0.0569304300  0.0823023100
54   0.048527727 0.02925550 -0.0089570085  0.1061710250
58   0.034719594 0.02751295 -0.0202769150  0.0882244625
61  -0.068692682 0.03439984 -0.1372267000 -0.0012850443
66   0.036022969 0.02822510 -0.0209428050  0.0897944000
67   0.013410944 0.02576122 -0.0365262125  0.0644596925
69   0.013336496 0.03023983 -0.0459410150  0.0723857250
71  -0.103963603 0.02786510 -0.1586993500 -0.0502826275
74   0.013148162 0.02730057 -0.0402124500  0.0664050800
75   0.057652262 0.03009998 -0.0006680034  0.1165857750
76  -0.073175560 0.02713120 -0.1267734500 -0.0203639950
78   0.043709835 0.02784872 -0.0120468600  0.0979385400
79  -0.045399472 0.03140469 -0.1083763250  0.0154457850
80  -0.032052762 0.03270438 -0.0972109175  0.0327624625
81   0.040462983 0.02767271 -0.0148234125  0.0951225050
82   0.115803413 0.02585824  0.0641412225  0.1662157250
85  -0.027387728 0.02934635 -0.0844615250  0.0298338825
86  -0.057584543 0.02962470 -0.1159385000  0.0006214602
87  -0.058118892 0.02974881 -0.1167742500  0.0006038926
89  -0.045870683 0.02565755 -0.0972854900  0.0048550312
91  -0.014820238 0.02544880 -0.0639787875  0.0349605400
92   0.010176988 0.02585820 -0.0405100900  0.0612099575
93   0.052968220 0.02660675  0.0006414136  0.1059083000
94  -0.058906832 0.02574714 -0.1099539750 -0.0082552420
96   0.028165441 0.02934842 -0.0293566050  0.0860670900
97   0.048551963 0.02378491  0.0024616653  0.0955530500
98  -0.040178599 0.02371451 -0.0859624875  0.0068937800
99  -0.007500986 0.02344070 -0.0545115725  0.0381018425
101  0.043383885 0.02589996 -0.0070595170  0.0946530800
102 -0.001323921 0.02357714 -0.0484182600  0.0444872850
103 -0.028799621 0.02954785 -0.0869398950  0.0292530025
104 -0.013909269 0.02940668 -0.0716470725  0.0450257600
105 -0.022891713 0.02551184 -0.0728020050  0.0281616925
106  0.006191776 0.02561836 -0.0437309850  0.0565493750
110 -0.004154105 0.02642290 -0.0560751600  0.0478691225
112 -0.080096132 0.02660208 -0.1327171500 -0.0283985725
114 -0.048250346 0.02654446 -0.1002302000  0.0038963780
115 -0.042402763 0.02621694 -0.0948810025  0.0081977222
116 -0.040154239 0.02651747 -0.0927206950  0.0113551025
120  0.118989213 0.03100491  0.0572451850  0.1786435500
122 -0.017513890 0.02578695 -0.0682411000  0.0333923400
125  0.003294487 0.02590884 -0.0469308575  0.0537190200
127  0.030279255 0.02635988 -0.0219628750  0.0823614375
129 -0.046506924 0.02970629 -0.1046983500  0.0115732050
135  0.084698474 0.02598733  0.0337368575  0.1356741250
136  0.082864310 0.02616971  0.0322435100  0.1350587250
137  0.074771228 0.02972832  0.0154131600  0.1333669250
140 -0.048543514 0.02955252 -0.1072460000  0.0090248392
141 -0.001257417 0.03025288 -0.0620127175  0.0576920625
142 -0.009229460 0.02967048 -0.0674717500  0.0492496050
143  0.087489258 0.02914816  0.0301408025  0.1449002500
144 -0.013988989 0.03020311 -0.0737685925  0.0453288750
146  0.013256309 0.03013604 -0.0459311775  0.0726141650
149  0.029135926 0.02961398 -0.0292106025  0.0872875075
150  0.007271138 0.02924965 -0.0504092925  0.0649698925
152  0.023131288 0.02881053 -0.0334762250  0.0808113725
153 -0.030783118 0.02970065 -0.0886153050  0.0274846300
155 -0.035667088 0.03076378 -0.0967039200  0.0241325150
156 -0.042890656 0.02602960 -0.0938660325  0.0076036865
159 -0.051085547 0.02943605 -0.1092207750  0.0060545250
160 -0.013093617 0.03000212 -0.0728977175  0.0449497200
162  0.167639066 0.02860649  0.1114064750  0.2245313250
163 -0.042839384 0.03019477 -0.1026945750  0.0163224600
165  0.006586790 0.02970690 -0.0515849175  0.0660422400
167 -0.041717561 0.02995113 -0.1010228500  0.0179313575
169  0.040888104 0.03014918 -0.0183745850  0.1000542000
171  0.028888742 0.02932718 -0.0281135800  0.0871267800
174  0.054888625 0.03033926 -0.0042051312  0.1149615750
182 -0.003455581 0.03016133 -0.0622636200  0.0565081675
187 -0.093128911 0.03035454 -0.1538470000 -0.0338192600
189  0.020560531 0.02993873 -0.0391723225  0.0792529825
190 -0.046084827 0.02949334 -0.1037250750  0.0128021475
193  0.013043210 0.02976309 -0.0450824125  0.0726577200
194 -0.050775806 0.03032844 -0.1098691250  0.0089867597
201 -0.003287438 0.03006902 -0.0626416475  0.0561954800
204  0.073907283 0.03046740  0.0146331025  0.1337221000
205  0.003158917 0.02997340 -0.0562664175  0.0625249300
208  0.008258996 0.03041757 -0.0518646750  0.0682629475
209  0.015012128 0.03028262 -0.0436128150  0.0743595250
211 -0.036201358 0.02974412 -0.0953698050  0.0218172300
214  0.064221324 0.03057080  0.0040684545  0.1245375250
219  0.029328662 0.03033499 -0.0302262775  0.0897274800
222 -0.041794064 0.02976366 -0.1013622250  0.0163525625
223 -0.013377983 0.03012596 -0.0727548875  0.0468946775
229 -0.034582345 0.02959948 -0.0925194700  0.0237317525

, , time

         Estimate   Est.Error         Q2.5       Q97.5
6    1.355056e-04 0.004542989 -0.009930840 0.010379977
29  -1.198426e-03 0.004956269 -0.013512320 0.007981281
34  -1.758486e-03 0.005102954 -0.015002260 0.006687913
36   6.715553e-04 0.004942463 -0.009159028 0.012951875
37  -9.385577e-04 0.004565985 -0.012282935 0.007479675
48  -3.589154e-04 0.004555361 -0.010845973 0.008902104
53  -9.956419e-04 0.004736298 -0.012792885 0.007886260
54   7.138628e-04 0.004495710 -0.008441363 0.011203702
58   1.695987e-03 0.005275195 -0.007136931 0.015867805
61  -1.127045e-04 0.004654304 -0.010250925 0.010359127
66   2.328290e-03 0.004824371 -0.005016221 0.014723060
67  -1.238025e-04 0.004236539 -0.009439422 0.009169404
69  -5.777132e-04 0.004967028 -0.012372687 0.009381806
71  -6.712784e-04 0.005784931 -0.013558690 0.011339987
74   4.136031e-04 0.004060902 -0.007948930 0.009625788
75   1.474266e-03 0.005276229 -0.007793251 0.014926745
76   7.334171e-05 0.005225282 -0.011050697 0.012009730
78   1.425417e-03 0.004470655 -0.006584369 0.012382112
79   9.608141e-04 0.005272771 -0.008857370 0.014086470
80  -3.513418e-04 0.004500662 -0.010257140 0.009331658
81   1.640714e-03 0.004621611 -0.006156402 0.012871807
82   1.589305e-03 0.005052699 -0.007819075 0.013602202
85   4.138393e-04 0.004949899 -0.010088640 0.011799312
86   4.526474e-04 0.005234104 -0.010275338 0.012432250
87  -1.531745e-03 0.005569631 -0.015698535 0.007904927
89   6.579730e-04 0.004920299 -0.009077636 0.012656320
91  -2.517045e-04 0.004797226 -0.011203665 0.010161167
92  -2.314991e-04 0.004618758 -0.010866920 0.009481332
93  -1.227419e-03 0.005233022 -0.014578717 0.007891778
94  -4.632159e-04 0.005025626 -0.012225293 0.009905601
96   3.114694e-04 0.005094874 -0.010314660 0.011535065
97   6.088999e-04 0.004902012 -0.009049323 0.012150535
98  -1.922769e-03 0.005318095 -0.015593238 0.006562407
99   3.555635e-04 0.004785581 -0.009420397 0.011349610
101  3.459962e-04 0.004881576 -0.009974814 0.011610680
102 -2.140147e-04 0.004682780 -0.010995352 0.009551509
103  1.702971e-05 0.005060913 -0.010903527 0.011290227
104 -9.572873e-05 0.004872183 -0.011343865 0.010432742
105 -4.709613e-04 0.004950786 -0.012364297 0.009757181
106 -3.080508e-04 0.004671084 -0.011009220 0.009622250
110 -1.038097e-03 0.004653318 -0.012670890 0.007661036
112  1.074708e-03 0.005280828 -0.008364053 0.014198962
114  9.460187e-04 0.005163576 -0.008735931 0.013830337
115  1.789562e-03 0.005216273 -0.006556593 0.015738347
116  1.669794e-03 0.005269921 -0.006779861 0.015918187
120 -9.157938e-04 0.006179902 -0.016175958 0.011071712
122  5.907547e-04 0.004655939 -0.008462240 0.011620057
125  2.730565e-04 0.004719445 -0.009775196 0.011066740
127 -7.038811e-04 0.004953320 -0.012810347 0.008769380
129  3.203448e-04 0.005092938 -0.010118285 0.011804352
135  1.462619e-03 0.005519207 -0.008387139 0.015181175
136 -1.055205e-03 0.005332518 -0.014264035 0.008937337
137 -7.805538e-04 0.005439064 -0.013637575 0.009897000
140  2.106810e-04 0.005078636 -0.010761347 0.012022280
141  1.345032e-03 0.005035710 -0.007392660 0.014107627
142  9.301592e-06 0.004737211 -0.010473283 0.010783900
143 -5.747088e-05 0.005485877 -0.012410733 0.011834662
144  8.863202e-04 0.004875429 -0.008095965 0.012710700
146  6.625338e-04 0.004814246 -0.008905776 0.012084800
149 -7.684240e-04 0.004886548 -0.012692597 0.008953670
150  4.617370e-04 0.004683161 -0.009403544 0.011692910
152 -7.678470e-04 0.005045208 -0.013247500 0.009127926
153 -1.379591e-03 0.005008199 -0.013982560 0.007399784
155  3.616377e-04 0.005052166 -0.010165110 0.012066872
156 -9.985046e-04 0.005068714 -0.013600845 0.008407128
159  4.573291e-04 0.005244907 -0.010076245 0.013271827
160  1.737954e-03 0.005229764 -0.006474576 0.015277752
162 -2.370641e-03 0.007343209 -0.020936570 0.010038907
163  1.183655e-05 0.004856271 -0.010672720 0.011127160
165 -1.127790e-03 0.004864667 -0.013500717 0.007712752
167 -7.077635e-04 0.004768041 -0.012246347 0.008667861
169 -3.648755e-04 0.005019194 -0.012390090 0.009836439
171 -6.977894e-04 0.004770940 -0.012060078 0.008874214
174 -9.621205e-04 0.005077317 -0.013487787 0.008484766
182  5.237751e-04 0.004718996 -0.008716350 0.011790100
187  1.372144e-05 0.005162792 -0.011428495 0.011581592
189  1.770557e-03 0.005178402 -0.006267084 0.015569040
190 -1.007282e-03 0.005011369 -0.013079912 0.008516649
193 -8.804816e-04 0.004861901 -0.012506155 0.008103943
194 -6.429425e-04 0.005013373 -0.012745040 0.009525531
201  5.475888e-04 0.004619639 -0.008727812 0.011507385
204 -1.523694e-03 0.005399577 -0.015859212 0.007873040
205 -7.761356e-04 0.004886587 -0.012779012 0.008703031
208  1.756128e-03 0.005314003 -0.006872487 0.015391820
209  1.300288e-03 0.004820871 -0.007158682 0.013250587
211 -1.276512e-03 0.005179498 -0.014436540 0.007713174
214 -3.450529e-04 0.004980358 -0.012002282 0.009990670
219  8.871930e-04 0.004833811 -0.008401774 0.012616665
222  1.436926e-03 0.005123047 -0.007370131 0.015075517
223 -2.236541e-03 0.005496413 -0.017103960 0.005826009
229 -1.738052e-03 0.005286092 -0.014962237 0.007019519</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>coef = fixef + raneff</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">coef</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ID
, , Intercept

      Estimate  Est.Error       Q2.5     Q97.5
6   0.20197711 0.03312215 0.13629758 0.2686843
29  0.15583866 0.03508179 0.08739648 0.2266863
34  0.14727767 0.03675446 0.07731670 0.2224352
36  0.17204116 0.03170521 0.10852342 0.2334044
37  0.20201824 0.03214163 0.14035118 0.2700478
48  0.22597684 0.03157051 0.16506324 0.2900255
53  0.20483820 0.03524434 0.13712673 0.2758132
54  0.24288938 0.02942424 0.18498264 0.3009498
58  0.22908125 0.02728236 0.17460751 0.2815035
61  0.12566897 0.03492297 0.05551168 0.1935232
66  0.23038463 0.02800373 0.17372926 0.2838676
67  0.20777260 0.02575239 0.15717044 0.2585607
69  0.20769815 0.03010346 0.14848124 0.2670535
71  0.09039805 0.02775266 0.03612870 0.1442382
74  0.20750982 0.02725151 0.15432573 0.2611940
75  0.25201392 0.02979166 0.19362551 0.3097358
76  0.12118610 0.02700761 0.06790960 0.1737814
78  0.23807149 0.02768293 0.18281630 0.2916082
79  0.14896218 0.03128202 0.08657505 0.2101104
80  0.16230890 0.03300146 0.09653027 0.2269164
81  0.23482464 0.02747335 0.17882378 0.2882614
82  0.31016507 0.02535712 0.25945639 0.3596315
85  0.16697393 0.02891874 0.11138238 0.2238516
86  0.13677711 0.02928522 0.07955120 0.1944214
87  0.13624276 0.02967727 0.07824745 0.1952127
89  0.14849097 0.02517805 0.09906474 0.1979867
91  0.17954142 0.02493577 0.13032801 0.2289275
92  0.20453864 0.02561286 0.15438635 0.2547167
93  0.24732988 0.02627798 0.19573415 0.2994517
94  0.13545483 0.02538544 0.08508083 0.1850772
96  0.22252710 0.02897806 0.16541237 0.2790787
97  0.24291362 0.02332169 0.19710864 0.2886775
98  0.15418306 0.02340449 0.10887163 0.2009407
99  0.18686067 0.02298683 0.14121080 0.2318663
101 0.23774554 0.02542983 0.18771998 0.2886209
102 0.19303774 0.02312655 0.14781750 0.2387189
103 0.16556204 0.02914410 0.10847919 0.2223128
104 0.18045239 0.02890798 0.12351663 0.2375007
105 0.17146994 0.02503019 0.12208264 0.2205833
106 0.20055343 0.02531624 0.15096108 0.2502141
110 0.19020755 0.02629955 0.13801353 0.2419980
112 0.11426552 0.02606774 0.06310262 0.1646636
114 0.14611131 0.02616748 0.09517720 0.1970049
115 0.15195889 0.02588511 0.10056968 0.2022763
116 0.15420742 0.02603708 0.10221876 0.2045115
120 0.31335087 0.03054124 0.25239471 0.3722826
122 0.17684777 0.02532354 0.12738015 0.2266601
125 0.19765614 0.02549701 0.14845285 0.2474907
127 0.22464091 0.02589104 0.17386840 0.2752126
129 0.14785473 0.02920763 0.09028326 0.2044223
135 0.27906013 0.02542475 0.22951447 0.3288388
136 0.27722597 0.02574994 0.22747060 0.3279517
137 0.26913289 0.02924663 0.21020172 0.3274080
140 0.14581814 0.02912052 0.08858507 0.2020198
141 0.19310424 0.02996978 0.13386296 0.2518129
142 0.18513220 0.02946063 0.12734467 0.2430851
143 0.28185091 0.02863065 0.22571527 0.3374455
144 0.18037267 0.03003837 0.12126835 0.2390942
146 0.20761797 0.02991765 0.14926726 0.2662614
149 0.22349758 0.02953178 0.16633117 0.2815753
150 0.20163279 0.02905575 0.14506061 0.2585936
152 0.21749294 0.02850600 0.16162463 0.2738252
153 0.16357854 0.02962247 0.10613301 0.2218612
155 0.15869457 0.03073348 0.09745924 0.2176829
156 0.15147100 0.02583430 0.10109383 0.2013918
159 0.14327611 0.02909629 0.08598505 0.1999305
160 0.18126804 0.02984718 0.12182726 0.2393006
162 0.36200072 0.02811508 0.30693350 0.4180443
163 0.15152227 0.02993162 0.09277292 0.2100370
165 0.20094845 0.02960133 0.14232319 0.2602228
167 0.15264410 0.02978636 0.09394262 0.2112675
169 0.23524976 0.02995950 0.17631329 0.2946652
171 0.22325040 0.02908590 0.16702498 0.2810668
174 0.24925028 0.03013152 0.19010338 0.3087372
182 0.19090608 0.02996169 0.13169306 0.2505353
187 0.10123275 0.03018818 0.04028655 0.1609882
189 0.21492219 0.02964694 0.15507301 0.2722769
190 0.14827683 0.02931657 0.09159391 0.2068285
193 0.20740487 0.02952540 0.15026663 0.2665222
194 0.14358585 0.03009075 0.08495676 0.2023702
201 0.19107422 0.02977168 0.13263540 0.2492340
204 0.26826894 0.03033500 0.20858014 0.3275495
205 0.19752057 0.02982269 0.13816578 0.2561400
208 0.20262065 0.03011276 0.14254070 0.2611259
209 0.20937378 0.03005141 0.15097768 0.2675993
211 0.15816030 0.02959448 0.09937452 0.2159369
214 0.25858298 0.03024844 0.19865241 0.3183141
219 0.22369032 0.03000554 0.16410931 0.2835013
222 0.15256759 0.02951596 0.09374690 0.2094176
223 0.18098367 0.02989263 0.12206652 0.2407062
229 0.15977931 0.02946188 0.10178128 0.2173246

, , time

         Estimate   Est.Error         Q2.5       Q97.5
6   -0.0027309611 0.004986505 -0.013689579 0.007766937
29  -0.0040648932 0.005529643 -0.017340728 0.005607243
34  -0.0046249527 0.005625424 -0.018602977 0.004761649
36  -0.0021949114 0.005388073 -0.012685686 0.010259374
37  -0.0038050245 0.005003585 -0.015650961 0.005018518
48  -0.0032253822 0.004950476 -0.014242920 0.006106532
53  -0.0038621086 0.005229834 -0.016580240 0.005395507
54  -0.0021526040 0.004800248 -0.011797360 0.008313826
58  -0.0011704796 0.005567250 -0.010836818 0.012741982
61  -0.0029791713 0.005199060 -0.013929714 0.007938344
66  -0.0005381767 0.004998151 -0.008699570 0.011913001
67  -0.0029902693 0.004662899 -0.013289058 0.006500820
69  -0.0034441800 0.005394906 -0.016083391 0.006684785
71  -0.0035377451 0.006316103 -0.017372389 0.009275506
74  -0.0024528636 0.004416105 -0.011469521 0.006959489
75  -0.0013922003 0.005549904 -0.011528849 0.012146969
76  -0.0027931250 0.005779747 -0.014758311 0.009436959
78  -0.0014410501 0.004689536 -0.010032536 0.009458592
79  -0.0019056526 0.005753676 -0.012755602 0.011422442
80  -0.0032178086 0.004997651 -0.014017297 0.006713816
81  -0.0012257529 0.004828245 -0.009859522 0.010182692
82  -0.0012771618 0.005163704 -0.011020368 0.010455581
85  -0.0024526274 0.005434575 -0.013980416 0.009257729
86  -0.0024138194 0.005772473 -0.014540184 0.010054380
87  -0.0043982114 0.006180879 -0.019700242 0.005958717
89  -0.0022084938 0.005431254 -0.012894936 0.010192368
91  -0.0031181713 0.005302914 -0.014922649 0.007407841
92  -0.0030979659 0.005135415 -0.014706782 0.007239811
93  -0.0040938859 0.005633149 -0.017822653 0.005444915
94  -0.0033296826 0.005574531 -0.016104345 0.007824486
96  -0.0025549973 0.005513580 -0.014164247 0.009130955
97  -0.0022575668 0.005262437 -0.012698825 0.009507674
98  -0.0047892362 0.005904891 -0.019534308 0.004574096
99  -0.0025109032 0.005171280 -0.012989376 0.008947423
101 -0.0025204705 0.005242175 -0.013490724 0.008756880
102 -0.0030804814 0.005155190 -0.014639157 0.007001263
103 -0.0028494370 0.005554444 -0.014596341 0.008868654
104 -0.0029621955 0.005359079 -0.015087302 0.008060122
105 -0.0033374281 0.005489336 -0.016319193 0.007372623
106 -0.0031745175 0.005173027 -0.014736320 0.007206560
110 -0.0039045640 0.005172487 -0.016575438 0.005065785
112 -0.0017917585 0.005777434 -0.012314171 0.011747677
114 -0.0019204481 0.005583164 -0.012817005 0.011320890
115 -0.0010769052 0.005591060 -0.010651192 0.012847529
116 -0.0011966726 0.005618386 -0.010578799 0.013083642
120 -0.0037822606 0.006488150 -0.019512646 0.008360040
122 -0.0022757120 0.005074167 -0.012152635 0.009021942
125 -0.0025934102 0.005161355 -0.013619820 0.008635732
127 -0.0035703479 0.005388703 -0.016403388 0.006122268
129 -0.0025461219 0.005614502 -0.013826437 0.009511345
135 -0.0014038482 0.005736879 -0.011834751 0.012227976
136 -0.0039216715 0.005694687 -0.017694778 0.006206600
137 -0.0036470206 0.005817287 -0.017109930 0.007321650
140 -0.0026557858 0.005600005 -0.014558548 0.009759744
141 -0.0015214347 0.005380638 -0.011131377 0.011326477
142 -0.0028571652 0.005186636 -0.014278228 0.007875486
143 -0.0029239376 0.005795787 -0.015776951 0.009004066
144 -0.0019801466 0.005290951 -0.012065512 0.009877582
146 -0.0022039330 0.005220086 -0.012641457 0.009284224
149 -0.0036348908 0.005393241 -0.016367598 0.006648429
150 -0.0024047297 0.005130908 -0.013154379 0.008842366
152 -0.0036343137 0.005541653 -0.017032018 0.006749408
153 -0.0042460574 0.005560010 -0.017801309 0.005295990
155 -0.0025048291 0.005550465 -0.013913141 0.009508840
156 -0.0038649714 0.005628445 -0.017317347 0.006076050
159 -0.0024091376 0.005749131 -0.014121824 0.010452410
160 -0.0011285129 0.005512218 -0.010300054 0.012549254
162 -0.0052371073 0.007615294 -0.024432430 0.007338546
163 -0.0028546302 0.005288405 -0.014038129 0.008575273
165 -0.0039942563 0.005439021 -0.017361901 0.005446728
167 -0.0035742303 0.005331856 -0.016185788 0.006527780
169 -0.0032313422 0.005448254 -0.015957742 0.007385511
171 -0.0035642561 0.005217498 -0.015605457 0.006286555
174 -0.0038285872 0.005485346 -0.017029549 0.006198719
182 -0.0023426917 0.005148417 -0.012628165 0.009249444
187 -0.0028527453 0.005681214 -0.015022710 0.009238203
189 -0.0010959097 0.005491860 -0.010230155 0.012766546
190 -0.0038737487 0.005571374 -0.016895730 0.006516643
193 -0.0037469483 0.005373155 -0.016396695 0.005851630
194 -0.0035094092 0.005544837 -0.016272444 0.007215368
201 -0.0023188780 0.005081389 -0.012527198 0.009291226
204 -0.0043901612 0.005753174 -0.019050656 0.005257239
205 -0.0036426023 0.005387022 -0.016398992 0.006353623
208 -0.0011103389 0.005646008 -0.010605954 0.012615961
209 -0.0015661792 0.005209625 -0.011042314 0.010415549
211 -0.0041429786 0.005747871 -0.018371000 0.005669600
214 -0.0032115197 0.005381063 -0.015347309 0.007362489
219 -0.0019792737 0.005163922 -0.011917970 0.009517950
222 -0.0014295403 0.005524686 -0.011232661 0.012240749
223 -0.0051030078 0.006058856 -0.020566784 0.003924420
229 -0.0046045189 0.005822911 -0.018933284 0.004995994</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb77-2"><a href="#cb77-2"></a>esm <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/bayes2022/main/static/Lectures/esm_w1_RENAMED.csv"</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a>esm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,540 × 89
    ...1 esm.IDnum.w1 esm.PRO01.w1 esm.PRO02.w1 esm.PRO03.w1
   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1     1        10549           17            1            1
 2     2        10547           57            1            1
 3     3        10547           57            1            1
 4     4        10539           51            1            1
 5     5        10547           57            1            1
 6     6        10549           17            1            1
 7     7        10539           51            1            1
 8     8        10549           17            1            1
 9     9        10547           57            1            1
10    10        10526           36            1            1
# ℹ 11,530 more rows
# ℹ 84 more variables: esm.startDateTime.w1 &lt;chr&gt;, esm.PRO04.w1 &lt;dbl&gt;,
#   esm.PRO05.w1 &lt;dbl&gt;, esm.PRO06.w1 &lt;dbl&gt;, esm.PRO07.w1 &lt;dbl&gt;,
#   esm.endDateTime.w1 &lt;chr&gt;, esm.OR.w1 &lt;chr&gt;, esm.NQ11.w1 &lt;dbl&gt;,
#   esm.NQ12.w1 &lt;dbl&gt;, esm.EXT.w1 &lt;dbl&gt;, esm.AGR.w1 &lt;dbl&gt;, esm.CON.w1 &lt;dbl&gt;,
#   esm.NEU.w1 &lt;dbl&gt;, `esm.NQ11+1.w1` &lt;dbl&gt;, `esm.NQ12+1.w1` &lt;dbl&gt;,
#   `esm.EXT+1.w1` &lt;dbl&gt;, `esm.AGR+1.w1` &lt;dbl&gt;, `esm.CON+1.w1` &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>esm<span class="sc">$</span>PA <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.NQ11.w1</span>
<span id="cb79-2"><a href="#cb79-2"></a>esm<span class="sc">$</span>W.other <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.ST04.w1</span>
<span id="cb79-3"><a href="#cb79-3"></a>esm<span class="sc">$</span>ID <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.IDnum.w1</span>
<span id="cb79-4"><a href="#cb79-4"></a></span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="fu">library</span>(lme4)</span>
<span id="cb79-6"><a href="#cb79-6"></a>test <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">|</span> ID), <span class="at">data =</span> esm )</span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="fu">summary</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: PA ~ 1 + W.other + (1 + W.other | ID)
   Data: esm

REML criterion at convergence: 24523.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5746 -0.6263  0.0180  0.6978  2.8135 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 ID       (Intercept) 0.25954  0.5094        
          W.other     0.03266  0.1807   -0.56
 Residual             0.72255  0.8500        
Number of obs: 9461, groups:  ID, 364

Fixed effects:
            Estimate Std. Error t value
(Intercept)  3.15230    0.03538   89.09
W.other      0.31802    0.02612   12.18

Correlation of Fixed Effects:
        (Intr)
W.other -0.686</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>mlm<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb81-2"><a href="#cb81-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb81-3"><a href="#cb81-3"></a>      PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">|</span> ID),</span>
<span id="cb81-4"><a href="#cb81-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb81-5"><a href="#cb81-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb81-6"><a href="#cb81-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb81-7"><a href="#cb81-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> W.other, <span class="at">group =</span> ID), </span>
<span id="cb81-8"><a href="#cb81-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb81-9"><a href="#cb81-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">10</span>), <span class="at">class =</span> cor)),</span>
<span id="cb81-10"><a href="#cb81-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb81-11"><a href="#cb81-11"></a>      <span class="at">sample_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb81-12"><a href="#cb81-12"></a>      <span class="at">file =</span> <span class="st">"mlm.5"</span>,</span>
<span id="cb81-13"><a href="#cb81-13"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb81-14"><a href="#cb81-14"></a>      <span class="at">data =</span> esm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>747 parameters in our posterior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># get_variables(mlm.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co">#summary(mlm.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>partially_pooled_params2 <span class="ot">&lt;-</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.5</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb84-4"><a href="#cb84-4"></a></span>
<span id="cb84-5"><a href="#cb84-5"></a></span>
<span id="cb84-6"><a href="#cb84-6"></a>un_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb84-7"><a href="#cb84-7"></a>  esm <span class="sc">%&gt;%</span></span>
<span id="cb84-8"><a href="#cb84-8"></a>  <span class="fu">filter</span>((<span class="sc">!</span><span class="fu">is.na</span>(PA))) <span class="sc">%&gt;%</span> </span>
<span id="cb84-9"><a href="#cb84-9"></a>  <span class="fu">group_by</span>(ID, W.other) <span class="sc">%&gt;%</span></span>
<span id="cb84-10"><a href="#cb84-10"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PA)) <span class="sc">%&gt;%</span></span>
<span id="cb84-11"><a href="#cb84-11"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> W.other, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb84-12"><a href="#cb84-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb84-13"><a href="#cb84-13"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb84-14"><a href="#cb84-14"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb84-15"><a href="#cb84-15"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-16"><a href="#cb84-16"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-17"><a href="#cb84-17"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb84-18"><a href="#cb84-18"></a></span>
<span id="cb84-19"><a href="#cb84-19"></a>params <span class="ot">&lt;-</span></span>
<span id="cb84-20"><a href="#cb84-20"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb84-21"><a href="#cb84-21"></a>  <span class="fu">bind_rows</span>(partially_pooled_params2, un_pooled_params) <span class="sc">%&gt;%</span></span>
<span id="cb84-22"><a href="#cb84-22"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb84-23"><a href="#cb84-23"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb84-24"><a href="#cb84-24"></a></span>
<span id="cb84-25"><a href="#cb84-25"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb84-26"><a href="#cb84-26"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params, <span class="fu">aes</span>(<span class="at">x =</span> W.other, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb84-27"><a href="#cb84-27"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb84-28"><a href="#cb84-28"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb84-29"><a href="#cb84-29"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb84-30"><a href="#cb84-30"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb84-31"><a href="#cb84-31"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(params<span class="sc">$</span>W.other),</span>
<span id="cb84-32"><a href="#cb84-32"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(params<span class="sc">$</span>Intercept))</span>
<span id="cb84-33"><a href="#cb84-33"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>mlm<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>  <span class="fu">spread_draws</span>(b_W.other, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"W.other"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-4"><a href="#cb85-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_W.other <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb85-5"><a href="#cb85-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb85-7"><a href="#cb85-7"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>esm <span class="ot">&lt;-</span> esm <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="fu">mutate</span>(<span class="at">W.other.pm =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">W.other</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(W.other.pm)) <span class="sc">%&gt;%</span>   </span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="fu">mutate</span>(<span class="at">W.other.pc =</span> W.other <span class="sc">-</span> W.other.pm) <span class="sc">%&gt;%</span> </span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="fu">mutate</span>(<span class="at">W.other.gmc =</span>W.other.pm  <span class="sc">-</span> <span class="fu">mean</span> (W.other.pm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>mlm<span class="fl">.6</span> <span class="ot">&lt;-</span> </span>
<span id="cb87-2"><a href="#cb87-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb87-3"><a href="#cb87-3"></a>      PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other.pc  <span class="sc">+</span>  W.other.gmc <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other.pc  <span class="sc">|</span> ID),</span>
<span id="cb87-4"><a href="#cb87-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb87-5"><a href="#cb87-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb87-6"><a href="#cb87-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb87-7"><a href="#cb87-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> W.other.pc, <span class="at">group =</span> ID), </span>
<span id="cb87-8"><a href="#cb87-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb87-9"><a href="#cb87-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">10</span>), <span class="at">class =</span> cor)),</span>
<span id="cb87-10"><a href="#cb87-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb87-11"><a href="#cb87-11"></a>      <span class="at">file =</span> <span class="st">"mlm.6"</span>,</span>
<span id="cb87-12"><a href="#cb87-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb87-13"><a href="#cb87-13"></a>      <span class="at">data =</span> esm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">summary</span>(mlm<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: PA ~ 1 + W.other.pc + W.other.gmc + (1 + W.other.pc | ID) 
   Data: esm (Number of observations: 8321) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 326) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.45      0.02     0.41     0.50 1.00     1758
sd(W.other.pc)                0.20      0.04     0.12     0.28 1.00     3702
cor(Intercept,W.other.pc)    -0.25      0.13    -0.51     0.00 1.00     9630
                          Tail_ESS
sd(Intercept)                 4293
sd(W.other.pc)                5292
cor(Intercept,W.other.pc)     8296

Population-Level Effects: 
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept       3.40      0.03     3.34     3.45 1.00     1698     3188
W.other.pc      0.33      0.03     0.28     0.39 1.00    10487     9038
W.other.gmc     0.86      0.18     0.51     1.22 1.00     1963     3738

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.86      0.01     0.84     0.87 1.00    14321     9005

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>partially_pooled_params3 <span class="ot">&lt;-</span></span>
<span id="cb90-2"><a href="#cb90-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.6</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb90-4"><a href="#cb90-4"></a></span>
<span id="cb90-5"><a href="#cb90-5"></a></span>
<span id="cb90-6"><a href="#cb90-6"></a>un_pooled_params2 <span class="ot">&lt;-</span></span>
<span id="cb90-7"><a href="#cb90-7"></a>  esm <span class="sc">%&gt;%</span></span>
<span id="cb90-8"><a href="#cb90-8"></a>  <span class="fu">filter</span>((<span class="sc">!</span><span class="fu">is.na</span>(PA))) <span class="sc">%&gt;%</span> </span>
<span id="cb90-9"><a href="#cb90-9"></a>  <span class="fu">group_by</span>(ID, W.other.pc) <span class="sc">%&gt;%</span></span>
<span id="cb90-10"><a href="#cb90-10"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PA)) <span class="sc">%&gt;%</span></span>
<span id="cb90-11"><a href="#cb90-11"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> W.other.pc, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb90-12"><a href="#cb90-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb90-13"><a href="#cb90-13"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb90-14"><a href="#cb90-14"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb90-15"><a href="#cb90-15"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-16"><a href="#cb90-16"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-17"><a href="#cb90-17"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb90-18"><a href="#cb90-18"></a></span>
<span id="cb90-19"><a href="#cb90-19"></a>params2 <span class="ot">&lt;-</span></span>
<span id="cb90-20"><a href="#cb90-20"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb90-21"><a href="#cb90-21"></a>  <span class="fu">bind_rows</span>(partially_pooled_params3, un_pooled_params2) <span class="sc">%&gt;%</span></span>
<span id="cb90-22"><a href="#cb90-22"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb90-23"><a href="#cb90-23"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb90-24"><a href="#cb90-24"></a></span>
<span id="cb90-25"><a href="#cb90-25"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb90-26"><a href="#cb90-26"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params2, <span class="fu">aes</span>(<span class="at">x =</span> W.other.pc, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb90-27"><a href="#cb90-27"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb90-28"><a href="#cb90-28"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb90-29"><a href="#cb90-29"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb90-30"><a href="#cb90-30"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb90-31"><a href="#cb90-31"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(params<span class="sc">$</span>W.other.pc),</span>
<span id="cb90-32"><a href="#cb90-32"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(params<span class="sc">$</span>Intercept))</span>
<span id="cb90-33"><a href="#cb90-33"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-73-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>mlm<span class="fl">.6</span> <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>  <span class="fu">spread_draws</span>(b_W.other.pc, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"W.other.pc"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-4"><a href="#cb91-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_W.other.pc <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb91-5"><a href="#cb91-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb91-7"><a href="#cb91-7"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-74-1.png" width="960" class="r-stretch"></section>
<section id="making-predictions" class="slide level2">
<h2>Making predictions</h2>
<p>We often want to make predictions for different groups or individuals. The previous slide is one example. We made these predictions using/borrowing information from other individuals, through partial pooling. This improves our predictions.</p>
<p>Can we improve it further? Think about predictions in presidential races, or think about if we want to make some decision for a cancer drug. Do we stick with these standard MLM based predictions?</p>
</section>
<section id="mr.-p" class="slide level2">
<h2>Mr.&nbsp;P</h2>
<p>Improving predictions by incorporating outside (of the model) information. MRP = multilevel regression with poststratification</p>
<p>One of the biggest problems with psych data is that it is unrepresentative. (Do you trust undergrads or adults off the street wanting to help science?) Often survey weights are used. But if we know the distribution of the broader population, we can reweight (post-stratify) our results to get more accurate estimates. Instead of making assumptions about how the observed sample was produced from the population, we make assumptions about how the observed sample can be used to reconstruct the rest of the population</p>
</section>
<section id="weighting-vs-postratifying" class="slide level2">
<h2>Weighting vs postratifying</h2>
<p>Weighting is done all the time with data. It gives more or less “weight” to observations that are over or under sampled. Some people “count” more than others in the service of getting data that represents some population.</p>
<p>Poststratification is similar in that it weights the posterior samples rather than the observations.</p>
<p>Why is this preferred? A few reasons, but mainly one can make generalization to new groups or groups with little data. Rather than weighting those specific individuals, partial pooling from other information will help with learning</p>
</section>
<section class="slide level2">

<p>What do we need? A reliable data source (such as a census) that gives us the population weights. Data can be re-weighted based on many different categories, not just one: for example, we could post-stratify based on age, education, state of residence, etc.</p>
</section>
<section class="slide level2">

<p>Estimating the proportion of heterosexual women who kept their maiden name after marriage.</p>
<p>https://www.monicaalexander.com/posts/2019-08-07-mrp/ https://bookdown.org/content/4857/models-with-memory.html#summary-bonus-post-stratification-in-an-example</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>mrp <span class="ot">&lt;-</span><span class="fu">load</span>(<span class="st">"mrp.rds"</span>)</span>
<span id="cb92-2"><a href="#cb92-2"></a>mrp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d"           "cell_counts"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,413 × 5
   kept_name state_name     age_group decade_married educ_group
       &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;     
 1         0 ohio           50        1979           &gt;BA       
 2         0 virginia       35        1999           &gt;BA       
 3         1 new york       35        2009           &gt;BA       
 4         0 rhode island   55        1999           &gt;BA       
 5         0 illinois       35        2009           &gt;BA       
 6         0 north carolina 25        2009           &gt;BA       
 7         1 iowa           35        1999           &gt;BA       
 8         1 texas          35        2009           &gt;BA       
 9         0 south dakota   35        1999           &gt;BA       
10         0 texas          35        2009           &gt;BA       
# ℹ 4,403 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>cell_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,058 × 5
   state_name age_group decade_married educ_group     n
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;
 1 alabama    25        1999           &lt;BA        19012
 2 alabama    25        2009           &lt;BA        37488
 3 alabama    25        1999           &gt;BA          959
 4 alabama    25        2009           &gt;BA         5319
 5 alabama    25        1999           BA          2986
 6 alabama    25        2009           BA         14261
 7 alaska     25        1999           &lt;BA         3320
 8 alaska     25        2009           &lt;BA         7001
 9 alaska     25        1999           &gt;BA          159
10 alaska     25        2009           &gt;BA          435
# ℹ 6,048 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>mlm.mrp <span class="ot">&lt;-</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> binomial,</span>
<span id="cb98-3"><a href="#cb98-3"></a>      kept_name <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> age_group) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> decade_married) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> educ_group) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_name),</span>
<span id="cb98-4"><a href="#cb98-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb98-5"><a href="#cb98-5"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd)),</span>
<span id="cb98-6"><a href="#cb98-6"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb98-7"><a href="#cb98-7"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">98</span>),</span>
<span id="cb98-8"><a href="#cb98-8"></a>      <span class="at">data =</span> d,</span>
<span id="cb98-9"><a href="#cb98-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb98-10"><a href="#cb98-10"></a>      <span class="at">file =</span> <span class="st">"mlm.mrp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="fu">summary</span>(mlm.mrp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: kept_name | trials(1) ~ 1 + (1 | age_group) + (1 | decade_married) + (1 | educ_group) + (1 | state_name) 
   Data: d (Number of observations: 4373) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~age_group (Number of levels: 11) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     1.15      0.29     0.72     1.88 1.00     1470     2235

~decade_married (Number of levels: 5) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     1.00      0.39     0.49     2.03 1.00     2246     2946

~educ_group (Number of levels: 4) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.92      0.49     0.35     2.17 1.00     2553     2773

~state_name (Number of levels: 52) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.25      0.06     0.15     0.38 1.00     1407     2328

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    -0.72      0.63    -1.99     0.50 1.00     1966     2475

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="fu">posterior_samples</span>(mlm.mrp) <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"sd_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3"></a>  <span class="fu">set_names</span>(<span class="fu">str_c</span>(<span class="st">"sigma["</span>, <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"decade~married"</span>, <span class="st">"education"</span>, <span class="st">"state"</span>), <span class="st">"]"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-4"><a href="#cb101-4"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb101-5"><a href="#cb101-5"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb101-6"><a href="#cb101-6"></a>  <span class="fu">median_qi</span>(<span class="at">.width =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">70</span>, <span class="at">to =</span> .<span class="dv">95</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb101-7"><a href="#cb101-7"></a>  </span>
<span id="cb101-8"><a href="#cb101-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> <span class="fu">reorder</span>(name, value))) <span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .width), <span class="at">color =</span> <span class="st">"orange3"</span>) <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe) <span class="sc">+</span></span>
<span id="cb101-11"><a href="#cb101-11"></a>  <span class="fu">scale_alpha_continuous</span>(<span class="st">"CI width"</span>, <span class="at">range =</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb101-12"><a href="#cb101-12"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb101-13"><a href="#cb101-13"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb101-14"><a href="#cb101-14"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-80-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Census data we will use to make predictions. We will make predictions for every combination of variable we are interested in (state, age, decade married, edu)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>age_prop <span class="ot">&lt;-</span> </span>
<span id="cb102-2"><a href="#cb102-2"></a>  cell_counts <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="#cb102-3"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="#cb102-4"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb102-5"><a href="#cb102-5"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb102-6"><a href="#cb102-6"></a></span>
<span id="cb102-7"><a href="#cb102-7"></a>age_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,058 × 6
   state_name age_group decade_married educ_group     n      prop
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 alabama    25        1999           &lt;BA        19012 0.00414  
 2 alabama    25        2009           &lt;BA        37488 0.00816  
 3 alabama    25        1999           &gt;BA          959 0.000209 
 4 alabama    25        2009           &gt;BA         5319 0.00116  
 5 alabama    25        1999           BA          2986 0.000650 
 6 alabama    25        2009           BA         14261 0.00310  
 7 alaska     25        1999           &lt;BA         3320 0.000723 
 8 alaska     25        2009           &lt;BA         7001 0.00152  
 9 alaska     25        1999           &gt;BA          159 0.0000346
10 alaska     25        2009           &gt;BA          435 0.0000947
# ℹ 6,048 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>p <span class="ot">&lt;-</span> mlm.mrp <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="#cb104-2"></a>  <span class="fu">add_predicted_draws</span>(<span class="at">newdata =</span> age_prop <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="#cb104-3"></a>                        <span class="fu">filter</span>(age_group <span class="sc">&gt;</span> <span class="dv">20</span>, </span>
<span id="cb104-4"><a href="#cb104-4"></a>                               age_group <span class="sc">&lt;</span> <span class="dv">80</span>, </span>
<span id="cb104-5"><a href="#cb104-5"></a>                               decade_married <span class="sc">&gt;</span> <span class="dv">1969</span>),</span>
<span id="cb104-6"><a href="#cb104-6"></a>                      <span class="at">allow_new_levels =</span> T)</span>
<span id="cb104-7"><a href="#cb104-7"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24,232,000 × 11
# Groups:   state_name, age_group, decade_married, educ_group, n, prop, .row
#   [6,058]
   state_name age_group decade_married educ_group     n    prop  .row .chain
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;
 1 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 2 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 3 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 4 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 5 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 6 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 7 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 8 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 9 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
10 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
# ℹ 24,231,990 more rows
# ℹ 3 more variables: .iteration &lt;int&gt;, .draw &lt;int&gt;, .prediction &lt;int&gt;</code></pre>
</div>
</div>
<p>6,058 census categories * 4,000 samples = 24,232,000</p>
</section>
<section class="slide level2">

<p>If we group the results by age_group and .draw, we can sum the product of the posterior predictions and the weights (prop), which will leave us with 4,000 stratified posterior draws for each of the 11 levels of age_group</p>
<p><span class="math display">\[\frac{\sum_i N_i p_i}{\sum_i N_i}\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>pp <span class="ot">&lt;-</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>  p <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="#cb106-3"></a>  <span class="fu">group_by</span>(age_group, .draw) <span class="sc">%&gt;%</span> </span>
<span id="cb106-4"><a href="#cb106-4"></a>  <span class="fu">summarise</span>(<span class="at">kept_name_predict =</span> <span class="fu">sum</span>(.prediction <span class="sc">*</span> prop)) <span class="sc">%&gt;%</span> </span>
<span id="cb106-5"><a href="#cb106-5"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb106-6"><a href="#cb106-6"></a>  <span class="fu">mean_qi</span>(kept_name_predict)</span>
<span id="cb106-7"><a href="#cb106-7"></a></span>
<span id="cb106-8"><a href="#cb106-8"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 7
   age_group kept_name_predict .lower .upper .width .point .interval
   &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1 25                    0.175 0.0919  0.276   0.95 mean   qi       
 2 30                    0.181 0.115   0.263   0.95 mean   qi       
 3 35                    0.218 0.149   0.298   0.95 mean   qi       
 4 40                    0.246 0.175   0.334   0.95 mean   qi       
 5 45                    0.279 0.201   0.363   0.95 mean   qi       
 6 50                    0.301 0.219   0.394   0.95 mean   qi       
 7 55                    0.323 0.231   0.429   0.95 mean   qi       
 8 60                    0.438 0.328   0.558   0.95 mean   qi       
 9 65                    0.562 0.419   0.706   0.95 mean   qi       
10 70                    0.514 0.300   0.749   0.95 mean   qi       
11 75                    0.226 0.0442  0.521   0.95 mean   qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"raw data"</span>, <span class="st">"multilevel"</span>, <span class="st">"MRP"</span>)</span>
<span id="cb108-2"><a href="#cb108-2"></a></span>
<span id="cb108-3"><a href="#cb108-3"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb108-4"><a href="#cb108-4"></a>  <span class="co"># compute the proportions from the data</span></span>
<span id="cb108-5"><a href="#cb108-5"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb108-6"><a href="#cb108-6"></a>  <span class="fu">group_by</span>(age_group, kept_name) <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="#cb108-7"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb108-8"><a href="#cb108-8"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb108-9"><a href="#cb108-9"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb108-10"><a href="#cb108-10"></a>         <span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"raw data"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-11"><a href="#cb108-11"></a>  <span class="fu">filter</span>(kept_name <span class="sc">==</span> <span class="dv">1</span>, age_group <span class="sc">&lt;</span> <span class="dv">80</span>, age_group <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-12"><a href="#cb108-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb108-13"><a href="#cb108-13"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb108-14"><a href="#cb108-14"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb108-15"><a href="#cb108-15"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb108-16"><a href="#cb108-16"></a></span>
<span id="cb108-17"><a href="#cb108-17"></a></span>
<span id="cb108-18"><a href="#cb108-18"></a>nd <span class="ot">&lt;-</span> <span class="fu">distinct</span>(d, age_group) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(age_group)</span>
<span id="cb108-19"><a href="#cb108-19"></a></span>
<span id="cb108-20"><a href="#cb108-20"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb108-21"><a href="#cb108-21"></a>  <span class="fu">fitted</span>(mlm.mrp,</span>
<span id="cb108-22"><a href="#cb108-22"></a>         <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> age_group),</span>
<span id="cb108-23"><a href="#cb108-23"></a>         <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb108-24"><a href="#cb108-24"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb108-25"><a href="#cb108-25"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb108-26"><a href="#cb108-26"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> Estimate,</span>
<span id="cb108-27"><a href="#cb108-27"></a>         <span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"multilevel"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-28"><a href="#cb108-28"></a>  </span>
<span id="cb108-29"><a href="#cb108-29"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb108-30"><a href="#cb108-30"></a>  <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"blue2"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">fatten =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb108-31"><a href="#cb108-31"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb108-32"><a href="#cb108-32"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb108-33"><a href="#cb108-33"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb108-34"><a href="#cb108-34"></a></span>
<span id="cb108-35"><a href="#cb108-35"></a></span>
<span id="cb108-36"><a href="#cb108-36"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb108-37"><a href="#cb108-37"></a>  pp <span class="sc">%&gt;%</span></span>
<span id="cb108-38"><a href="#cb108-38"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"MRP"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-39"><a href="#cb108-39"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> kept_name_predict, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb108-40"><a href="#cb108-40"></a>  <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"orange2"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">fatten =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb108-41"><a href="#cb108-41"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb108-42"><a href="#cb108-42"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb108-43"><a href="#cb108-43"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb108-44"><a href="#cb108-44"></a></span>
<span id="cb108-45"><a href="#cb108-45"></a><span class="co"># combine!</span></span>
<span id="cb108-46"><a href="#cb108-46"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">+</span></span>
<span id="cb108-47"><a href="#cb108-47"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Proportion of women keeping name after marriage, by age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-84-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>The general idea is that we can create predictions based on what we want to do with the predictions. Previously when we wanted to plot prediction lines we made predictions across the levels of X. When we want to see observational level variability we incorporate sigma in the predictions rather than focus on expected predictions. If we wanted the CI around a specific value rather than a band then we calculate predictions around that X value. All involve feeding in data.</p>
<p>Here we are doing the same thing, feeding in values to predict but choosing them to be “weighted” however we want.</p>
</section>
<section id="mr.p-not-limited-to-surveys" class="slide level2">
<h2>Mr.P Not limited to surveys</h2>
<p>Example (using brms) with experimental data – can you generalize from your sample of undergraduates to other undergraduates at your university, let alone undergraduates in general, let alone young adults, to say nothing about the population of humans. https://arxiv.org/pdf/1906.11323.pdf</p>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>