<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>Bayesian Statistics 2023 - mlm</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">mlm</h1>

<div class="quarto-title-authors">
</div>

</section>
<section class="slide level2">


<img data-src="chelsea.jpeg" class="r-stretch"></section>
<section id="mlm-review" class="slide level2">
<h2>MLM review</h2>
<p><span class="math display">\[{Y}_{i} = b_{0} + b_{1}X_{i} +  ... +\epsilon_{i}\]</span></p>
<p><span class="math display">\[{Y}_{ij} = b_{0} + b_{1}X_{ij} + ... +\epsilon_{ij}\]</span> Where j refers to some clustering or grouping variable and i refers to the observations within j</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>data <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/josh-jackson/bayes/master/mlm.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>mlm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>mlm <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">sample_n_of</span>(<span class="dv">20</span>, ID) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> CON, <span class="at">group =</span> ID, <span class="at">fill =</span> ID)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID)),<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="empty-model" class="slide level2">
<h2>Empty model</h2>
<p>Level 1 <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \varepsilon_{ij}\]</span></p>
<p>Level 2 <span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span></p>
<p><span class="math display">\[{U}_{0j} \sim\mathcal{N}(0, \tau_{00}^{2})\]</span> <span class="math display">\[{e}_{ij} \sim\mathcal{N}(0, \sigma^{2})\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mlm <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">sample_n_of</span>(<span class="dv">8</span>, ID) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> CON, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID)), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span><span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"><p><span class="math display">\[{Y}_{ij} = \gamma_{00} + U_{0j}  + \varepsilon_{ij}\]</span></p>
<p>Akin to ANOVA if we treat <span class="math inline">\(U_{0j}\)</span> as between subjects variance &amp; <span class="math inline">\(\varepsilon_{ij}\)</span> as within subjects variance.</p>
</section>
<section id="random-and-fixed-effects" class="slide level2">
<h2>Random and fixed effects</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span> Combined: <span class="math display">\[{Y}_{ij} = \gamma_{00} + U_{0j}  + \varepsilon_{ij}\]</span></p>
</div><div class="column" style="width:60%;">
<p><span class="math inline">\(U_{0j}\)</span> is considered a random effect, as it is varies across our grouping</p>
<p><span class="math inline">\(\gamma_{00}\)</span> is considered a fixed effect, as it is what is fixed (average) across our grouping</p>
</div>
</div>
</section>
<section id="level-1-predictors" class="slide level2">
<h2>Level 1 predictors</h2>
<p>Level 1 is where you have data that repeats within your grouping or clustering data. Is your cluster classrooms? Then students are level 1. Is your cluster people? Then observations are level 1.</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Notice on the subscript of X that these predictors vary across group (j) and within the group (i) So if your grouping (j) is people, then i refers to different observations.</p>
</section>
<section class="slide level2">

<p>Level 2 takes the parameters at level 1 and decomposes them into a fixed component ( <span class="math inline">\(\gamma\)</span> ) that reflects the average and, if desired, the individual deviations around that fixed effect (U).</p>
<p>level 1 <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10}\]</span></p>
</section>
<section class="slide level2">

<p>Level 1:</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2:<br>
<span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} + U_{1j}\]</span></p>
<p>Combined <span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{10}(X_{ij})+ U_{0j} + U_{1j}(X_{ij}) + \varepsilon_{ij}\]</span></p>
<p>Can think of a persons score divided up into a fixed component as well as the random component.</p>
<p><span class="math display">\[{\beta}_{16} = \gamma_{10} \pm U_{16}\]</span></p>
</section>
<section id="error-structure" class="slide level2">
<h2>Error structure</h2>
<p>The residual structure, where the random effects are again normally distributed with a mean of zero, but this time one must also consider covariance in addition to variance.</p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim \mathcal{N} \begin{pmatrix}
  0,      \tau_{00}^{2} &amp; \tau_{01}\\
  0,  \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
<p>Note that it is possible to have a different error structure for the random effects</p>
<p><span class="math display">\[{e}_{ij} \sim \mathcal{N}(0, \sigma^{2})\]</span></p>
</section>
<section id="multiple-level-1-predictors" class="slide level2">
<h2>Multiple level 1 predictors</h2>
<p>Level 1:</p>
<p><span class="math display">\[{Y}_{ijk} = \beta_{0j}  + \beta_{1j}X_{ij} + \beta_{2j}Z_{ik} + \varepsilon_{ijk}\]</span> Level 2:<br>
<span class="math display">\[{\beta}_{0j} = \gamma_{00} + U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} + U_{1j}\]</span> <span class="math display">\[{\beta}_{2k} = \gamma_{20} + U_{2k}\]</span></p>
</section>
<section id="level-2-predictors" class="slide level2">
<h2>Level 2 predictors</h2>
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \gamma_{01}G_{j} +   U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10} + U_{1j}\]</span></p>
<p>Combined <span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{01}G_{j}+  \gamma_{10} (X_{ij}) + U_{0j} + U_{1j}(X_{ij}) + \varepsilon_{ij}\]</span> <span class="math display">\[{Y}_{ij} = [\gamma_{00} + \gamma_{01}G_{j}+ U_{0j}]  + [(\gamma_{10}  + U_{1j})(X_{ij})] + \varepsilon_{ij}\]</span></p>
</section>
<section id="cross-level-interactions" class="slide level2">
<h2>Cross level interactions</h2>
<p>level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \gamma_{01}G_{j} +   U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10} + \gamma_{11}G_{j} + U_{1j}\]</span><br>
<span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{01}G_{j}+  \gamma_{10} (X_{ij}) + \gamma_{11}(G_{j}*X{ij}) +  U_{0j} + U_{1j}(X{ij}) + \varepsilon_{ij}\]</span></p>
<p><span class="math display">\[{Y}_{ij} = [\gamma_{00} + U_{0j} +\gamma_{01}G_{j}] + [(\gamma_{10}  + \gamma_{11}G_{j}+  U_{1j})(X{ij})] + \varepsilon_{ij}\]</span></p>
</section>
<section id="centering" class="slide level2">
<h2>Centering</h2>
<p>As a rule, each level-1 predictor is usually really 2 predictor variables. It is important to separate within-group from between group variance. Failing to do so will “smush” between and within variance to level 1.</p>
<p>Example: student SES at level 1, with schools at level 2. Some kids have more money than other kids in their school Some schools have more money than other schools</p>
<p>Fortunately it is easy to separate this</p>
</section>
<section class="slide level2">

<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}(X_{ij}- \bar{X_j}) + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \bar{X_j} +   U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} + \bar{X_j} + U_{1j}\]</span></p>
</section>
<section id="mlm-as-default-and-make-it-maximum" class="slide level2">
<h2>MLM as default and make it maximum</h2>
<p>If you have data like this you should analyze like this! If you don’t, then you are losing information (GEE being a potential exception).</p>
<p>The question often is about which random effects to fit. There are multiple opinions, but mine is to start maximum, and then work downward (ie simplify) if necessary/consistent with theory. It doesn’t really hurt to include them, especially within Bayesian estimation!</p>
</section>
<section id="mlm-intuitions" class="slide level2">
<h2>MLM intuitions</h2>
<p>Anytime you have repeated DVs you should use MLM as opposed to doing aggregation outside the model. While that should be your default, it is helpful to conceptualize why it is helpful.</p>
<ol type="1">
<li>Aggregation is bad</li>
<li>Regressions within regressions (ie coefficients as outcomes)</li>
<li>Questions at different levels</li>
<li>Variance decomposition<br>
</li>
<li>Learning from other data through pooling/shrinkage</li>
<li>Parameters that depend on parameters</li>
</ol>
</section>
<section id="handling-multiple-dvs" class="slide level2">
<h2>Handling multiple DVs?</h2>
<p>What if people had more than 1 DV, like we do with time? What do you do with multiple items, multiple trials, multiple ____ ?</p>
<p>Two options: 1. Collapse and average across.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">library</span>(broom)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>simp<span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="sc">~</span>ID, <span class="sc">~</span>group,  <span class="sc">~</span>test.score, <span class="sc">~</span>study,</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">3</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>,</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Could aggragate across group</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="aggregation-obscures-hypotheses" class="slide level2">
<h2>1. Aggregation obscures hypotheses</h2>
<ul>
<li><p>Between person H1: Do students who study more get better grades?</p></li>
<li><p>Within person H2: When a student studies, do they get better grades?</p></li>
<li><p>H1 and H2 are independent from one another! Aggregation collapses the two. When you have nested data with many DVs it is important to not aggregate.</p></li>
<li><p>#compositeskill</p></li>
</ul>
</section>
<section id="regressions-within-regressions" class="slide level2">
<h2>2. Regressions within regressions</h2>
<p>Helps to take multilevel and split it into the different levels.</p>
<p>Level 1 is the smallest unit of analysis (students, waves, trials, family members)</p>
<p>Level 2 variables are what level 1 variables are “nested” in (people, schools, counties, families, dyads)</p>
<p>We are going to use level one components to run a regression, all the while level 1 is also estimating a regression. (Coefficents as outcomes)</p>
</section>
<section id="stroop-example" class="slide level2">
<h2>Stroop example</h2>
<p>We calculate stroop scores by looking at repeated trials of congruent vs not congruent. This is dummy coded such that the <span class="math inline">\(\beta_{1}\)</span> reflects the average stroop effect. How much slower are people in incongruent trials?</p>
<p><span class="math display">\[Y_{i} = \beta_{0} + \beta_{1}X_{1} + \varepsilon_i\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial,i}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Age_i+ U_{1i}\]</span></p>
<p>Our B1 coefficient indexes the stroop effect. However, people differ on this stroop effect. There is some average effect (fixed effect) that people vary around. Each person has some personal <span class="math inline">\(\beta_1\)</span>, which we find using Level 1 data. From there we can also ask questions (with regressions) about that random variable.</p>
</section>
<section class="slide level2">

<p>People differ on the stroop</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>example <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2021/master/example.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>example<span class="sc">$</span>year <span class="ot">&lt;-</span> example<span class="sc">$</span>week</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>ex.random <span class="ot">&lt;-</span> example <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  distinct <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">sample_n</span>(<span class="dv">3</span>) </span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>example2 <span class="ot">&lt;-</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="fu">left_join</span>(ex.random, example)  </span>
<span id="cb5-12"><a href="#cb5-12"></a>  </span>
<span id="cb5-13"><a href="#cb5-13"></a>g2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(example2,</span>
<span id="cb5-14"><a href="#cb5-14"></a>   <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span><span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span>ID) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">13</span>) <span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">"stroop effect"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"trials"</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="fu">geom_label</span>(<span class="at">label=</span><span class="st">"Grand mean "</span>,  <span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>.<span class="dv">13</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="at">label.size =</span> <span class="fl">0.15</span>) </span>
<span id="cb5-18"><a href="#cb5-18"></a>g2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb6-2"><a href="#cb6-2"></a>example <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">do</span>(<span class="at">avg =</span> <span class="fu">tidy</span>(<span class="fu">lm</span>(SMN7 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">unnest</span>(avg) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">stat_dotsinterval</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="diferent-levels" class="slide level2">
<h2>3. Diferent levels</h2>
<p>To sum up the first two ways to think about regression, we take a relationship that could be simplified by aggregation, and conduct regressions from regressions. (Regression inception)</p>
<p>The third way is to think of questions at different levels. At level 1 we can ask lower-unit questions e.g., if trials are nested within person, what predicts lengthier trials?</p>
<p>If level 1 is made up of repeated observations, then we can ask level 1/observation level questions like does failure at the trial level impact future trial performance.</p>
</section>
<section class="slide level2">

<p>At level 2 we can ask broader-unit questions. E.g., is age associated with stroop differences</p>
<p>Often level 2 is between person variables.</p>
<p>Both levels are simple regressions. Level 2 uses coefficients from level 1 as DVs. Level 1 variables are time varying, level 2 variables are time invariant</p>
</section>
<section id="variance-decomposition" class="slide level2">
<h2>4. Variance decomposition</h2>
<p>For standard regression, we think of error as existing in one big bucket called <span class="math inline">\(\varepsilon\)</span> . Everything that we do not know goes into that bucket, from measurement error to unmeasured important factors.</p>
<p>For MLMs we will be breaking up ( <span class="math inline">\(\varepsilon\)</span> ) into multiple buckets. These useful “buckets” (Us) are what we refer to as random/varying effects.</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial}\]</span> <span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Z_i+ U_{1i}\]</span></p>
</section>
<section class="slide level2">


<img data-src="btw.png" class="r-stretch"><p>Assume a simple intercept only model where we aggregate across types of trials.</p>
</section>
<section class="slide level2">


<img data-src="win.png" class="r-stretch"><p>A MLM intercept only model takes what was previously chalked up to error and reassigns it into person specific “buckets”</p>
</section>
<section class="slide level2">

<p>Model for the means (like normal) and now we have a model for the variance (random effects!)</p>
<p>We will treat random effects as variables themselves e.g.&nbsp;individual differences in reaction time or stroop effect. They index how much people DIFFER on some effect. e.g.&nbsp;does everyone show the same stroop effect?</p>
<p>We can relate the random effects to other random effects e.g., do people who show an effect have a slower reaction time?</p>
</section>
<section id="shrinkagepartial-pooling" class="slide level2">
<h2>5. Shrinkage/partial pooling</h2>
<ul>
<li><p>We treat our group variable as coming from a population. All groups are alike (because they are from the same population), but different in their own way. Because of this it is helpful to use information from other groups to help make predictions.</p></li>
<li><p>We do this in standard regression where we make predictions based on values from the whole dataset (not just binned Xs). A similar analogy for MLM is running a regression for each group. We want to pool as this leads to better predictions as we are not overfitting our data!</p></li>
</ul>
</section>
<section class="slide level2">

<p>If we take our simplified stroop effect model (an empty model)</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} +  \varepsilon_{trial}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span></p>
<p>Where does <span class="math inline">\(U_{0i}\)</span> come from? If we calculated each by hand, through taking the average reaction time for a person i and subtracting that from the grand mean reaction time, would that equal <span class="math inline">\(U_{0i}\)</span> ?</p>
</section>
<section id="complete-partial-and-no-pooling" class="slide level2">
<h2>Complete, partial and no pooling</h2>
<ul>
<li><p>Complete assumes everyone is the same, with <span class="math inline">\(U_{0i}\)</span> being zero for everyone.</p></li>
<li><p>No pooling is if we calculate every person’s effect with a regression, subtracting out he grand mean average.</p></li>
<li><p>Partial pooling is in the middle, a weighted average between the two. For those with fewer trials there is less information for a particular individual, thus the complete pooling estimate will be given more weight. If someone has a lot of data, there weighted average is closer to no pooling.</p></li>
<li><p>Partial pooling prevents both over and under fitting of your data, leading to increased out of sample predictions.</p></li>
</ul>
</section>
<section id="complete-pooling" class="slide level2">
<h2>Complete pooling</h2>
<p>Ignores any dependency. Doesn’t learn from others, assumes everyone is the same. Underfits the model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-2"><a href="#cb7-2"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="no-pooling" class="slide level2">
<h2>No Pooling</h2>
<p>Everyone is unqiue and we cannot learn from others. Leads to overfitting</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> ID) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="partial-pooling-aka-shrinkage-aka-regularization" class="slide level2">
<h2>Partial pooling aka shrinkage aka regularization</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID, <span class="at">colour =</span> ID)) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span><span class="fu">scale_color_viridis</span>()<span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study amount"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Partial pooling aka shrinkage provides the optimal amount of learning from others. Assumes people come from the same distribution but are distinct from one another.</p>
<p>If you have a little data, then the safe bet is to look at the average. If you have a lot of data, you can ignore others.</p>
<p>In a way, this is similar to Bayesian reasoning where learning is based on how much information you have about a person with other people serving as a prior.</p>
</section>
<section id="parameters-that-depend-on-other-parameters" class="slide level2">
<h2>6. Parameters that depend on other parameters</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma)\]</span> <span class="math display">\[\mu_i  = \beta_{0[j]}\]</span></p>
<p><span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="hyperprior" class="slide level2">
<h2>Hyperprior</h2>
<p>We now have a prior for the population of effects. We typically put a prior directly on parameters. Here, because are using a multilevel model, we are interested in the population of intercepts, not just a single intercept.</p>
<p>Intercept in simple regression –&gt; a (prior/posterior) distribution of possible scores</p>
<p>Intercept in mlm –&gt; a distribution of group/clusters of intercepts. The population we are sampling from can have a distribution (mu, sigma), and that distribution is different from the observed distribution of mu (or sigma)</p>
</section>
<section id="parameters-that-depend-on-parameters" class="slide level2">
<h2>Parameters that depend on parameters</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># normal density</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">library</span>(beyonce)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a>bp <span class="ot">&lt;-</span> <span class="fu">beyonce_palette</span>(<span class="dv">128</span>, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-13"><a href="#cb10-13"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-14"><a href="#cb10-14"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-15"><a href="#cb10-15"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-17"><a href="#cb10-17"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-18"><a href="#cb10-18"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"italic(M)[0]"</span>, <span class="st">"italic(S)[0]"</span>), </span>
<span id="cb10-19"><a href="#cb10-19"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-23"><a href="#cb10-23"></a></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># half-normal density</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-27"><a href="#cb10-27"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-30"><a href="#cb10-30"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-31"><a href="#cb10-31"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb10-32"><a href="#cb10-32"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-33"><a href="#cb10-33"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-34"><a href="#cb10-34"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-35"><a href="#cb10-35"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma][0]"</span>, </span>
<span id="cb10-36"><a href="#cb10-36"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-37"><a href="#cb10-37"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-40"><a href="#cb10-40"></a></span>
<span id="cb10-41"><a href="#cb10-41"></a>my_arrow <span class="ot">&lt;-</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)</span>
<span id="cb10-42"><a href="#cb10-42"></a></span>
<span id="cb10-43"><a href="#cb10-43"></a></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co"># a second normal density</span></span>
<span id="cb10-45"><a href="#cb10-45"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb10-46"><a href="#cb10-46"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-47"><a href="#cb10-47"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-49"><a href="#cb10-49"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-50"><a href="#cb10-50"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-51"><a href="#cb10-51"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-52"><a href="#cb10-52"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-53"><a href="#cb10-53"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-54"><a href="#cb10-54"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-55"><a href="#cb10-55"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"italic(M)[1]"</span>, <span class="st">"italic(S)[1]"</span>), </span>
<span id="cb10-56"><a href="#cb10-56"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-57"><a href="#cb10-57"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-58"><a href="#cb10-58"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-59"><a href="#cb10-59"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-60"><a href="#cb10-60"></a></span>
<span id="cb10-61"><a href="#cb10-61"></a><span class="co"># a second half-normal density</span></span>
<span id="cb10-62"><a href="#cb10-62"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb10-63"><a href="#cb10-63"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-64"><a href="#cb10-64"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-65"><a href="#cb10-65"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-66"><a href="#cb10-66"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-67"><a href="#cb10-67"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-68"><a href="#cb10-68"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb10-69"><a href="#cb10-69"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-70"><a href="#cb10-70"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-71"><a href="#cb10-71"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-72"><a href="#cb10-72"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma][1]"</span>, </span>
<span id="cb10-73"><a href="#cb10-73"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-74"><a href="#cb10-74"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-75"><a href="#cb10-75"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-76"><a href="#cb10-76"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-77"><a href="#cb10-77"></a></span>
<span id="cb10-78"><a href="#cb10-78"></a><span class="co"># four annotated arrows</span></span>
<span id="cb10-79"><a href="#cb10-79"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb10-80"><a href="#cb10-80"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">35</span>, .<span class="dv">65</span>, .<span class="dv">95</span>),</span>
<span id="cb10-81"><a href="#cb10-81"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-82"><a href="#cb10-82"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">32</span>, .<span class="dv">4</span>, .<span class="dv">65</span>, .<span class="dv">72</span>),</span>
<span id="cb10-83"><a href="#cb10-83"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-84"><a href="#cb10-84"></a>  </span>
<span id="cb10-85"><a href="#cb10-85"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb10-86"><a href="#cb10-86"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb10-87"><a href="#cb10-87"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-88"><a href="#cb10-88"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-89"><a href="#cb10-89"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">35</span>, .<span class="dv">625</span>, .<span class="dv">78</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb10-90"><a href="#cb10-90"></a>           <span class="at">label =</span> <span class="st">"'~'"</span>,</span>
<span id="cb10-91"><a href="#cb10-91"></a>           <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-92"><a href="#cb10-92"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-93"><a href="#cb10-93"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-94"><a href="#cb10-94"></a></span>
<span id="cb10-95"><a href="#cb10-95"></a><span class="co"># third normal density</span></span>
<span id="cb10-96"><a href="#cb10-96"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb10-97"><a href="#cb10-97"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-98"><a href="#cb10-98"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-99"><a href="#cb10-99"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-100"><a href="#cb10-100"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-101"><a href="#cb10-101"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-102"><a href="#cb10-102"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-103"><a href="#cb10-103"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-104"><a href="#cb10-104"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-105"><a href="#cb10-105"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-106"><a href="#cb10-106"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"mu[0]"</span>, <span class="st">"sigma[0]"</span>), </span>
<span id="cb10-107"><a href="#cb10-107"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-108"><a href="#cb10-108"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-109"><a href="#cb10-109"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-110"><a href="#cb10-110"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-111"><a href="#cb10-111"></a></span>
<span id="cb10-112"><a href="#cb10-112"></a><span class="co"># fourth normal density</span></span>
<span id="cb10-113"><a href="#cb10-113"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb10-114"><a href="#cb10-114"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-115"><a href="#cb10-115"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-116"><a href="#cb10-116"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-117"><a href="#cb10-117"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-118"><a href="#cb10-118"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-119"><a href="#cb10-119"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-120"><a href="#cb10-120"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-121"><a href="#cb10-121"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-122"><a href="#cb10-122"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-123"><a href="#cb10-123"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"mu[1]"</span>, <span class="st">"sigma[1]"</span>), </span>
<span id="cb10-124"><a href="#cb10-124"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-125"><a href="#cb10-125"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-126"><a href="#cb10-126"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-127"><a href="#cb10-127"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-128"><a href="#cb10-128"></a></span>
<span id="cb10-129"><a href="#cb10-129"></a><span class="co"># two annotated arrows</span></span>
<span id="cb10-130"><a href="#cb10-130"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb10-131"><a href="#cb10-131"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">82</span>),</span>
<span id="cb10-132"><a href="#cb10-132"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-133"><a href="#cb10-133"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">36</span>, .<span class="dv">55</span>),</span>
<span id="cb10-134"><a href="#cb10-134"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-135"><a href="#cb10-135"></a>  </span>
<span id="cb10-136"><a href="#cb10-136"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb10-137"><a href="#cb10-137"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb10-138"><a href="#cb10-138"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-139"><a href="#cb10-139"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-140"><a href="#cb10-140"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">33</span>, .<span class="dv">64</span>, .<span class="dv">77</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb10-141"><a href="#cb10-141"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"italic(j)"</span>, <span class="st">"'~'"</span>, <span class="st">"italic(j)"</span>),</span>
<span id="cb10-142"><a href="#cb10-142"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb10-143"><a href="#cb10-143"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-144"><a href="#cb10-144"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-145"><a href="#cb10-145"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-146"><a href="#cb10-146"></a></span>
<span id="cb10-147"><a href="#cb10-147"></a><span class="co"># exponential density</span></span>
<span id="cb10-148"><a href="#cb10-148"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb10-149"><a href="#cb10-149"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-150"><a href="#cb10-150"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dexp</span>(x, <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dexp</span>(x, <span class="dv">2</span>))))) <span class="sc">+</span></span>
<span id="cb10-151"><a href="#cb10-151"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-152"><a href="#cb10-152"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-153"><a href="#cb10-153"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-154"><a href="#cb10-154"></a>           <span class="at">label =</span> <span class="st">"exp"</span>,</span>
<span id="cb10-155"><a href="#cb10-155"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-156"><a href="#cb10-156"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-157"><a href="#cb10-157"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-158"><a href="#cb10-158"></a>           <span class="at">label =</span> <span class="st">"italic(K)"</span>,</span>
<span id="cb10-159"><a href="#cb10-159"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-160"><a href="#cb10-160"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-161"><a href="#cb10-161"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-162"><a href="#cb10-162"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-163"><a href="#cb10-163"></a></span>
<span id="cb10-164"><a href="#cb10-164"></a><span class="co"># likelihood formula</span></span>
<span id="cb10-165"><a href="#cb10-165"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb10-166"><a href="#cb10-166"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb10-167"><a href="#cb10-167"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb10-168"><a href="#cb10-168"></a>         <span class="at">label =</span> <span class="st">"beta[0][italic(j)]+beta[1][italic(j)]*italic(x)[italic(i)*'|'*italic(j)]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-169"><a href="#cb10-169"></a>  </span>
<span id="cb10-170"><a href="#cb10-170"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb10-171"><a href="#cb10-171"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb10-172"><a href="#cb10-172"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb10-173"><a href="#cb10-173"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-174"><a href="#cb10-174"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-175"><a href="#cb10-175"></a></span>
<span id="cb10-176"><a href="#cb10-176"></a><span class="co"># half-normal density</span></span>
<span id="cb10-177"><a href="#cb10-177"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb10-178"><a href="#cb10-178"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-179"><a href="#cb10-179"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-180"><a href="#cb10-180"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-181"><a href="#cb10-181"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-182"><a href="#cb10-182"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-183"><a href="#cb10-183"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb10-184"><a href="#cb10-184"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-185"><a href="#cb10-185"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-186"><a href="#cb10-186"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-187"><a href="#cb10-187"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma]"</span>, </span>
<span id="cb10-188"><a href="#cb10-188"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-189"><a href="#cb10-189"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-190"><a href="#cb10-190"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-191"><a href="#cb10-191"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-192"><a href="#cb10-192"></a></span>
<span id="cb10-193"><a href="#cb10-193"></a><span class="co"># four annotated arrows</span></span>
<span id="cb10-194"><a href="#cb10-194"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb10-195"><a href="#cb10-195"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">43</span>, .<span class="dv">43</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb10-196"><a href="#cb10-196"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">55</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-197"><a href="#cb10-197"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">43</span>, <span class="fl">1.225</span>, <span class="fl">1.5</span>, <span class="fl">1.75</span>),</span>
<span id="cb10-198"><a href="#cb10-198"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">15</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-199"><a href="#cb10-199"></a>  </span>
<span id="cb10-200"><a href="#cb10-200"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb10-201"><a href="#cb10-201"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb10-202"><a href="#cb10-202"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-203"><a href="#cb10-203"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-204"><a href="#cb10-204"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">7</span>, <span class="fl">1.38</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">22</span>, .<span class="dv">65</span>, .<span class="dv">6</span>),</span>
<span id="cb10-205"><a href="#cb10-205"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"'='"</span>, <span class="st">"'='"</span>, <span class="st">"'~'"</span>),</span>
<span id="cb10-206"><a href="#cb10-206"></a>           <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb10-207"><a href="#cb10-207"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-208"><a href="#cb10-208"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-209"><a href="#cb10-209"></a>           <span class="at">x =</span> .<span class="dv">43</span>, <span class="at">y =</span> .<span class="dv">7</span>,</span>
<span id="cb10-210"><a href="#cb10-210"></a>           <span class="at">label =</span> <span class="st">"nu*minute+1"</span>,</span>
<span id="cb10-211"><a href="#cb10-211"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-212"><a href="#cb10-212"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-213"><a href="#cb10-213"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-214"><a href="#cb10-214"></a></span>
<span id="cb10-215"><a href="#cb10-215"></a><span class="co"># student-t density</span></span>
<span id="cb10-216"><a href="#cb10-216"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb10-217"><a href="#cb10-217"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-218"><a href="#cb10-218"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dt</span>(x, <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dt</span>(x, <span class="dv">3</span>))))) <span class="sc">+</span></span>
<span id="cb10-219"><a href="#cb10-219"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-220"><a href="#cb10-220"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-221"><a href="#cb10-221"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-222"><a href="#cb10-222"></a>           <span class="at">label =</span> <span class="st">"student t"</span>,</span>
<span id="cb10-223"><a href="#cb10-223"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-224"><a href="#cb10-224"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-225"><a href="#cb10-225"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-226"><a href="#cb10-226"></a>           <span class="at">label =</span> <span class="st">"nu~~mu[italic(i)*'|'*italic(j)]~~sigma"</span>,</span>
<span id="cb10-227"><a href="#cb10-227"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-228"><a href="#cb10-228"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-229"><a href="#cb10-229"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-230"><a href="#cb10-230"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-231"><a href="#cb10-231"></a></span>
<span id="cb10-232"><a href="#cb10-232"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb10-233"><a href="#cb10-233"></a>p14 <span class="ot">&lt;-</span></span>
<span id="cb10-234"><a href="#cb10-234"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb10-235"><a href="#cb10-235"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb10-236"><a href="#cb10-236"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"italic(i)*'|'*italic(j)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-237"><a href="#cb10-237"></a>  </span>
<span id="cb10-238"><a href="#cb10-238"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb10-239"><a href="#cb10-239"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb10-240"><a href="#cb10-240"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb10-241"><a href="#cb10-241"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb10-242"><a href="#cb10-242"></a>               <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">arrow =</span> my_arrow) <span class="sc">+</span></span>
<span id="cb10-243"><a href="#cb10-243"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-244"><a href="#cb10-244"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-245"><a href="#cb10-245"></a></span>
<span id="cb10-246"><a href="#cb10-246"></a><span class="co"># some text</span></span>
<span id="cb10-247"><a href="#cb10-247"></a>p15 <span class="ot">&lt;-</span></span>
<span id="cb10-248"><a href="#cb10-248"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb10-249"><a href="#cb10-249"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb10-250"><a href="#cb10-250"></a>         <span class="at">label =</span> <span class="st">"italic(y)[italic(i)*'|'*italic(j)]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-251"><a href="#cb10-251"></a>  </span>
<span id="cb10-252"><a href="#cb10-252"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb10-253"><a href="#cb10-253"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb10-254"><a href="#cb10-254"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-255"><a href="#cb10-255"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-256"><a href="#cb10-256"></a></span>
<span id="cb10-257"><a href="#cb10-257"></a><span class="co"># define the layout</span></span>
<span id="cb10-258"><a href="#cb10-258"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb10-259"><a href="#cb10-259"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb10-260"><a href="#cb10-260"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb10-261"><a href="#cb10-261"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb10-262"><a href="#cb10-262"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">13</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb10-263"><a href="#cb10-263"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb10-264"><a href="#cb10-264"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb10-265"><a href="#cb10-265"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb10-266"><a href="#cb10-266"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">5</span>),</span>
<span id="cb10-267"><a href="#cb10-267"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb10-268"><a href="#cb10-268"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb10-269"><a href="#cb10-269"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb10-270"><a href="#cb10-270"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb10-271"><a href="#cb10-271"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb10-272"><a href="#cb10-272"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb10-273"><a href="#cb10-273"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">13</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>)</span>
<span id="cb10-274"><a href="#cb10-274"></a>)</span>
<span id="cb10-275"><a href="#cb10-275"></a></span>
<span id="cb10-276"><a href="#cb10-276"></a><span class="co"># combine and plot!</span></span>
<span id="cb10-277"><a href="#cb10-277"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p5 <span class="sc">+</span> p9 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p8 <span class="sc">+</span> p13 <span class="sc">+</span> p12 <span class="sc">+</span> p14 <span class="sc">+</span> p15) <span class="sc">+</span> </span>
<span id="cb10-278"><a href="#cb10-278"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb10-279"><a href="#cb10-279"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb10-280"><a href="#cb10-280"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>If we are estimating a mean, we can divide that up into two priors:</p>
<ol type="1">
<li><p>A distribution of our best guess at the mean e.g., N(3,.5) means I am very confident in my guess vs N(3,50). This is all about the mean.</p></li>
<li><p>A distribution that represents the spread around that mean e.g., N(0,1) suggests small spread vs (0,100) suggest people may differ a lot (Even though the distribution has the same mean).</p></li>
</ol>
<p>Fixed effect describes #1 whereas random effects describe #2</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb11-2"><a href="#cb11-2"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb11-4"><a href="#cb11-4"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb11-5"><a href="#cb11-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb11-6"><a href="#cb11-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd), </span>
<span id="cb11-7"><a href="#cb11-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb11-8"><a href="#cb11-8"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb11-9"><a href="#cb11-9"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb11-10"><a href="#cb11-10"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb11-11"><a href="#cb11-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb11-12"><a href="#cb11-12"></a>      <span class="at">file =</span> <span class="st">"mlm.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you think about parameters you are estimating the number of priors are simple. But in terms of what those priors represent, they are providing a prior on a prior. The intercept and the SD are both providing estimates of means. We could model this 1 parameter (anova or index coded) or 2 (mlm)</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     5431     8578

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.20 1.00     7203    10549

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     9902    11403

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Notice we have one less parameter we are estimating.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>mlm<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb14-3"><a href="#cb14-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> ,</span>
<span id="cb14-4"><a href="#cb14-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb14-5"><a href="#cb14-5"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb14-6"><a href="#cb14-6"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb14-7"><a href="#cb14-7"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb14-8"><a href="#cb14-8"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb14-9"><a href="#cb14-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb14-10"><a href="#cb14-10"></a>      <span class="at">file =</span> <span class="st">"mlm.2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">summary</span>(mlm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.00     0.18     0.20 1.00    16615    11267

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.07      0.00     0.07     0.08 1.00    10474     9132

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>, <span class="st">"loo"</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>mlm<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.2</span>, <span class="st">"loo"</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="fu">loo_compare</span>(mlm<span class="fl">.1</span>, mlm<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      elpd_diff se_diff
mlm.1   0.0       0.0  
mlm.2 -58.1       8.8  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>Notice how the intercept is the same in each of these models. Even the CIs. Conceptually they are different though. The intercept is directly modeled in the standard regression. In the MLM it is better thought of as the map of the distribution of random effects.</p></li>
<li><p>The population is larger than what we have. This is true for almost anything we do. We sample paradigms, we sample people, we usually never have a full population under our study. Don’t we want to model that variation?</p></li>
</ul>
</section>
<section class="slide level2">

<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma)\]</span> <span class="math display">\[\mu_i  = \beta_{0[j]}\]</span> This parenthesis indicates we have varying intercepts that vary over individual j. Each parameter estimated needs a prior. <span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="parameters-that-depend-on-parameters-1" class="slide level2">
<h2>Parameters that depend on parameters</h2>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>With mlm we treated means as coming from a population of means. And thus there was a best guess of the mean (intercept) and variation around that guess (SD). With anova we ignored the variation. But we could, in bayes, still examine that variation. Lets fit an index model, where each person gets a mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>mlm<span class="sc">$</span>ID.f <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mlm<span class="sc">$</span>ID)</span>
<span id="cb19-2"><a href="#cb19-2"></a>mlm.id <span class="ot">&lt;-</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb19-4"><a href="#cb19-4"></a>      CON <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ID.f ,</span>
<span id="cb19-5"><a href="#cb19-5"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb19-6"><a href="#cb19-6"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb19-7"><a href="#cb19-7"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb19-8"><a href="#cb19-8"></a>      <span class="at">file =</span> <span class="st">"mlm.id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>This is similar to a “fixed effect” model, something that is popular in econometrics. It, in contrast to the random effect model, does not model random effects.</p>
<p>Why do we want to model random effects? Variance decomposition which leads to increased power.</p>
<p>Also, 1. we can include group/cluster level predictors, which fixed effect cannot. 2. it makes an assumption about whether the clusters are random or not. Psych they are almost always random (people, site, orgs) whereas for econometrics they aren’t (country, state).</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">summary</span>(mlm.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 0 + ID.f 
   Data: mlm (Number of observations: 225) 
  Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Population-Level Effects: 
        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
ID.f6       0.19      0.03     0.14     0.24 1.00    12843     4563
ID.f29      0.12      0.03     0.06     0.19 1.00    12890     4381
ID.f34      0.11      0.03     0.04     0.17 1.00    11125     3396
ID.f36      0.16      0.03     0.09     0.22 1.00    10520     4353
ID.f37      0.19      0.03     0.13     0.24 1.00    13971     4513
ID.f48      0.22      0.03     0.16     0.28 1.00    11877     3672
ID.f53      0.19      0.03     0.12     0.25 1.00    12973     3832
ID.f54      0.25      0.03     0.19     0.30 1.00    10693     4209
ID.f58      0.24      0.03     0.18     0.29 1.00    11734     3630
ID.f61      0.09      0.03     0.02     0.15 1.00    11095     4131
ID.f66      0.24      0.03     0.18     0.30 1.00    10702     3905
ID.f67      0.20      0.02     0.15     0.25 1.00    12121     4120
ID.f69      0.21      0.03     0.14     0.27 1.00    11762     4351
ID.f71      0.06      0.03     0.00     0.11 1.00    12658     4033
ID.f74      0.20      0.03     0.15     0.26 1.00    12824     4541
ID.f75      0.27      0.03     0.21     0.34 1.00    13089     4330
ID.f76      0.10      0.03     0.05     0.15 1.00    11192     4021
ID.f78      0.24      0.03     0.19     0.30 1.00    13957     4076
ID.f79      0.13      0.03     0.06     0.20 1.00    11956     3914
ID.f80      0.14      0.03     0.07     0.20 1.00    10268     4029
ID.f81      0.24      0.03     0.19     0.30 1.00    11554     4247
ID.f82      0.33      0.02     0.28     0.37 1.00    10263     4261
ID.f85      0.16      0.03     0.09     0.22 1.00    12539     4150
ID.f86      0.12      0.03     0.05     0.18 1.00    10475     4054
ID.f87      0.11      0.03     0.05     0.18 1.00    13807     4300
ID.f89      0.14      0.03     0.08     0.19 1.00    11419     4313
ID.f91      0.17      0.03     0.12     0.23 1.00    12721     4282
ID.f92      0.20      0.03     0.15     0.26 1.00    11862     4418
ID.f93      0.25      0.03     0.20     0.31 1.00    12602     3651
ID.f94      0.12      0.03     0.06     0.17 1.00    11041     3875
ID.f96      0.23      0.03     0.16     0.30 1.00    12876     3812
ID.f97      0.25      0.02     0.20     0.29 1.00    10826     4330
ID.f98      0.14      0.02     0.09     0.19 1.00     9621     4076
ID.f99      0.18      0.02     0.13     0.23 1.00    12074     4029
ID.f101     0.25      0.03     0.19     0.30 1.00    13398     4000
ID.f102     0.19      0.02     0.14     0.23 1.00    11928     4485
ID.f103     0.15      0.03     0.09     0.22 1.00    12408     4337
ID.f104     0.17      0.03     0.11     0.24 1.00    11784     4181
ID.f105     0.16      0.03     0.11     0.22 1.00    10588     3372
ID.f106     0.20      0.03     0.14     0.25 1.00    12531     4475
ID.f110     0.18      0.03     0.13     0.24 1.00    11621     3912
ID.f112     0.09      0.03     0.04     0.15 1.00    12749     4372
ID.f114     0.13      0.03     0.08     0.19 1.00    13131     4640
ID.f115     0.14      0.03     0.09     0.20 1.00    11539     4158
ID.f116     0.14      0.03     0.09     0.20 1.00    11704     4916
ID.f120     0.35      0.03     0.29     0.42 1.00    11116     4498
ID.f122     0.17      0.03     0.12     0.22 1.00    13135     4066
ID.f125     0.20      0.03     0.14     0.25 1.00    10812     4172
ID.f127     0.23      0.03     0.17     0.28 1.00    12523     4304
ID.f129     0.13      0.03     0.06     0.20 1.00    12336     3775
ID.f135     0.30      0.03     0.24     0.35 1.00    11249     4325
ID.f136     0.29      0.03     0.24     0.34 1.00    12910     4060
ID.f137     0.29      0.03     0.23     0.36 1.00    11799     3709
ID.f140     0.13      0.03     0.06     0.19 1.00    12368     4573
ID.f141     0.19      0.03     0.13     0.26 1.00    11270     4112
ID.f142     0.18      0.03     0.11     0.24 1.00    11910     3756
ID.f143     0.31      0.03     0.25     0.38 1.00    11943     4100
ID.f144     0.17      0.03     0.11     0.24 1.00    10872     4346
ID.f146     0.21      0.03     0.14     0.28 1.00    12834     3844
ID.f149     0.23      0.03     0.16     0.30 1.00    13499     4048
ID.f150     0.20      0.03     0.14     0.27 1.00    11754     4112
ID.f152     0.22      0.03     0.16     0.29 1.00    12196     3979
ID.f153     0.15      0.03     0.08     0.21 1.00    11960     4349
ID.f155     0.14      0.03     0.08     0.21 1.00    12799     4708
ID.f156     0.14      0.03     0.08     0.19 1.00    11804     4149
ID.f159     0.12      0.03     0.06     0.19 1.00    12160     3926
ID.f160     0.18      0.03     0.11     0.24 1.00    12500     4331
ID.f162     0.39      0.03     0.34     0.45 1.00    11956     4512
ID.f163     0.13      0.03     0.07     0.20 1.00    13493     4058
ID.f165     0.20      0.03     0.13     0.26 1.00    10433     3473
ID.f167     0.13      0.03     0.06     0.20 1.00    11378     3996
ID.f169     0.24      0.03     0.18     0.31 1.00    10844     3478
ID.f171     0.23      0.03     0.16     0.29 1.00    11715     4200
ID.f174     0.26      0.03     0.20     0.33 1.00    12807     4506
ID.f182     0.19      0.03     0.12     0.25 1.00    14151     4268
ID.f187     0.06      0.03    -0.00     0.13 1.00    11480     3807
ID.f189     0.22      0.03     0.16     0.29 1.00    10615     3896
ID.f190     0.13      0.03     0.06     0.19 1.00    11900     4110
ID.f193     0.21      0.03     0.14     0.27 1.00    11690     3406
ID.f194     0.12      0.03     0.05     0.19 1.00    11769     4036
ID.f201     0.19      0.03     0.12     0.25 1.00    12564     4307
ID.f204     0.29      0.03     0.22     0.35 1.00    11331     4479
ID.f205     0.19      0.03     0.13     0.26 1.00    12142     4243
ID.f208     0.20      0.03     0.14     0.27 1.00    11908     4093
ID.f209     0.21      0.03     0.15     0.28 1.00    12056     4303
ID.f211     0.14      0.03     0.07     0.21 1.00    12298     4843
ID.f214     0.28      0.03     0.21     0.34 1.00    11659     4294
ID.f219     0.23      0.03     0.16     0.30 1.00    13161     3850
ID.f222     0.14      0.03     0.07     0.20 1.00    11313     4140
ID.f223     0.17      0.03     0.10     0.23 1.00    12990     4250
ID.f229     0.14      0.03     0.07     0.21 1.00    11559     4131

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     3458     3621

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">posterior_samples</span>(mlm.id) <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">pivot_longer</span>(b_ID.f6<span class="sc">:</span>b_ID.f91, <span class="at">names_to=</span><span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(value), <span class="at">sd=</span><span class="fu">sd</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
   mean     sd
  &lt;dbl&gt;  &lt;dbl&gt;
1 0.177 0.0698</code></pre>
</div>
</div>
</section>
<section id="partial-poolingshrinkage" class="slide level2">
<h2>Partial pooling/Shrinkage</h2>
<p><span class="math inline">\(\sigma_0\)</span> (our random effect) can turn on/off/adjust shrinkage.</p>
<p>Setting SD to zero says everyone is the same. Infinite SD says all groups are unrelated (no pooling). In the middle gives you partial pooling.</p>
<p>We use our prior of <span class="math inline">\(\sigma_0\)</span> plus our data to get an estimate of <span class="math inline">\(\beta_{0[j]}\)</span>. This is how we accurately partial pool.</p>
</section>
<section id="partial-poolingshrinkage-1" class="slide level2">
<h2>Partial pooling/Shrinkage</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma_i)\]</span></p>
<p><span class="math display">\[\mu_i  = \beta_{0[i]}\]</span></p>
<p><span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span></p>
<p><span class="math display">\[\sigma_0 \sim {\operatorname{Normal}(0, 1.5)}\]</span></p>
<p><span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="working-with-mlm-posterior" class="slide level2">
<h2>working with mlm posterior</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     5431     8578

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.20 1.00     7203    10549

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     9902    11403

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">get_variables</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"         "sd_ID__Intercept"    "sigma"              
  [4] "r_ID[6,Intercept]"   "r_ID[29,Intercept]"  "r_ID[34,Intercept]" 
  [7] "r_ID[36,Intercept]"  "r_ID[37,Intercept]"  "r_ID[48,Intercept]" 
 [10] "r_ID[53,Intercept]"  "r_ID[54,Intercept]"  "r_ID[58,Intercept]" 
 [13] "r_ID[61,Intercept]"  "r_ID[66,Intercept]"  "r_ID[67,Intercept]" 
 [16] "r_ID[69,Intercept]"  "r_ID[71,Intercept]"  "r_ID[74,Intercept]" 
 [19] "r_ID[75,Intercept]"  "r_ID[76,Intercept]"  "r_ID[78,Intercept]" 
 [22] "r_ID[79,Intercept]"  "r_ID[80,Intercept]"  "r_ID[81,Intercept]" 
 [25] "r_ID[82,Intercept]"  "r_ID[85,Intercept]"  "r_ID[86,Intercept]" 
 [28] "r_ID[87,Intercept]"  "r_ID[89,Intercept]"  "r_ID[91,Intercept]" 
 [31] "r_ID[92,Intercept]"  "r_ID[93,Intercept]"  "r_ID[94,Intercept]" 
 [34] "r_ID[96,Intercept]"  "r_ID[97,Intercept]"  "r_ID[98,Intercept]" 
 [37] "r_ID[99,Intercept]"  "r_ID[101,Intercept]" "r_ID[102,Intercept]"
 [40] "r_ID[103,Intercept]" "r_ID[104,Intercept]" "r_ID[105,Intercept]"
 [43] "r_ID[106,Intercept]" "r_ID[110,Intercept]" "r_ID[112,Intercept]"
 [46] "r_ID[114,Intercept]" "r_ID[115,Intercept]" "r_ID[116,Intercept]"
 [49] "r_ID[120,Intercept]" "r_ID[122,Intercept]" "r_ID[125,Intercept]"
 [52] "r_ID[127,Intercept]" "r_ID[129,Intercept]" "r_ID[135,Intercept]"
 [55] "r_ID[136,Intercept]" "r_ID[137,Intercept]" "r_ID[140,Intercept]"
 [58] "r_ID[141,Intercept]" "r_ID[142,Intercept]" "r_ID[143,Intercept]"
 [61] "r_ID[144,Intercept]" "r_ID[146,Intercept]" "r_ID[149,Intercept]"
 [64] "r_ID[150,Intercept]" "r_ID[152,Intercept]" "r_ID[153,Intercept]"
 [67] "r_ID[155,Intercept]" "r_ID[156,Intercept]" "r_ID[159,Intercept]"
 [70] "r_ID[160,Intercept]" "r_ID[162,Intercept]" "r_ID[163,Intercept]"
 [73] "r_ID[165,Intercept]" "r_ID[167,Intercept]" "r_ID[169,Intercept]"
 [76] "r_ID[171,Intercept]" "r_ID[174,Intercept]" "r_ID[182,Intercept]"
 [79] "r_ID[187,Intercept]" "r_ID[189,Intercept]" "r_ID[190,Intercept]"
 [82] "r_ID[193,Intercept]" "r_ID[194,Intercept]" "r_ID[201,Intercept]"
 [85] "r_ID[204,Intercept]" "r_ID[205,Intercept]" "r_ID[208,Intercept]"
 [88] "r_ID[209,Intercept]" "r_ID[211,Intercept]" "r_ID[214,Intercept]"
 [91] "r_ID[219,Intercept]" "r_ID[222,Intercept]" "r_ID[223,Intercept]"
 [94] "r_ID[229,Intercept]" "prior_Intercept"     "prior_sigma"        
 [97] "prior_sd_ID"         "lprior"              "lp__"               
[100] "accept_stat__"       "treedepth__"         "stepsize__"         
[103] "divergent__"         "n_leapfrog__"        "energy__"           </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 6
# Groups:   ID, term [91]
      ID term          r_ID .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6 Intercept  0.00486      1          1     1
 2     6 Intercept  0.00189      1          2     2
 3     6 Intercept  0.0203       1          3     3
 4     6 Intercept -0.0463       1          4     4
 5     6 Intercept  0.0358       1          5     5
 6     6 Intercept -0.0305       1          6     6
 7     6 Intercept  0.0108       1          7     7
 8     6 Intercept  0.00562      1          8     8
 9     6 Intercept  0.00230      1          9     9
10     6 Intercept  0.0235       1         10    10
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
<p>16000 samples (4 chains * 4k iterations) * 91 people</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 5
# Groups:   ID [91]
      ID     r_ID .chain .iteration .draw
   &lt;int&gt;    &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6  0.00486      1          1     1
 2     6  0.00189      1          2     2
 3     6  0.0203       1          3     3
 4     6 -0.0463       1          4     4
 5     6  0.0358       1          5     5
 6     6 -0.0305       1          6     6
 7     6  0.0108       1          7     7
 8     6  0.00562      1          8     8
 9     6  0.00230      1          9     9
10     6  0.0235       1         10    10
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a> <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 8
      ID term           r_ID   .lower   .upper .width .point .interval
   &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1     6 Intercept  0.000127 -0.0495   0.0492    0.95 median qi       
 2    29 Intercept -0.0482   -0.106    0.00947   0.95 median qi       
 3    34 Intercept -0.0614   -0.120   -0.00548   0.95 median qi       
 4    36 Intercept -0.0225   -0.0795   0.0348    0.95 median qi       
 5    37 Intercept -0.00341  -0.0522   0.0459    0.95 median qi       
 6    48 Intercept  0.0234   -0.0255   0.0728    0.95 median qi       
 7    53 Intercept  0.000252 -0.0556   0.0569    0.95 median qi       
 8    54 Intercept  0.0452   -0.00413  0.0937    0.95 median qi       
 9    58 Intercept  0.0370   -0.0125   0.0867    0.95 median qi       
10    61 Intercept -0.0743   -0.131   -0.0168    0.95 median qi       
# ℹ 81 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> r_ID), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="st">"orange is model based, black circles are observed means"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Think back to {lme4} and <code>ranef</code> <code>coef</code> and <code>fixef</code> functions.</p>
<p>What do each of these describe?</p>
<p>What scale is our random effect (typically) in?</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 7
# Groups:   ID, term [91]
   .chain .iteration .draw b_Intercept    ID term          r_ID
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
 1      1          1     1       0.201     6 Intercept  0.00486
 2      1          1     1       0.201    29 Intercept -0.0310 
 3      1          1     1       0.201    34 Intercept -0.124  
 4      1          1     1       0.201    36 Intercept -0.105  
 5      1          1     1       0.201    37 Intercept -0.0349 
 6      1          1     1       0.201    48 Intercept  0.0250 
 7      1          1     1       0.201    53 Intercept -0.0462 
 8      1          1     1       0.201    54 Intercept  0.0262 
 9      1          1     1       0.201    58 Intercept -0.0356 
10      1          1     1       0.201    61 Intercept -0.0765 
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3"></a>   <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 8
# Groups:   ID, term [91]
   .chain .iteration .draw b_Intercept    ID term          r_ID person_I
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
 1      1          1     1       0.201     6 Intercept  0.00486   0.206 
 2      1          1     1       0.201    29 Intercept -0.0310    0.170 
 3      1          1     1       0.201    34 Intercept -0.124     0.0769
 4      1          1     1       0.201    36 Intercept -0.105     0.0961
 5      1          1     1       0.201    37 Intercept -0.0349    0.166 
 6      1          1     1       0.201    48 Intercept  0.0250    0.226 
 7      1          1     1       0.201    53 Intercept -0.0462    0.155 
 8      1          1     1       0.201    54 Intercept  0.0262    0.227 
 9      1          1     1       0.201    58 Intercept -0.0356    0.165 
10      1          1     1       0.201    61 Intercept -0.0765    0.124 
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="#cb39-5"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> person_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="st">"orange is model based, black circles are observed means"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.1849846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>   <span class="fu">median_qi</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_I), <span class="at">x =</span> person_I, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="fu">geom_pointinterval</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Set prior for random effect to almost zero for complete pooling.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>mlm<span class="fl">.1</span>p <span class="ot">&lt;-</span> </span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb41-3"><a href="#cb41-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb41-4"><a href="#cb41-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb41-5"><a href="#cb41-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">00001</span>), <span class="at">class =</span> sd), </span>
<span id="cb41-6"><a href="#cb41-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb41-7"><a href="#cb41-7"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb41-8"><a href="#cb41-8"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb41-9"><a href="#cb41-9"></a>      <span class="at">file =</span> <span class="st">"mlm.1p"</span>,</span>
<span id="cb41-10"><a href="#cb41-10"></a>       <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb41-11"><a href="#cb41-11"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.00      0.00     0.00     0.00 1.00     9457     6383

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.00     0.18     0.20 1.00    15396     8212

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.07      0.00     0.07     0.08 1.00    17206     8431

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>mlm<span class="fl">.1</span>p <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> person_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb44-10"><a href="#cb44-10"></a>  <span class="st">"complete pooling"</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.189846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>No pooling means you are not learning from other data, which is by default not an MLM model. We already fit this fixed effects no intercept model above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">summary</span>(mlm.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 0 + ID.f 
   Data: mlm (Number of observations: 225) 
  Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Population-Level Effects: 
        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
ID.f6       0.19      0.03     0.14     0.24 1.00    12843     4563
ID.f29      0.12      0.03     0.06     0.19 1.00    12890     4381
ID.f34      0.11      0.03     0.04     0.17 1.00    11125     3396
ID.f36      0.16      0.03     0.09     0.22 1.00    10520     4353
ID.f37      0.19      0.03     0.13     0.24 1.00    13971     4513
ID.f48      0.22      0.03     0.16     0.28 1.00    11877     3672
ID.f53      0.19      0.03     0.12     0.25 1.00    12973     3832
ID.f54      0.25      0.03     0.19     0.30 1.00    10693     4209
ID.f58      0.24      0.03     0.18     0.29 1.00    11734     3630
ID.f61      0.09      0.03     0.02     0.15 1.00    11095     4131
ID.f66      0.24      0.03     0.18     0.30 1.00    10702     3905
ID.f67      0.20      0.02     0.15     0.25 1.00    12121     4120
ID.f69      0.21      0.03     0.14     0.27 1.00    11762     4351
ID.f71      0.06      0.03     0.00     0.11 1.00    12658     4033
ID.f74      0.20      0.03     0.15     0.26 1.00    12824     4541
ID.f75      0.27      0.03     0.21     0.34 1.00    13089     4330
ID.f76      0.10      0.03     0.05     0.15 1.00    11192     4021
ID.f78      0.24      0.03     0.19     0.30 1.00    13957     4076
ID.f79      0.13      0.03     0.06     0.20 1.00    11956     3914
ID.f80      0.14      0.03     0.07     0.20 1.00    10268     4029
ID.f81      0.24      0.03     0.19     0.30 1.00    11554     4247
ID.f82      0.33      0.02     0.28     0.37 1.00    10263     4261
ID.f85      0.16      0.03     0.09     0.22 1.00    12539     4150
ID.f86      0.12      0.03     0.05     0.18 1.00    10475     4054
ID.f87      0.11      0.03     0.05     0.18 1.00    13807     4300
ID.f89      0.14      0.03     0.08     0.19 1.00    11419     4313
ID.f91      0.17      0.03     0.12     0.23 1.00    12721     4282
ID.f92      0.20      0.03     0.15     0.26 1.00    11862     4418
ID.f93      0.25      0.03     0.20     0.31 1.00    12602     3651
ID.f94      0.12      0.03     0.06     0.17 1.00    11041     3875
ID.f96      0.23      0.03     0.16     0.30 1.00    12876     3812
ID.f97      0.25      0.02     0.20     0.29 1.00    10826     4330
ID.f98      0.14      0.02     0.09     0.19 1.00     9621     4076
ID.f99      0.18      0.02     0.13     0.23 1.00    12074     4029
ID.f101     0.25      0.03     0.19     0.30 1.00    13398     4000
ID.f102     0.19      0.02     0.14     0.23 1.00    11928     4485
ID.f103     0.15      0.03     0.09     0.22 1.00    12408     4337
ID.f104     0.17      0.03     0.11     0.24 1.00    11784     4181
ID.f105     0.16      0.03     0.11     0.22 1.00    10588     3372
ID.f106     0.20      0.03     0.14     0.25 1.00    12531     4475
ID.f110     0.18      0.03     0.13     0.24 1.00    11621     3912
ID.f112     0.09      0.03     0.04     0.15 1.00    12749     4372
ID.f114     0.13      0.03     0.08     0.19 1.00    13131     4640
ID.f115     0.14      0.03     0.09     0.20 1.00    11539     4158
ID.f116     0.14      0.03     0.09     0.20 1.00    11704     4916
ID.f120     0.35      0.03     0.29     0.42 1.00    11116     4498
ID.f122     0.17      0.03     0.12     0.22 1.00    13135     4066
ID.f125     0.20      0.03     0.14     0.25 1.00    10812     4172
ID.f127     0.23      0.03     0.17     0.28 1.00    12523     4304
ID.f129     0.13      0.03     0.06     0.20 1.00    12336     3775
ID.f135     0.30      0.03     0.24     0.35 1.00    11249     4325
ID.f136     0.29      0.03     0.24     0.34 1.00    12910     4060
ID.f137     0.29      0.03     0.23     0.36 1.00    11799     3709
ID.f140     0.13      0.03     0.06     0.19 1.00    12368     4573
ID.f141     0.19      0.03     0.13     0.26 1.00    11270     4112
ID.f142     0.18      0.03     0.11     0.24 1.00    11910     3756
ID.f143     0.31      0.03     0.25     0.38 1.00    11943     4100
ID.f144     0.17      0.03     0.11     0.24 1.00    10872     4346
ID.f146     0.21      0.03     0.14     0.28 1.00    12834     3844
ID.f149     0.23      0.03     0.16     0.30 1.00    13499     4048
ID.f150     0.20      0.03     0.14     0.27 1.00    11754     4112
ID.f152     0.22      0.03     0.16     0.29 1.00    12196     3979
ID.f153     0.15      0.03     0.08     0.21 1.00    11960     4349
ID.f155     0.14      0.03     0.08     0.21 1.00    12799     4708
ID.f156     0.14      0.03     0.08     0.19 1.00    11804     4149
ID.f159     0.12      0.03     0.06     0.19 1.00    12160     3926
ID.f160     0.18      0.03     0.11     0.24 1.00    12500     4331
ID.f162     0.39      0.03     0.34     0.45 1.00    11956     4512
ID.f163     0.13      0.03     0.07     0.20 1.00    13493     4058
ID.f165     0.20      0.03     0.13     0.26 1.00    10433     3473
ID.f167     0.13      0.03     0.06     0.20 1.00    11378     3996
ID.f169     0.24      0.03     0.18     0.31 1.00    10844     3478
ID.f171     0.23      0.03     0.16     0.29 1.00    11715     4200
ID.f174     0.26      0.03     0.20     0.33 1.00    12807     4506
ID.f182     0.19      0.03     0.12     0.25 1.00    14151     4268
ID.f187     0.06      0.03    -0.00     0.13 1.00    11480     3807
ID.f189     0.22      0.03     0.16     0.29 1.00    10615     3896
ID.f190     0.13      0.03     0.06     0.19 1.00    11900     4110
ID.f193     0.21      0.03     0.14     0.27 1.00    11690     3406
ID.f194     0.12      0.03     0.05     0.19 1.00    11769     4036
ID.f201     0.19      0.03     0.12     0.25 1.00    12564     4307
ID.f204     0.29      0.03     0.22     0.35 1.00    11331     4479
ID.f205     0.19      0.03     0.13     0.26 1.00    12142     4243
ID.f208     0.20      0.03     0.14     0.27 1.00    11908     4093
ID.f209     0.21      0.03     0.15     0.28 1.00    12056     4303
ID.f211     0.14      0.03     0.07     0.21 1.00    12298     4843
ID.f214     0.28      0.03     0.21     0.34 1.00    11659     4294
ID.f219     0.23      0.03     0.16     0.30 1.00    13161     3850
ID.f222     0.14      0.03     0.07     0.20 1.00    11313     4140
ID.f223     0.17      0.03     0.10     0.23 1.00    12990     4250
ID.f229     0.14      0.03     0.07     0.21 1.00    11559     4131

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     3458     3621

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>data2<span class="ot">&lt;-</span>mlm <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, CON) <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb47-5"><a href="#cb47-5"></a></span>
<span id="cb47-6"><a href="#cb47-6"></a>mlm.id <span class="sc">%&gt;%</span> <span class="fu">tidy_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-7"><a href="#cb47-7"></a>  <span class="fu">pivot_longer</span>(b_ID.f6<span class="sc">:</span>b_ID.f229, <span class="at">names_to =</span> <span class="st">"ID"</span>, <span class="at">values_to =</span> <span class="st">"CON_I"</span>, <span class="at">names_prefix =</span> <span class="st">"b_ID.f"</span>, <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">ID =</span> as.integer)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="fu">left_join</span>(data2) <span class="sc">%&gt;%</span> </span>
<span id="cb47-9"><a href="#cb47-9"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb47-10"><a href="#cb47-10"></a>   <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb47-15"><a href="#cb47-15"></a>  <span class="st">"NO pooling"</span>) <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.1849846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>MLM will automatically create the best fitting model – balancing between over and under fitting. It identifies the value of sigma of the random effect that is ideal.</p>
<p>This “knob” can be manually turned to different values and we can look at the fit of the model via loo or wais. But we dont need to!</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>mlm.id <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm.id, <span class="st">"loo"</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>mlm<span class="fl">.1</span>p <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>p, <span class="st">"loo"</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>, <span class="st">"loo"</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="fu">loo_compare</span>(mlm.id, mlm<span class="fl">.1</span>p, mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff
mlm.1    0.0       0.0  
mlm.id -16.2       5.8  
mlm.1p -58.1       8.8  </code></pre>
</div>
</div>
</section>
<section id="level-1-predictors-1" class="slide level2">
<h2>level 1 predictors</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma)\]</span> <span class="math display">\[\mu_i  = \beta_{0[j]} + \beta_{1[j]}Time_{ij}\]</span></p>
<p><span class="math display">\[\beta_{0[j]} \sim \operatorname{Normal}({\bar \mu}, \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\beta_{1[j]} \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section class="slide level2">

<p>Notice how the slope variable was not a hyper prior. What does that mean? That means it is not random. People can still differ, but only based on the equation we set up for it. That is, there are fixed effects based on different gammas, but not Us to represent random variation. To do so we would need a parameter for that, and we dont have it.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">get_prior</span>(CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class      coef group resp dpar nlpar lb ub
                 (flat)         b                                      
                 (flat)         b      time                            
 student_t(3, 0.2, 2.5) Intercept                                      
   student_t(3, 0, 2.5)        sd                                  0   
   student_t(3, 0, 2.5)        sd              ID                  0   
   student_t(3, 0, 2.5)        sd Intercept    ID                  0   
   student_t(3, 0, 2.5)     sigma                                  0   
       source
      default
 (vectorized)
      default
      default
 (vectorized)
 (vectorized)
      default</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>mlm<span class="fl">.3</span> <span class="ot">&lt;-</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb52-3"><a href="#cb52-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb52-4"><a href="#cb52-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb52-5"><a href="#cb52-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb52-6"><a href="#cb52-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd), </span>
<span id="cb52-7"><a href="#cb52-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb52-8"><a href="#cb52-8"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb52-9"><a href="#cb52-9"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb52-10"><a href="#cb52-10"></a>      <span class="at">file =</span> <span class="st">"mlm.3"</span>,</span>
<span id="cb52-11"><a href="#cb52-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb52-12"><a href="#cb52-12"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">summary</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + time + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     4257     6307

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.21 1.00     6326     8742
time         -0.00      0.00    -0.01     0.00 1.00    15278    10371

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     7244     9241

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">posterior_summary</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate    Est.Error          Q2.5         Q97.5
b_Intercept          1.939778e-01  0.007941985  1.783368e-01  2.094254e-01
b_time              -2.636000e-03  0.002165885 -6.873653e-03  1.649770e-03
sd_ID__Intercept     5.670837e-02  0.005571281  4.645314e-02  6.833351e-02
sigma                4.731651e-02  0.002933124  4.196708e-02  5.345535e-02
r_ID[6,Intercept]    7.365707e-03  0.025731804 -4.367414e-02  5.821149e-02
r_ID[29,Intercept]  -4.294873e-02  0.029602225 -1.008998e-01  1.533892e-02
r_ID[34,Intercept]  -5.512252e-02  0.029627013 -1.132857e-01  2.337104e-03
r_ID[36,Intercept]  -2.083782e-02  0.029330151 -7.816040e-02  3.704874e-02
r_ID[37,Intercept]   3.067380e-03  0.025565571 -4.731446e-02  5.359054e-02
r_ID[48,Intercept]   2.951456e-02  0.025676401 -2.115828e-02  7.813181e-02
r_ID[53,Intercept]   5.874492e-03  0.029856691 -5.283035e-02  6.536125e-02
r_ID[54,Intercept]   5.006500e-02  0.025608086  4.810638e-05  1.002139e-01
r_ID[58,Intercept]   3.834425e-02  0.025261551 -1.115868e-02  8.767775e-02
r_ID[61,Intercept]  -6.933273e-02  0.030370893 -1.299183e-01 -1.011322e-02
r_ID[66,Intercept]   4.217768e-02  0.025383115 -7.443768e-03  9.188301e-02
r_ID[67,Intercept]   1.257196e-02  0.022487627 -3.205021e-02  5.690846e-02
r_ID[69,Intercept]   1.245007e-02  0.028283827 -4.267907e-02  6.764206e-02
r_ID[71,Intercept]  -1.047749e-01  0.025845371 -1.561854e-01 -5.381433e-02
r_ID[74,Intercept]   1.398717e-02  0.025809763 -3.709893e-02  6.371352e-02
r_ID[75,Intercept]   5.987898e-02  0.029557278  1.383434e-03  1.178726e-01
r_ID[76,Intercept]  -7.260905e-02  0.025454351 -1.221176e-01 -2.262357e-02
r_ID[78,Intercept]   4.727447e-02  0.025351671 -2.274342e-03  9.614280e-02
r_ID[79,Intercept]  -4.332142e-02  0.028666740 -9.985444e-02  1.304572e-02
r_ID[80,Intercept]  -3.338615e-02  0.029541447 -9.094584e-02  2.533545e-02
r_ID[81,Intercept]   4.468282e-02  0.025875362 -6.213619e-03  9.557265e-02
r_ID[82,Intercept]   1.196305e-01  0.023087407  7.458592e-02  1.645894e-01
r_ID[85,Intercept]  -2.679339e-02  0.029353325 -8.403728e-02  3.087414e-02
r_ID[86,Intercept]  -5.671391e-02  0.029230758 -1.136282e-01  3.135088e-04
r_ID[87,Intercept]  -5.975400e-02  0.029549718 -1.178488e-01 -1.269038e-03
r_ID[89,Intercept]  -4.511241e-02  0.025045894 -9.477729e-02  2.825421e-03
r_ID[91,Intercept]  -1.486806e-02  0.024972710 -6.344995e-02  3.439783e-02
r_ID[92,Intercept]   9.563044e-03  0.025025885 -3.959121e-02  5.777742e-02
r_ID[93,Intercept]   5.072168e-02  0.025598349  1.323002e-04  1.005786e-01
r_ID[94,Intercept]  -5.874171e-02  0.025411099 -1.092914e-01 -8.160009e-03
r_ID[96,Intercept]   2.818653e-02  0.029353220 -2.908296e-02  8.658670e-02
r_ID[97,Intercept]   4.945016e-02  0.022988076  4.232164e-03  9.418137e-02
r_ID[98,Intercept]  -4.307168e-02  0.022528705 -8.648116e-02  1.596159e-03
r_ID[99,Intercept]  -6.629387e-03  0.022677651 -5.223577e-02  3.809565e-02
r_ID[101,Intercept]  4.371327e-02  0.025646964 -5.980274e-03  9.505591e-02
r_ID[102,Intercept] -1.811568e-03  0.022695382 -4.594051e-02  4.173026e-02
r_ID[103,Intercept] -2.853653e-02  0.029094790 -8.549110e-02  2.765629e-02
r_ID[104,Intercept] -1.360900e-02  0.028906597 -6.990044e-02  4.352810e-02
r_ID[105,Intercept] -2.286403e-02  0.024966927 -7.191176e-02  2.593100e-02
r_ID[106,Intercept]  5.628244e-03  0.024981489 -4.317290e-02  5.544271e-02
r_ID[110,Intercept] -6.389311e-03  0.024917289 -5.561549e-02  4.297960e-02
r_ID[112,Intercept] -7.805704e-02  0.026077638 -1.279965e-01 -2.638628e-02
r_ID[114,Intercept] -4.684630e-02  0.025042693 -9.589051e-02  2.599923e-03
r_ID[115,Intercept] -3.976937e-02  0.025453806 -8.994426e-02  9.789406e-03
r_ID[116,Intercept] -3.771538e-02  0.025579645 -8.742118e-02  1.232891e-02
r_ID[120,Intercept]  1.178067e-01  0.030028491  5.752295e-02  1.759070e-01
r_ID[122,Intercept] -1.677586e-02  0.025399997 -6.669110e-02  3.353763e-02
r_ID[125,Intercept]  3.746859e-03  0.024943794 -4.546805e-02  5.274863e-02
r_ID[127,Intercept]  2.906199e-02  0.025004532 -2.001918e-02  7.819544e-02
r_ID[129,Intercept] -4.615920e-02  0.029026790 -1.037133e-01  1.100142e-02
r_ID[135,Intercept]  8.640316e-02  0.025686968  3.545103e-02  1.361081e-01
r_ID[136,Intercept]  8.146483e-02  0.025217564  3.175153e-02  1.307380e-01
r_ID[137,Intercept]  7.395952e-02  0.029820192  1.527080e-02  1.319618e-01
r_ID[140,Intercept] -4.801843e-02  0.029336401 -1.062262e-01  9.242976e-03
r_ID[141,Intercept]  8.448914e-04  0.029249215 -5.552762e-02  5.766044e-02
r_ID[142,Intercept] -9.227819e-03  0.028767228 -6.629232e-02  4.712142e-02
r_ID[143,Intercept]  8.738596e-02  0.029511533  2.963071e-02  1.456204e-01
r_ID[144,Intercept] -1.222306e-02  0.028904798 -6.811663e-02  4.430095e-02
r_ID[146,Intercept]  1.445459e-02  0.029339331 -4.333197e-02  7.337600e-02
r_ID[149,Intercept]  2.840905e-02  0.029568929 -2.970203e-02  8.622119e-02
r_ID[150,Intercept]  7.910038e-03  0.028939123 -4.910080e-02  6.439652e-02
r_ID[152,Intercept]  2.220899e-02  0.029334756 -3.506017e-02  8.006732e-02
r_ID[153,Intercept] -3.221761e-02  0.029199198 -8.986935e-02  2.521008e-02
r_ID[155,Intercept] -3.478631e-02  0.029375299 -9.197716e-02  2.408389e-02
r_ID[156,Intercept] -4.411287e-02  0.025175593 -9.328570e-02  5.002319e-03
r_ID[159,Intercept] -5.043752e-02  0.029382589 -1.074262e-01  7.965986e-03
r_ID[160,Intercept] -1.055755e-02  0.029468714 -6.866319e-02  4.713833e-02
r_ID[162,Intercept]  1.637661e-01  0.026439019  1.120089e-01  2.153536e-01
r_ID[163,Intercept] -4.217885e-02  0.028785853 -9.885516e-02  1.447865e-02
r_ID[165,Intercept]  4.545892e-03  0.028671107 -5.099875e-02  6.074066e-02
r_ID[167,Intercept] -4.280409e-02  0.029181786 -9.924144e-02  1.514441e-02
r_ID[169,Intercept]  3.984291e-02  0.029837732 -1.903054e-02  9.779733e-02
r_ID[171,Intercept]  2.788781e-02  0.028920065 -2.942898e-02  8.414554e-02
r_ID[174,Intercept]  5.355908e-02  0.029840769 -4.715711e-03  1.135731e-01
r_ID[182,Intercept] -2.492706e-03  0.029204541 -5.964457e-02  5.556924e-02
r_ID[187,Intercept] -9.319717e-02  0.029464066 -1.509185e-01 -3.504916e-02
r_ID[189,Intercept]  2.339273e-02  0.029181630 -3.322005e-02  8.081186e-02
r_ID[190,Intercept] -4.719972e-02  0.029364728 -1.051792e-01  1.023142e-02
r_ID[193,Intercept]  1.141311e-02  0.029434456 -4.779079e-02  6.914981e-02
r_ID[194,Intercept] -5.174900e-02  0.029157372 -1.086822e-01  4.818244e-03
r_ID[201,Intercept] -2.137385e-03  0.029070034 -5.854123e-02  5.556658e-02
r_ID[204,Intercept]  7.169953e-02  0.029254127  1.368136e-02  1.286256e-01
r_ID[205,Intercept]  1.979349e-03  0.029721402 -5.680617e-02  5.954486e-02
r_ID[208,Intercept]  1.064491e-02  0.029233673 -4.750901e-02  6.694176e-02
r_ID[209,Intercept]  1.683285e-02  0.029066014 -3.975163e-02  7.372425e-02
r_ID[211,Intercept] -3.793040e-02  0.028752381 -9.470966e-02  1.796184e-02
r_ID[214,Intercept]  6.336997e-02  0.029137329  5.668194e-03  1.203804e-01
r_ID[219,Intercept]  3.046883e-02  0.029501518 -2.767228e-02  8.822436e-02
r_ID[222,Intercept] -3.982453e-02  0.029002719 -9.701049e-02  1.709380e-02
r_ID[223,Intercept] -1.668723e-02  0.028616785 -7.312110e-02  3.966887e-02
r_ID[229,Intercept] -3.656376e-02  0.029415896 -9.406351e-02  2.126052e-02
prior_Intercept      3.628099e-03  1.490858166 -2.903607e+00  2.929187e+00
prior_b             -6.182730e-03  1.513961622 -2.962613e+00  3.007680e+00
prior_sigma          9.932137e-01  1.005350563  2.528490e-02  3.682698e+00
prior_sd_ID          1.195759e+00  0.898614921  4.316324e-02  3.350468e+00
lprior              -3.336070e+00  0.002985242 -3.342260e+00 -3.330640e+00
lp__                 2.304329e+02 11.002378103  2.078374e+02  2.510074e+02</code></pre>
</div>
</div>
</section>
<section id="whats-in-our-posterior" class="slide level2">
<h2>whats in our posterior?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">get_variables</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"         "b_time"              "sd_ID__Intercept"   
  [4] "sigma"               "r_ID[6,Intercept]"   "r_ID[29,Intercept]" 
  [7] "r_ID[34,Intercept]"  "r_ID[36,Intercept]"  "r_ID[37,Intercept]" 
 [10] "r_ID[48,Intercept]"  "r_ID[53,Intercept]"  "r_ID[54,Intercept]" 
 [13] "r_ID[58,Intercept]"  "r_ID[61,Intercept]"  "r_ID[66,Intercept]" 
 [16] "r_ID[67,Intercept]"  "r_ID[69,Intercept]"  "r_ID[71,Intercept]" 
 [19] "r_ID[74,Intercept]"  "r_ID[75,Intercept]"  "r_ID[76,Intercept]" 
 [22] "r_ID[78,Intercept]"  "r_ID[79,Intercept]"  "r_ID[80,Intercept]" 
 [25] "r_ID[81,Intercept]"  "r_ID[82,Intercept]"  "r_ID[85,Intercept]" 
 [28] "r_ID[86,Intercept]"  "r_ID[87,Intercept]"  "r_ID[89,Intercept]" 
 [31] "r_ID[91,Intercept]"  "r_ID[92,Intercept]"  "r_ID[93,Intercept]" 
 [34] "r_ID[94,Intercept]"  "r_ID[96,Intercept]"  "r_ID[97,Intercept]" 
 [37] "r_ID[98,Intercept]"  "r_ID[99,Intercept]"  "r_ID[101,Intercept]"
 [40] "r_ID[102,Intercept]" "r_ID[103,Intercept]" "r_ID[104,Intercept]"
 [43] "r_ID[105,Intercept]" "r_ID[106,Intercept]" "r_ID[110,Intercept]"
 [46] "r_ID[112,Intercept]" "r_ID[114,Intercept]" "r_ID[115,Intercept]"
 [49] "r_ID[116,Intercept]" "r_ID[120,Intercept]" "r_ID[122,Intercept]"
 [52] "r_ID[125,Intercept]" "r_ID[127,Intercept]" "r_ID[129,Intercept]"
 [55] "r_ID[135,Intercept]" "r_ID[136,Intercept]" "r_ID[137,Intercept]"
 [58] "r_ID[140,Intercept]" "r_ID[141,Intercept]" "r_ID[142,Intercept]"
 [61] "r_ID[143,Intercept]" "r_ID[144,Intercept]" "r_ID[146,Intercept]"
 [64] "r_ID[149,Intercept]" "r_ID[150,Intercept]" "r_ID[152,Intercept]"
 [67] "r_ID[153,Intercept]" "r_ID[155,Intercept]" "r_ID[156,Intercept]"
 [70] "r_ID[159,Intercept]" "r_ID[160,Intercept]" "r_ID[162,Intercept]"
 [73] "r_ID[163,Intercept]" "r_ID[165,Intercept]" "r_ID[167,Intercept]"
 [76] "r_ID[169,Intercept]" "r_ID[171,Intercept]" "r_ID[174,Intercept]"
 [79] "r_ID[182,Intercept]" "r_ID[187,Intercept]" "r_ID[189,Intercept]"
 [82] "r_ID[190,Intercept]" "r_ID[193,Intercept]" "r_ID[194,Intercept]"
 [85] "r_ID[201,Intercept]" "r_ID[204,Intercept]" "r_ID[205,Intercept]"
 [88] "r_ID[208,Intercept]" "r_ID[209,Intercept]" "r_ID[211,Intercept]"
 [91] "r_ID[214,Intercept]" "r_ID[219,Intercept]" "r_ID[222,Intercept]"
 [94] "r_ID[223,Intercept]" "r_ID[229,Intercept]" "prior_Intercept"    
 [97] "prior_b"             "prior_sigma"         "prior_sd_ID"        
[100] "lprior"              "lp__"                "accept_stat__"      
[103] "treedepth__"         "stepsize__"          "divergent__"        
[106] "n_leapfrog__"        "energy__"           </code></pre>
</div>
</div>
</section>
<section id="introducing-random-slopes" class="slide level2">
<h2>Introducing random slopes</h2>
<ul>
<li><p>MLMs “learn” from other units as we saw with random effects</p></li>
<li><p>MLMs can also “learn” about one parameter from another parameter</p></li>
<li><p>We do this through correlated features or parameters. We create this correlated features through introducing random slopes, which pools information across groups</p></li>
<li><p>This is another advantage of “keep it maximal.” Better estimates of intercepts rather than just fitting an intercept only model</p></li>
</ul>
</section>
<section id="random-slopes" class="slide level2">
<h2>Random slopes</h2>
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \gamma_{01}G_{j} +   U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10} + \gamma_{11}G_{j} + U_{1j}\]</span></p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim \mathcal{N} \begin{pmatrix}
  0,      \tau_{00}^{2} &amp; \tau_{01}\\
  0,  \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
</section>
<section id="correlated-features" class="slide level2">
<h2>correlated features</h2>
<ul>
<li><p>Modeling the joint population of intercepts and slopes, which means by modeling their covariance. We will use joint multivariate Gaussian distribution b/c it is max entropy distribution</p></li>
<li><p>Rather than a 1 dimension prior we will be putting on a two dimension prior.</p></li>
<li><p>Can scale into &gt; 2d depending on how many random effects you have</p></li>
</ul>
</section>
<section id="random-slopes-1" class="slide level2">
<h2>Random slopes</h2>
<p><span class="math display">\[y_i \sim \text{Normal}(\mu, \sigma)\]</span> <span class="math display">\[\mu_i = \beta_{0j} + \beta_{1j}X_{ij}\]</span> <span class="math display">\[(\beta_{0j}, \beta_{1j}) \sim \text{MVNormal}  ([\beta_0, \beta_1], \Sigma)\]</span></p>
<p><span class="math display">\[\Sigma =
\left(\begin{array}{cc}
\sigma_{\beta_0}&amp;0\\
0&amp;\sigma_{\beta_1}
\end{array}\right)R
\left(\begin{array}{cc}
\sigma_{\beta_0}&amp;0\\
0&amp;\sigma_{\beta_1}
\end{array}\right)\]</span> <span class="math display">\[\beta_0 \sim \text{Normal}(0, 1)\]</span></p>
<p><span class="math display">\[\beta_1 \sim \text{Normal}(0, 1)\]</span> <span class="math display">\[\sigma_{\beta_0} \sim \text{Exponential}(1)\]</span> <span class="math display">\[\sigma_{\beta_1} \sim \text{Exponential}(1)\]</span> <span class="math display">\[\sigma \sim \text{Exponential}(1)\]</span> <span class="math display">\[R \sim \text{LKJcorr(2)}\]</span></p>
</section>
<section class="slide level2">

<p>where Σ is the covariance matrix</p>
<p><span class="math display">\[\Sigma =
\left(\begin{array}{cc}
\sigma^2_{\beta_0}&amp;\sigma_{\beta_0}\sigma_{\beta_1}\rho\\
\sigma_{\beta_0}\sigma_{\beta_1}\rho&amp;\sigma^2_{\beta_1}
\end{array}\right)\]</span></p>
<p>and R is the correlation matrix R = <span class="math inline">\(\begin{bmatrix} 1 &amp; \rho \\ \rho &amp; 1 \end{bmatrix}\)</span>.</p>
<p>With more random effects, this matrix expands.</p>
</section>
<section id="lkj-1-parameter-correlation-prior" class="slide level2">
<h2>lkj 1 parameter correlation prior</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb59-2"><a href="#cb59-2"></a></span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="fu">expand.grid</span>(</span>
<span id="cb59-4"><a href="#cb59-4"></a>  <span class="at">eta =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb59-5"><a href="#cb59-5"></a>  <span class="at">K =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(<span class="fu">ordered</span>(eta)), <span class="at">dist =</span> <span class="st">"lkjcorr_marginal"</span>, <span class="at">arg1 =</span> K, <span class="at">arg2 =</span> eta)) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8"></a>  <span class="fu">stat_dist_slab</span>() <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="fu">paste0</span>(K, <span class="st">"x"</span>, K)) <span class="sc">+</span></span>
<span id="cb59-10"><a href="#cb59-10"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-11"><a href="#cb59-11"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb59-12"><a href="#cb59-12"></a>      <span class="st">"LKJ(eta) prior on different matrix sizes:</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb59-13"><a href="#cb59-13"></a>    ),</span>
<span id="cb59-14"><a href="#cb59-14"></a>    <span class="at">y =</span> <span class="st">"eta"</span>,</span>
<span id="cb59-15"><a href="#cb59-15"></a>    <span class="at">x =</span> <span class="st">"Marginal correlation"</span></span>
<span id="cb59-16"><a href="#cb59-16"></a>  ) <span class="sc">+</span></span>
<span id="cb59-17"><a href="#cb59-17"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-46-1.png" width="960" class="r-stretch"></section>
<section id="multivariate-distributions" class="slide level2">
<h2>Multivariate distributions</h2>
<p>r = 0. Knowing about 1 parameter doesn’t tell you anything about the other.</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-47-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>r = .5</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-48-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>r = .8</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-49-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">get_prior</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb60-2"><a href="#cb60-2"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> ID),</span>
<span id="cb60-3"><a href="#cb60-3"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class      coef group resp dpar nlpar lb ub
                 (flat)         b                                      
                 (flat)         b      time                            
                 lkj(1)       cor                                      
                 lkj(1)       cor              ID                      
 student_t(3, 0.2, 2.5) Intercept                                      
   student_t(3, 0, 2.5)        sd                                  0   
   student_t(3, 0, 2.5)        sd              ID                  0   
   student_t(3, 0, 2.5)        sd Intercept    ID                  0   
   student_t(3, 0, 2.5)        sd      time    ID                  0   
   student_t(3, 0, 2.5)     sigma                                  0   
       source
      default
 (vectorized)
      default
 (vectorized)
      default
      default
 (vectorized)
 (vectorized)
 (vectorized)
      default</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Information needed to learn about parameters can be ranked:</p>
<ol type="1">
<li>Means are easy</li>
<li>SDs are medium</li>
<li>Correlations are hard</li>
</ol>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>mlm<span class="fl">.4</span> <span class="ot">&lt;-</span> </span>
<span id="cb62-2"><a href="#cb62-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb62-3"><a href="#cb62-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> ID),</span>
<span id="cb62-4"><a href="#cb62-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb62-5"><a href="#cb62-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb62-6"><a href="#cb62-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb62-7"><a href="#cb62-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> time, <span class="at">group =</span> ID), </span>
<span id="cb62-8"><a href="#cb62-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb62-9"><a href="#cb62-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb62-10"><a href="#cb62-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb62-11"><a href="#cb62-11"></a>      <span class="at">file =</span> <span class="st">"mlm.4"</span>,</span>
<span id="cb62-12"><a href="#cb62-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb62-13"><a href="#cb62-13"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">summary</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + time + (1 + time | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)           0.06      0.01     0.05     0.07 1.00     3680     5470
sd(time)                0.00      0.00     0.00     0.01 1.00     1392     1534
cor(Intercept,time)    -0.09      0.40    -0.78     0.74 1.00    10248     7901

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.21 1.00     4864     5920
time         -0.00      0.00    -0.01     0.00 1.00    10374     9299

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     3584     4201

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>p.mlm4 <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(mlm<span class="fl">.4</span>)</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb65-3"><a href="#cb65-3"></a></span>
<span id="cb65-4"><a href="#cb65-4"></a>r_2 <span class="ot">&lt;-</span> </span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="fu">rlkjcorr</span>(<span class="dv">1000</span>, <span class="at">K =</span> <span class="dv">2</span>, <span class="at">eta =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb65-7"><a href="#cb65-7"></a></span>
<span id="cb65-8"><a href="#cb65-8"></a>p.mlm4 <span class="sc">%&gt;%</span></span>
<span id="cb65-9"><a href="#cb65-9"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> r_2, <span class="fu">aes</span>(<span class="at">x =</span> V2),</span>
<span id="cb65-11"><a href="#cb65-11"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> cor_ID__Intercept__time),</span>
<span id="cb65-13"><a href="#cb65-13"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">1.1</span>, </span>
<span id="cb65-15"><a href="#cb65-15"></a>           <span class="at">label =</span> <span class="st">"posterior"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">family =</span> <span class="st">"Courier"</span>) <span class="sc">+</span></span>
<span id="cb65-16"><a href="#cb65-16"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> .<span class="dv">2</span>, <span class="at">y =</span> <span class="fl">1.35</span>, </span>
<span id="cb65-17"><a href="#cb65-17"></a>           <span class="at">label =</span> <span class="st">"prior"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">family =</span> <span class="st">"Courier"</span>) <span class="sc">+</span></span>
<span id="cb65-18"><a href="#cb65-18"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb65-19"><a href="#cb65-19"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Correlation between intercepts</span><span class="sc">\n</span><span class="st">and slopes, prior and posterior"</span>,</span>
<span id="cb65-20"><a href="#cb65-20"></a>  <span class="at">x =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-53-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>partially_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.4</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb66-4"><a href="#cb66-4"></a></span>
<span id="cb66-5"><a href="#cb66-5"></a></span>
<span id="cb66-6"><a href="#cb66-6"></a>un_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb66-7"><a href="#cb66-7"></a>  mlm <span class="sc">%&gt;%</span></span>
<span id="cb66-8"><a href="#cb66-8"></a>  <span class="fu">group_by</span>(ID, time) <span class="sc">%&gt;%</span></span>
<span id="cb66-9"><a href="#cb66-9"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(CON)) <span class="sc">%&gt;%</span></span>
<span id="cb66-10"><a href="#cb66-10"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> time, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb66-11"><a href="#cb66-11"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb66-12"><a href="#cb66-12"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb66-13"><a href="#cb66-13"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb66-14"><a href="#cb66-14"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-15"><a href="#cb66-15"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-16"><a href="#cb66-16"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb66-17"><a href="#cb66-17"></a></span>
<span id="cb66-18"><a href="#cb66-18"></a>params <span class="ot">&lt;-</span></span>
<span id="cb66-19"><a href="#cb66-19"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb66-20"><a href="#cb66-20"></a>  <span class="fu">bind_rows</span>(partially_pooled_params, un_pooled_params) <span class="sc">%&gt;%</span></span>
<span id="cb66-21"><a href="#cb66-21"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb66-22"><a href="#cb66-22"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb66-23"><a href="#cb66-23"></a></span>
<span id="cb66-24"><a href="#cb66-24"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb66-25"><a href="#cb66-25"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb66-26"><a href="#cb66-26"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-27"><a href="#cb66-27"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-28"><a href="#cb66-28"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-29"><a href="#cb66-29"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-30"><a href="#cb66-30"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-31"><a href="#cb66-31"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">6</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-32"><a href="#cb66-32"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-33"><a href="#cb66-33"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">8</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-34"><a href="#cb66-34"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-35"><a href="#cb66-35"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> .<span class="dv">99</span>,  <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb66-36"><a href="#cb66-36"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb66-37"><a href="#cb66-37"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb66-38"><a href="#cb66-38"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb66-39"><a href="#cb66-39"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb66-40"><a href="#cb66-40"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(params<span class="sc">$</span>time),</span>
<span id="cb66-41"><a href="#cb66-41"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(params<span class="sc">$</span>Intercept))</span>
<span id="cb66-42"><a href="#cb66-42"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-54-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">get_variables</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"             "b_time"                 
  [3] "sd_ID__Intercept"        "sd_ID__time"            
  [5] "cor_ID__Intercept__time" "sigma"                  
  [7] "r_ID[6,Intercept]"       "r_ID[29,Intercept]"     
  [9] "r_ID[34,Intercept]"      "r_ID[36,Intercept]"     
 [11] "r_ID[37,Intercept]"      "r_ID[48,Intercept]"     
 [13] "r_ID[53,Intercept]"      "r_ID[54,Intercept]"     
 [15] "r_ID[58,Intercept]"      "r_ID[61,Intercept]"     
 [17] "r_ID[66,Intercept]"      "r_ID[67,Intercept]"     
 [19] "r_ID[69,Intercept]"      "r_ID[71,Intercept]"     
 [21] "r_ID[74,Intercept]"      "r_ID[75,Intercept]"     
 [23] "r_ID[76,Intercept]"      "r_ID[78,Intercept]"     
 [25] "r_ID[79,Intercept]"      "r_ID[80,Intercept]"     
 [27] "r_ID[81,Intercept]"      "r_ID[82,Intercept]"     
 [29] "r_ID[85,Intercept]"      "r_ID[86,Intercept]"     
 [31] "r_ID[87,Intercept]"      "r_ID[89,Intercept]"     
 [33] "r_ID[91,Intercept]"      "r_ID[92,Intercept]"     
 [35] "r_ID[93,Intercept]"      "r_ID[94,Intercept]"     
 [37] "r_ID[96,Intercept]"      "r_ID[97,Intercept]"     
 [39] "r_ID[98,Intercept]"      "r_ID[99,Intercept]"     
 [41] "r_ID[101,Intercept]"     "r_ID[102,Intercept]"    
 [43] "r_ID[103,Intercept]"     "r_ID[104,Intercept]"    
 [45] "r_ID[105,Intercept]"     "r_ID[106,Intercept]"    
 [47] "r_ID[110,Intercept]"     "r_ID[112,Intercept]"    
 [49] "r_ID[114,Intercept]"     "r_ID[115,Intercept]"    
 [51] "r_ID[116,Intercept]"     "r_ID[120,Intercept]"    
 [53] "r_ID[122,Intercept]"     "r_ID[125,Intercept]"    
 [55] "r_ID[127,Intercept]"     "r_ID[129,Intercept]"    
 [57] "r_ID[135,Intercept]"     "r_ID[136,Intercept]"    
 [59] "r_ID[137,Intercept]"     "r_ID[140,Intercept]"    
 [61] "r_ID[141,Intercept]"     "r_ID[142,Intercept]"    
 [63] "r_ID[143,Intercept]"     "r_ID[144,Intercept]"    
 [65] "r_ID[146,Intercept]"     "r_ID[149,Intercept]"    
 [67] "r_ID[150,Intercept]"     "r_ID[152,Intercept]"    
 [69] "r_ID[153,Intercept]"     "r_ID[155,Intercept]"    
 [71] "r_ID[156,Intercept]"     "r_ID[159,Intercept]"    
 [73] "r_ID[160,Intercept]"     "r_ID[162,Intercept]"    
 [75] "r_ID[163,Intercept]"     "r_ID[165,Intercept]"    
 [77] "r_ID[167,Intercept]"     "r_ID[169,Intercept]"    
 [79] "r_ID[171,Intercept]"     "r_ID[174,Intercept]"    
 [81] "r_ID[182,Intercept]"     "r_ID[187,Intercept]"    
 [83] "r_ID[189,Intercept]"     "r_ID[190,Intercept]"    
 [85] "r_ID[193,Intercept]"     "r_ID[194,Intercept]"    
 [87] "r_ID[201,Intercept]"     "r_ID[204,Intercept]"    
 [89] "r_ID[205,Intercept]"     "r_ID[208,Intercept]"    
 [91] "r_ID[209,Intercept]"     "r_ID[211,Intercept]"    
 [93] "r_ID[214,Intercept]"     "r_ID[219,Intercept]"    
 [95] "r_ID[222,Intercept]"     "r_ID[223,Intercept]"    
 [97] "r_ID[229,Intercept]"     "r_ID[6,time]"           
 [99] "r_ID[29,time]"           "r_ID[34,time]"          
[101] "r_ID[36,time]"           "r_ID[37,time]"          
[103] "r_ID[48,time]"           "r_ID[53,time]"          
[105] "r_ID[54,time]"           "r_ID[58,time]"          
[107] "r_ID[61,time]"           "r_ID[66,time]"          
[109] "r_ID[67,time]"           "r_ID[69,time]"          
[111] "r_ID[71,time]"           "r_ID[74,time]"          
[113] "r_ID[75,time]"           "r_ID[76,time]"          
[115] "r_ID[78,time]"           "r_ID[79,time]"          
[117] "r_ID[80,time]"           "r_ID[81,time]"          
[119] "r_ID[82,time]"           "r_ID[85,time]"          
[121] "r_ID[86,time]"           "r_ID[87,time]"          
[123] "r_ID[89,time]"           "r_ID[91,time]"          
[125] "r_ID[92,time]"           "r_ID[93,time]"          
[127] "r_ID[94,time]"           "r_ID[96,time]"          
[129] "r_ID[97,time]"           "r_ID[98,time]"          
[131] "r_ID[99,time]"           "r_ID[101,time]"         
[133] "r_ID[102,time]"          "r_ID[103,time]"         
[135] "r_ID[104,time]"          "r_ID[105,time]"         
[137] "r_ID[106,time]"          "r_ID[110,time]"         
[139] "r_ID[112,time]"          "r_ID[114,time]"         
[141] "r_ID[115,time]"          "r_ID[116,time]"         
[143] "r_ID[120,time]"          "r_ID[122,time]"         
[145] "r_ID[125,time]"          "r_ID[127,time]"         
[147] "r_ID[129,time]"          "r_ID[135,time]"         
[149] "r_ID[136,time]"          "r_ID[137,time]"         
[151] "r_ID[140,time]"          "r_ID[141,time]"         
[153] "r_ID[142,time]"          "r_ID[143,time]"         
[155] "r_ID[144,time]"          "r_ID[146,time]"         
[157] "r_ID[149,time]"          "r_ID[150,time]"         
[159] "r_ID[152,time]"          "r_ID[153,time]"         
[161] "r_ID[155,time]"          "r_ID[156,time]"         
[163] "r_ID[159,time]"          "r_ID[160,time]"         
[165] "r_ID[162,time]"          "r_ID[163,time]"         
[167] "r_ID[165,time]"          "r_ID[167,time]"         
[169] "r_ID[169,time]"          "r_ID[171,time]"         
[171] "r_ID[174,time]"          "r_ID[182,time]"         
[173] "r_ID[187,time]"          "r_ID[189,time]"         
[175] "r_ID[190,time]"          "r_ID[193,time]"         
[177] "r_ID[194,time]"          "r_ID[201,time]"         
[179] "r_ID[204,time]"          "r_ID[205,time]"         
[181] "r_ID[208,time]"          "r_ID[209,time]"         
[183] "r_ID[211,time]"          "r_ID[214,time]"         
[185] "r_ID[219,time]"          "r_ID[222,time]"         
[187] "r_ID[223,time]"          "r_ID[229,time]"         
[189] "lprior"                  "lp__"                   
[191] "accept_stat__"           "treedepth__"            
[193] "stepsize__"              "divergent__"            
[195] "n_leapfrog__"            "energy__"               </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID,term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,184,000 × 6
# Groups:   ID, term [182]
      ID term         r_ID .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6 Intercept -0.0305      1          1     1
 2     6 Intercept  0.0222      1          2     2
 3     6 Intercept  0.0429      1          3     3
 4     6 Intercept  0.0735      1          4     4
 5     6 Intercept  0.0423      1          5     5
 6     6 Intercept -0.0271      1          6     6
 7     6 Intercept  0.0114      1          7     7
 8     6 Intercept  0.0146      1          8     8
 9     6 Intercept  0.0356      1          9     9
10     6 Intercept -0.0478      1         10    10
# ℹ 2,183,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="fu">spread_draws</span>(b_time, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="#cb71-4"></a>  <span class="fu">mutate</span>(<span class="at">person_t =</span> b_time <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="#cb71-5"></a> <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 14
# Groups:   ID [91]
      ID term    b_time b_time.lower b_time.upper     r_ID r_ID.lower r_ID.upper
   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1     6 time  -0.00285     -0.00733      0.00148  2.26e-5   -0.00993    0.0104 
 2    29 time  -0.00285     -0.00733      0.00148 -3.77e-4   -0.0135     0.00798
 3    34 time  -0.00285     -0.00733      0.00148 -6.00e-4   -0.0150     0.00669
 4    36 time  -0.00285     -0.00733      0.00148  1.38e-4   -0.00916    0.0130 
 5    37 time  -0.00285     -0.00733      0.00148 -2.17e-4   -0.0123     0.00748
 6    48 time  -0.00285     -0.00733      0.00148 -2.82e-5   -0.0108     0.00890
 7    53 time  -0.00285     -0.00733      0.00148 -2.33e-4   -0.0128     0.00789
 8    54 time  -0.00285     -0.00733      0.00148  2.22e-4   -0.00844    0.0112 
 9    58 time  -0.00285     -0.00733      0.00148  5.06e-4   -0.00714    0.0159 
10    61 time  -0.00285     -0.00733      0.00148 -5.52e-5   -0.0103     0.0104 
# ℹ 81 more rows
# ℹ 6 more variables: person_t &lt;dbl&gt;, person_t.lower &lt;dbl&gt;,
#   person_t.upper &lt;dbl&gt;, .width &lt;dbl&gt;, .point &lt;chr&gt;, .interval &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="fu">spread_draws</span>(b_time, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb73-4"><a href="#cb73-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_time <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6"></a>  <span class="fu">geom_pointinterval</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-58-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>mlm<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>, <span class="st">"loo"</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a>mlm<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.2</span>, <span class="st">"loo"</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="fu">loo_compare</span>(mlm<span class="fl">.1</span>, mlm<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      elpd_diff se_diff
mlm.1   0.0       0.0  
mlm.2 -58.1       8.8  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb76-2"><a href="#cb76-2"></a>esm <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/bayes2022/main/static/Lectures/esm_w1_RENAMED.csv"</span>)</span>
<span id="cb76-3"><a href="#cb76-3"></a>esm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,540 × 89
    ...1 esm.IDnum.w1 esm.PRO01.w1 esm.PRO02.w1 esm.PRO03.w1
   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1     1        10549           17            1            1
 2     2        10547           57            1            1
 3     3        10547           57            1            1
 4     4        10539           51            1            1
 5     5        10547           57            1            1
 6     6        10549           17            1            1
 7     7        10539           51            1            1
 8     8        10549           17            1            1
 9     9        10547           57            1            1
10    10        10526           36            1            1
# ℹ 11,530 more rows
# ℹ 84 more variables: esm.startDateTime.w1 &lt;chr&gt;, esm.PRO04.w1 &lt;dbl&gt;,
#   esm.PRO05.w1 &lt;dbl&gt;, esm.PRO06.w1 &lt;dbl&gt;, esm.PRO07.w1 &lt;dbl&gt;,
#   esm.endDateTime.w1 &lt;chr&gt;, esm.OR.w1 &lt;chr&gt;, esm.NQ11.w1 &lt;dbl&gt;,
#   esm.NQ12.w1 &lt;dbl&gt;, esm.EXT.w1 &lt;dbl&gt;, esm.AGR.w1 &lt;dbl&gt;, esm.CON.w1 &lt;dbl&gt;,
#   esm.NEU.w1 &lt;dbl&gt;, `esm.NQ11+1.w1` &lt;dbl&gt;, `esm.NQ12+1.w1` &lt;dbl&gt;,
#   `esm.EXT+1.w1` &lt;dbl&gt;, `esm.AGR+1.w1` &lt;dbl&gt;, `esm.CON+1.w1` &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>esm<span class="sc">$</span>PA <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.NQ11.w1</span>
<span id="cb78-2"><a href="#cb78-2"></a>esm<span class="sc">$</span>W.other <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.ST04.w1</span>
<span id="cb78-3"><a href="#cb78-3"></a>esm<span class="sc">$</span>ID <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.IDnum.w1</span>
<span id="cb78-4"><a href="#cb78-4"></a></span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="fu">library</span>(lme4)</span>
<span id="cb78-6"><a href="#cb78-6"></a>test <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">|</span> ID), <span class="at">data =</span> esm )</span>
<span id="cb78-7"><a href="#cb78-7"></a><span class="fu">summary</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: PA ~ 1 + W.other + (1 + W.other | ID)
   Data: esm

REML criterion at convergence: 24523.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5746 -0.6263  0.0180  0.6978  2.8135 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 ID       (Intercept) 0.25954  0.5094        
          W.other     0.03266  0.1807   -0.56
 Residual             0.72255  0.8500        
Number of obs: 9461, groups:  ID, 364

Fixed effects:
            Estimate Std. Error t value
(Intercept)  3.15230    0.03538   89.09
W.other      0.31802    0.02612   12.18

Correlation of Fixed Effects:
        (Intr)
W.other -0.686</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>mlm<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb80-2"><a href="#cb80-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb80-3"><a href="#cb80-3"></a>      PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">|</span> ID),</span>
<span id="cb80-4"><a href="#cb80-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb80-5"><a href="#cb80-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb80-6"><a href="#cb80-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb80-7"><a href="#cb80-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> W.other, <span class="at">group =</span> ID), </span>
<span id="cb80-8"><a href="#cb80-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb80-9"><a href="#cb80-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">10</span>), <span class="at">class =</span> cor)),</span>
<span id="cb80-10"><a href="#cb80-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb80-11"><a href="#cb80-11"></a>      <span class="at">sample_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-12"><a href="#cb80-12"></a>      <span class="at">file =</span> <span class="st">"mlm.5"</span>,</span>
<span id="cb80-13"><a href="#cb80-13"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb80-14"><a href="#cb80-14"></a>      <span class="at">data =</span> esm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>747 parameters in our posterior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">get_variables</span>(mlm<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"                "b_W.other"                 
  [3] "sd_ID__Intercept"           "sd_ID__W.other"            
  [5] "cor_ID__Intercept__W.other" "sigma"                     
  [7] "r_ID[81,Intercept]"         "r_ID[86,Intercept]"        
  [9] "r_ID[87,Intercept]"         "r_ID[88,Intercept]"        
 [11] "r_ID[89,Intercept]"         "r_ID[90,Intercept]"        
 [13] "r_ID[91,Intercept]"         "r_ID[92,Intercept]"        
 [15] "r_ID[93,Intercept]"         "r_ID[94,Intercept]"        
 [17] "r_ID[95,Intercept]"         "r_ID[97,Intercept]"        
 [19] "r_ID[98,Intercept]"         "r_ID[100,Intercept]"       
 [21] "r_ID[101,Intercept]"        "r_ID[102,Intercept]"       
 [23] "r_ID[104,Intercept]"        "r_ID[10105,Intercept]"     
 [25] "r_ID[10106,Intercept]"      "r_ID[10107,Intercept]"     
 [27] "r_ID[10108,Intercept]"      "r_ID[10109,Intercept]"     
 [29] "r_ID[10110,Intercept]"      "r_ID[10111,Intercept]"     
 [31] "r_ID[10112,Intercept]"      "r_ID[10113,Intercept]"     
 [33] "r_ID[10114,Intercept]"      "r_ID[10116,Intercept]"     
 [35] "r_ID[10117,Intercept]"      "r_ID[10118,Intercept]"     
 [37] "r_ID[10121,Intercept]"      "r_ID[10122,Intercept]"     
 [39] "r_ID[10123,Intercept]"      "r_ID[10124,Intercept]"     
 [41] "r_ID[10125,Intercept]"      "r_ID[10126,Intercept]"     
 [43] "r_ID[10127,Intercept]"      "r_ID[10128,Intercept]"     
 [45] "r_ID[10129,Intercept]"      "r_ID[10130,Intercept]"     
 [47] "r_ID[10131,Intercept]"      "r_ID[10132,Intercept]"     
 [49] "r_ID[10133,Intercept]"      "r_ID[10134,Intercept]"     
 [51] "r_ID[10136,Intercept]"      "r_ID[10137,Intercept]"     
 [53] "r_ID[10138,Intercept]"      "r_ID[10139,Intercept]"     
 [55] "r_ID[10141,Intercept]"      "r_ID[10143,Intercept]"     
 [57] "r_ID[10144,Intercept]"      "r_ID[10145,Intercept]"     
 [59] "r_ID[10147,Intercept]"      "r_ID[10148,Intercept]"     
 [61] "r_ID[10149,Intercept]"      "r_ID[10150,Intercept]"     
 [63] "r_ID[10151,Intercept]"      "r_ID[10153,Intercept]"     
 [65] "r_ID[10154,Intercept]"      "r_ID[10155,Intercept]"     
 [67] "r_ID[10157,Intercept]"      "r_ID[10158,Intercept]"     
 [69] "r_ID[10159,Intercept]"      "r_ID[10160,Intercept]"     
 [71] "r_ID[10161,Intercept]"      "r_ID[10162,Intercept]"     
 [73] "r_ID[10164,Intercept]"      "r_ID[10166,Intercept]"     
 [75] "r_ID[10167,Intercept]"      "r_ID[10171,Intercept]"     
 [77] "r_ID[10172,Intercept]"      "r_ID[10173,Intercept]"     
 [79] "r_ID[10174,Intercept]"      "r_ID[10175,Intercept]"     
 [81] "r_ID[10176,Intercept]"      "r_ID[10177,Intercept]"     
 [83] "r_ID[10178,Intercept]"      "r_ID[10180,Intercept]"     
 [85] "r_ID[10181,Intercept]"      "r_ID[10184,Intercept]"     
 [87] "r_ID[10185,Intercept]"      "r_ID[10186,Intercept]"     
 [89] "r_ID[10187,Intercept]"      "r_ID[10188,Intercept]"     
 [91] "r_ID[10190,Intercept]"      "r_ID[10192,Intercept]"     
 [93] "r_ID[10193,Intercept]"      "r_ID[10194,Intercept]"     
 [95] "r_ID[10195,Intercept]"      "r_ID[10196,Intercept]"     
 [97] "r_ID[10197,Intercept]"      "r_ID[10198,Intercept]"     
 [99] "r_ID[10199,Intercept]"      "r_ID[10200,Intercept]"     
[101] "r_ID[10201,Intercept]"      "r_ID[10202,Intercept]"     
[103] "r_ID[10203,Intercept]"      "r_ID[10204,Intercept]"     
[105] "r_ID[10205,Intercept]"      "r_ID[10206,Intercept]"     
[107] "r_ID[10207,Intercept]"      "r_ID[10208,Intercept]"     
[109] "r_ID[10210,Intercept]"      "r_ID[10211,Intercept]"     
[111] "r_ID[10212,Intercept]"      "r_ID[10213,Intercept]"     
[113] "r_ID[10214,Intercept]"      "r_ID[10215,Intercept]"     
[115] "r_ID[10216,Intercept]"      "r_ID[10217,Intercept]"     
[117] "r_ID[10219,Intercept]"      "r_ID[10220,Intercept]"     
[119] "r_ID[10221,Intercept]"      "r_ID[10222,Intercept]"     
[121] "r_ID[10223,Intercept]"      "r_ID[10226,Intercept]"     
[123] "r_ID[10227,Intercept]"      "r_ID[10228,Intercept]"     
[125] "r_ID[10229,Intercept]"      "r_ID[10230,Intercept]"     
[127] "r_ID[10231,Intercept]"      "r_ID[10232,Intercept]"     
[129] "r_ID[10233,Intercept]"      "r_ID[10234,Intercept]"     
[131] "r_ID[10236,Intercept]"      "r_ID[10237,Intercept]"     
[133] "r_ID[10238,Intercept]"      "r_ID[10239,Intercept]"     
[135] "r_ID[10240,Intercept]"      "r_ID[10241,Intercept]"     
[137] "r_ID[10242,Intercept]"      "r_ID[10243,Intercept]"     
[139] "r_ID[10244,Intercept]"      "r_ID[10245,Intercept]"     
[141] "r_ID[10247,Intercept]"      "r_ID[10248,Intercept]"     
[143] "r_ID[10249,Intercept]"      "r_ID[10250,Intercept]"     
[145] "r_ID[10251,Intercept]"      "r_ID[10253,Intercept]"     
[147] "r_ID[10255,Intercept]"      "r_ID[10256,Intercept]"     
[149] "r_ID[10258,Intercept]"      "r_ID[10259,Intercept]"     
[151] "r_ID[10260,Intercept]"      "r_ID[10266,Intercept]"     
[153] "r_ID[10267,Intercept]"      "r_ID[10268,Intercept]"     
[155] "r_ID[10269,Intercept]"      "r_ID[10270,Intercept]"     
[157] "r_ID[10271,Intercept]"      "r_ID[10272,Intercept]"     
[159] "r_ID[10273,Intercept]"      "r_ID[10274,Intercept]"     
[161] "r_ID[10275,Intercept]"      "r_ID[10276,Intercept]"     
[163] "r_ID[10277,Intercept]"      "r_ID[10280,Intercept]"     
[165] "r_ID[10281,Intercept]"      "r_ID[10285,Intercept]"     
[167] "r_ID[10286,Intercept]"      "r_ID[10287,Intercept]"     
[169] "r_ID[10288,Intercept]"      "r_ID[10289,Intercept]"     
[171] "r_ID[10290,Intercept]"      "r_ID[10291,Intercept]"     
[173] "r_ID[10292,Intercept]"      "r_ID[10293,Intercept]"     
[175] "r_ID[10294,Intercept]"      "r_ID[10295,Intercept]"     
[177] "r_ID[10296,Intercept]"      "r_ID[10299,Intercept]"     
[179] "r_ID[10301,Intercept]"      "r_ID[10304,Intercept]"     
[181] "r_ID[10305,Intercept]"      "r_ID[10308,Intercept]"     
[183] "r_ID[10309,Intercept]"      "r_ID[10310,Intercept]"     
[185] "r_ID[10311,Intercept]"      "r_ID[10312,Intercept]"     
[187] "r_ID[10313,Intercept]"      "r_ID[10314,Intercept]"     
[189] "r_ID[10315,Intercept]"      "r_ID[10316,Intercept]"     
[191] "r_ID[10317,Intercept]"      "r_ID[10318,Intercept]"     
[193] "r_ID[10319,Intercept]"      "r_ID[10320,Intercept]"     
[195] "r_ID[10322,Intercept]"      "r_ID[10323,Intercept]"     
[197] "r_ID[10324,Intercept]"      "r_ID[10325,Intercept]"     
[199] "r_ID[10326,Intercept]"      "r_ID[10327,Intercept]"     
[201] "r_ID[10328,Intercept]"      "r_ID[10329,Intercept]"     
[203] "r_ID[10330,Intercept]"      "r_ID[10331,Intercept]"     
[205] "r_ID[10332,Intercept]"      "r_ID[10333,Intercept]"     
[207] "r_ID[10335,Intercept]"      "r_ID[10336,Intercept]"     
[209] "r_ID[10337,Intercept]"      "r_ID[10338,Intercept]"     
[211] "r_ID[10340,Intercept]"      "r_ID[10341,Intercept]"     
[213] "r_ID[10342,Intercept]"      "r_ID[10343,Intercept]"     
[215] "r_ID[10345,Intercept]"      "r_ID[10347,Intercept]"     
[217] "r_ID[10348,Intercept]"      "r_ID[10349,Intercept]"     
[219] "r_ID[10350,Intercept]"      "r_ID[10351,Intercept]"     
[221] "r_ID[10352,Intercept]"      "r_ID[10353,Intercept]"     
[223] "r_ID[10354,Intercept]"      "r_ID[10357,Intercept]"     
[225] "r_ID[10358,Intercept]"      "r_ID[10359,Intercept]"     
[227] "r_ID[10360,Intercept]"      "r_ID[10361,Intercept]"     
[229] "r_ID[10363,Intercept]"      "r_ID[10364,Intercept]"     
[231] "r_ID[10365,Intercept]"      "r_ID[10366,Intercept]"     
[233] "r_ID[10367,Intercept]"      "r_ID[10368,Intercept]"     
[235] "r_ID[10369,Intercept]"      "r_ID[10370,Intercept]"     
[237] "r_ID[10371,Intercept]"      "r_ID[10372,Intercept]"     
[239] "r_ID[10373,Intercept]"      "r_ID[10374,Intercept]"     
[241] "r_ID[10378,Intercept]"      "r_ID[10379,Intercept]"     
[243] "r_ID[10380,Intercept]"      "r_ID[10381,Intercept]"     
[245] "r_ID[10382,Intercept]"      "r_ID[10383,Intercept]"     
[247] "r_ID[10384,Intercept]"      "r_ID[10386,Intercept]"     
[249] "r_ID[10388,Intercept]"      "r_ID[10389,Intercept]"     
[251] "r_ID[10390,Intercept]"      "r_ID[10391,Intercept]"     
[253] "r_ID[10392,Intercept]"      "r_ID[10394,Intercept]"     
[255] "r_ID[10397,Intercept]"      "r_ID[10398,Intercept]"     
[257] "r_ID[10399,Intercept]"      "r_ID[10402,Intercept]"     
[259] "r_ID[10404,Intercept]"      "r_ID[10407,Intercept]"     
[261] "r_ID[10408,Intercept]"      "r_ID[10409,Intercept]"     
[263] "r_ID[10411,Intercept]"      "r_ID[10412,Intercept]"     
[265] "r_ID[10413,Intercept]"      "r_ID[10414,Intercept]"     
[267] "r_ID[10415,Intercept]"      "r_ID[10418,Intercept]"     
[269] "r_ID[10421,Intercept]"      "r_ID[10422,Intercept]"     
[271] "r_ID[10423,Intercept]"      "r_ID[10426,Intercept]"     
[273] "r_ID[10427,Intercept]"      "r_ID[10428,Intercept]"     
[275] "r_ID[10429,Intercept]"      "r_ID[10431,Intercept]"     
[277] "r_ID[10432,Intercept]"      "r_ID[10433,Intercept]"     
[279] "r_ID[10434,Intercept]"      "r_ID[10435,Intercept]"     
[281] "r_ID[10436,Intercept]"      "r_ID[10437,Intercept]"     
[283] "r_ID[10438,Intercept]"      "r_ID[10439,Intercept]"     
[285] "r_ID[10440,Intercept]"      "r_ID[10441,Intercept]"     
[287] "r_ID[10442,Intercept]"      "r_ID[10444,Intercept]"     
[289] "r_ID[10445,Intercept]"      "r_ID[10447,Intercept]"     
[291] "r_ID[10448,Intercept]"      "r_ID[10449,Intercept]"     
[293] "r_ID[10450,Intercept]"      "r_ID[10451,Intercept]"     
[295] "r_ID[10452,Intercept]"      "r_ID[10453,Intercept]"     
[297] "r_ID[10454,Intercept]"      "r_ID[10455,Intercept]"     
[299] "r_ID[10456,Intercept]"      "r_ID[10457,Intercept]"     
[301] "r_ID[10459,Intercept]"      "r_ID[10460,Intercept]"     
[303] "r_ID[10461,Intercept]"      "r_ID[10462,Intercept]"     
[305] "r_ID[10463,Intercept]"      "r_ID[10465,Intercept]"     
[307] "r_ID[10466,Intercept]"      "r_ID[10469,Intercept]"     
[309] "r_ID[10470,Intercept]"      "r_ID[10471,Intercept]"     
[311] "r_ID[10472,Intercept]"      "r_ID[10473,Intercept]"     
[313] "r_ID[10474,Intercept]"      "r_ID[10475,Intercept]"     
[315] "r_ID[10476,Intercept]"      "r_ID[10477,Intercept]"     
[317] "r_ID[10479,Intercept]"      "r_ID[10480,Intercept]"     
[319] "r_ID[10481,Intercept]"      "r_ID[10483,Intercept]"     
[321] "r_ID[10484,Intercept]"      "r_ID[10485,Intercept]"     
[323] "r_ID[10486,Intercept]"      "r_ID[10487,Intercept]"     
[325] "r_ID[10488,Intercept]"      "r_ID[10490,Intercept]"     
[327] "r_ID[10492,Intercept]"      "r_ID[10493,Intercept]"     
[329] "r_ID[10494,Intercept]"      "r_ID[10495,Intercept]"     
[331] "r_ID[10496,Intercept]"      "r_ID[10497,Intercept]"     
[333] "r_ID[10498,Intercept]"      "r_ID[10500,Intercept]"     
[335] "r_ID[10503,Intercept]"      "r_ID[10506,Intercept]"     
[337] "r_ID[10508,Intercept]"      "r_ID[10509,Intercept]"     
[339] "r_ID[10510,Intercept]"      "r_ID[10511,Intercept]"     
[341] "r_ID[10512,Intercept]"      "r_ID[10513,Intercept]"     
[343] "r_ID[10515,Intercept]"      "r_ID[10516,Intercept]"     
[345] "r_ID[10517,Intercept]"      "r_ID[10518,Intercept]"     
[347] "r_ID[10522,Intercept]"      "r_ID[10523,Intercept]"     
[349] "r_ID[10524,Intercept]"      "r_ID[10525,Intercept]"     
[351] "r_ID[10526,Intercept]"      "r_ID[10528,Intercept]"     
[353] "r_ID[10529,Intercept]"      "r_ID[10530,Intercept]"     
[355] "r_ID[10532,Intercept]"      "r_ID[10533,Intercept]"     
[357] "r_ID[10535,Intercept]"      "r_ID[10536,Intercept]"     
[359] "r_ID[10537,Intercept]"      "r_ID[10538,Intercept]"     
[361] "r_ID[10539,Intercept]"      "r_ID[10540,Intercept]"     
[363] "r_ID[10541,Intercept]"      "r_ID[10542,Intercept]"     
[365] "r_ID[10543,Intercept]"      "r_ID[10544,Intercept]"     
[367] "r_ID[10545,Intercept]"      "r_ID[10547,Intercept]"     
[369] "r_ID[10549,Intercept]"      "r_ID[10550,Intercept]"     
[371] "r_ID[81,W.other]"           "r_ID[86,W.other]"          
[373] "r_ID[87,W.other]"           "r_ID[88,W.other]"          
[375] "r_ID[89,W.other]"           "r_ID[90,W.other]"          
[377] "r_ID[91,W.other]"           "r_ID[92,W.other]"          
[379] "r_ID[93,W.other]"           "r_ID[94,W.other]"          
[381] "r_ID[95,W.other]"           "r_ID[97,W.other]"          
[383] "r_ID[98,W.other]"           "r_ID[100,W.other]"         
[385] "r_ID[101,W.other]"          "r_ID[102,W.other]"         
[387] "r_ID[104,W.other]"          "r_ID[10105,W.other]"       
[389] "r_ID[10106,W.other]"        "r_ID[10107,W.other]"       
[391] "r_ID[10108,W.other]"        "r_ID[10109,W.other]"       
[393] "r_ID[10110,W.other]"        "r_ID[10111,W.other]"       
[395] "r_ID[10112,W.other]"        "r_ID[10113,W.other]"       
[397] "r_ID[10114,W.other]"        "r_ID[10116,W.other]"       
[399] "r_ID[10117,W.other]"        "r_ID[10118,W.other]"       
[401] "r_ID[10121,W.other]"        "r_ID[10122,W.other]"       
[403] "r_ID[10123,W.other]"        "r_ID[10124,W.other]"       
[405] "r_ID[10125,W.other]"        "r_ID[10126,W.other]"       
[407] "r_ID[10127,W.other]"        "r_ID[10128,W.other]"       
[409] "r_ID[10129,W.other]"        "r_ID[10130,W.other]"       
[411] "r_ID[10131,W.other]"        "r_ID[10132,W.other]"       
[413] "r_ID[10133,W.other]"        "r_ID[10134,W.other]"       
[415] "r_ID[10136,W.other]"        "r_ID[10137,W.other]"       
[417] "r_ID[10138,W.other]"        "r_ID[10139,W.other]"       
[419] "r_ID[10141,W.other]"        "r_ID[10143,W.other]"       
[421] "r_ID[10144,W.other]"        "r_ID[10145,W.other]"       
[423] "r_ID[10147,W.other]"        "r_ID[10148,W.other]"       
[425] "r_ID[10149,W.other]"        "r_ID[10150,W.other]"       
[427] "r_ID[10151,W.other]"        "r_ID[10153,W.other]"       
[429] "r_ID[10154,W.other]"        "r_ID[10155,W.other]"       
[431] "r_ID[10157,W.other]"        "r_ID[10158,W.other]"       
[433] "r_ID[10159,W.other]"        "r_ID[10160,W.other]"       
[435] "r_ID[10161,W.other]"        "r_ID[10162,W.other]"       
[437] "r_ID[10164,W.other]"        "r_ID[10166,W.other]"       
[439] "r_ID[10167,W.other]"        "r_ID[10171,W.other]"       
[441] "r_ID[10172,W.other]"        "r_ID[10173,W.other]"       
[443] "r_ID[10174,W.other]"        "r_ID[10175,W.other]"       
[445] "r_ID[10176,W.other]"        "r_ID[10177,W.other]"       
[447] "r_ID[10178,W.other]"        "r_ID[10180,W.other]"       
[449] "r_ID[10181,W.other]"        "r_ID[10184,W.other]"       
[451] "r_ID[10185,W.other]"        "r_ID[10186,W.other]"       
[453] "r_ID[10187,W.other]"        "r_ID[10188,W.other]"       
[455] "r_ID[10190,W.other]"        "r_ID[10192,W.other]"       
[457] "r_ID[10193,W.other]"        "r_ID[10194,W.other]"       
[459] "r_ID[10195,W.other]"        "r_ID[10196,W.other]"       
[461] "r_ID[10197,W.other]"        "r_ID[10198,W.other]"       
[463] "r_ID[10199,W.other]"        "r_ID[10200,W.other]"       
[465] "r_ID[10201,W.other]"        "r_ID[10202,W.other]"       
[467] "r_ID[10203,W.other]"        "r_ID[10204,W.other]"       
[469] "r_ID[10205,W.other]"        "r_ID[10206,W.other]"       
[471] "r_ID[10207,W.other]"        "r_ID[10208,W.other]"       
[473] "r_ID[10210,W.other]"        "r_ID[10211,W.other]"       
[475] "r_ID[10212,W.other]"        "r_ID[10213,W.other]"       
[477] "r_ID[10214,W.other]"        "r_ID[10215,W.other]"       
[479] "r_ID[10216,W.other]"        "r_ID[10217,W.other]"       
[481] "r_ID[10219,W.other]"        "r_ID[10220,W.other]"       
[483] "r_ID[10221,W.other]"        "r_ID[10222,W.other]"       
[485] "r_ID[10223,W.other]"        "r_ID[10226,W.other]"       
[487] "r_ID[10227,W.other]"        "r_ID[10228,W.other]"       
[489] "r_ID[10229,W.other]"        "r_ID[10230,W.other]"       
[491] "r_ID[10231,W.other]"        "r_ID[10232,W.other]"       
[493] "r_ID[10233,W.other]"        "r_ID[10234,W.other]"       
[495] "r_ID[10236,W.other]"        "r_ID[10237,W.other]"       
[497] "r_ID[10238,W.other]"        "r_ID[10239,W.other]"       
[499] "r_ID[10240,W.other]"        "r_ID[10241,W.other]"       
[501] "r_ID[10242,W.other]"        "r_ID[10243,W.other]"       
[503] "r_ID[10244,W.other]"        "r_ID[10245,W.other]"       
[505] "r_ID[10247,W.other]"        "r_ID[10248,W.other]"       
[507] "r_ID[10249,W.other]"        "r_ID[10250,W.other]"       
[509] "r_ID[10251,W.other]"        "r_ID[10253,W.other]"       
[511] "r_ID[10255,W.other]"        "r_ID[10256,W.other]"       
[513] "r_ID[10258,W.other]"        "r_ID[10259,W.other]"       
[515] "r_ID[10260,W.other]"        "r_ID[10266,W.other]"       
[517] "r_ID[10267,W.other]"        "r_ID[10268,W.other]"       
[519] "r_ID[10269,W.other]"        "r_ID[10270,W.other]"       
[521] "r_ID[10271,W.other]"        "r_ID[10272,W.other]"       
[523] "r_ID[10273,W.other]"        "r_ID[10274,W.other]"       
[525] "r_ID[10275,W.other]"        "r_ID[10276,W.other]"       
[527] "r_ID[10277,W.other]"        "r_ID[10280,W.other]"       
[529] "r_ID[10281,W.other]"        "r_ID[10285,W.other]"       
[531] "r_ID[10286,W.other]"        "r_ID[10287,W.other]"       
[533] "r_ID[10288,W.other]"        "r_ID[10289,W.other]"       
[535] "r_ID[10290,W.other]"        "r_ID[10291,W.other]"       
[537] "r_ID[10292,W.other]"        "r_ID[10293,W.other]"       
[539] "r_ID[10294,W.other]"        "r_ID[10295,W.other]"       
[541] "r_ID[10296,W.other]"        "r_ID[10299,W.other]"       
[543] "r_ID[10301,W.other]"        "r_ID[10304,W.other]"       
[545] "r_ID[10305,W.other]"        "r_ID[10308,W.other]"       
[547] "r_ID[10309,W.other]"        "r_ID[10310,W.other]"       
[549] "r_ID[10311,W.other]"        "r_ID[10312,W.other]"       
[551] "r_ID[10313,W.other]"        "r_ID[10314,W.other]"       
[553] "r_ID[10315,W.other]"        "r_ID[10316,W.other]"       
[555] "r_ID[10317,W.other]"        "r_ID[10318,W.other]"       
[557] "r_ID[10319,W.other]"        "r_ID[10320,W.other]"       
[559] "r_ID[10322,W.other]"        "r_ID[10323,W.other]"       
[561] "r_ID[10324,W.other]"        "r_ID[10325,W.other]"       
[563] "r_ID[10326,W.other]"        "r_ID[10327,W.other]"       
[565] "r_ID[10328,W.other]"        "r_ID[10329,W.other]"       
[567] "r_ID[10330,W.other]"        "r_ID[10331,W.other]"       
[569] "r_ID[10332,W.other]"        "r_ID[10333,W.other]"       
[571] "r_ID[10335,W.other]"        "r_ID[10336,W.other]"       
[573] "r_ID[10337,W.other]"        "r_ID[10338,W.other]"       
[575] "r_ID[10340,W.other]"        "r_ID[10341,W.other]"       
[577] "r_ID[10342,W.other]"        "r_ID[10343,W.other]"       
[579] "r_ID[10345,W.other]"        "r_ID[10347,W.other]"       
[581] "r_ID[10348,W.other]"        "r_ID[10349,W.other]"       
[583] "r_ID[10350,W.other]"        "r_ID[10351,W.other]"       
[585] "r_ID[10352,W.other]"        "r_ID[10353,W.other]"       
[587] "r_ID[10354,W.other]"        "r_ID[10357,W.other]"       
[589] "r_ID[10358,W.other]"        "r_ID[10359,W.other]"       
[591] "r_ID[10360,W.other]"        "r_ID[10361,W.other]"       
[593] "r_ID[10363,W.other]"        "r_ID[10364,W.other]"       
[595] "r_ID[10365,W.other]"        "r_ID[10366,W.other]"       
[597] "r_ID[10367,W.other]"        "r_ID[10368,W.other]"       
[599] "r_ID[10369,W.other]"        "r_ID[10370,W.other]"       
[601] "r_ID[10371,W.other]"        "r_ID[10372,W.other]"       
[603] "r_ID[10373,W.other]"        "r_ID[10374,W.other]"       
[605] "r_ID[10378,W.other]"        "r_ID[10379,W.other]"       
[607] "r_ID[10380,W.other]"        "r_ID[10381,W.other]"       
[609] "r_ID[10382,W.other]"        "r_ID[10383,W.other]"       
[611] "r_ID[10384,W.other]"        "r_ID[10386,W.other]"       
[613] "r_ID[10388,W.other]"        "r_ID[10389,W.other]"       
[615] "r_ID[10390,W.other]"        "r_ID[10391,W.other]"       
[617] "r_ID[10392,W.other]"        "r_ID[10394,W.other]"       
[619] "r_ID[10397,W.other]"        "r_ID[10398,W.other]"       
[621] "r_ID[10399,W.other]"        "r_ID[10402,W.other]"       
[623] "r_ID[10404,W.other]"        "r_ID[10407,W.other]"       
[625] "r_ID[10408,W.other]"        "r_ID[10409,W.other]"       
[627] "r_ID[10411,W.other]"        "r_ID[10412,W.other]"       
[629] "r_ID[10413,W.other]"        "r_ID[10414,W.other]"       
[631] "r_ID[10415,W.other]"        "r_ID[10418,W.other]"       
[633] "r_ID[10421,W.other]"        "r_ID[10422,W.other]"       
[635] "r_ID[10423,W.other]"        "r_ID[10426,W.other]"       
[637] "r_ID[10427,W.other]"        "r_ID[10428,W.other]"       
[639] "r_ID[10429,W.other]"        "r_ID[10431,W.other]"       
[641] "r_ID[10432,W.other]"        "r_ID[10433,W.other]"       
[643] "r_ID[10434,W.other]"        "r_ID[10435,W.other]"       
[645] "r_ID[10436,W.other]"        "r_ID[10437,W.other]"       
[647] "r_ID[10438,W.other]"        "r_ID[10439,W.other]"       
[649] "r_ID[10440,W.other]"        "r_ID[10441,W.other]"       
[651] "r_ID[10442,W.other]"        "r_ID[10444,W.other]"       
[653] "r_ID[10445,W.other]"        "r_ID[10447,W.other]"       
[655] "r_ID[10448,W.other]"        "r_ID[10449,W.other]"       
[657] "r_ID[10450,W.other]"        "r_ID[10451,W.other]"       
[659] "r_ID[10452,W.other]"        "r_ID[10453,W.other]"       
[661] "r_ID[10454,W.other]"        "r_ID[10455,W.other]"       
[663] "r_ID[10456,W.other]"        "r_ID[10457,W.other]"       
[665] "r_ID[10459,W.other]"        "r_ID[10460,W.other]"       
[667] "r_ID[10461,W.other]"        "r_ID[10462,W.other]"       
[669] "r_ID[10463,W.other]"        "r_ID[10465,W.other]"       
[671] "r_ID[10466,W.other]"        "r_ID[10469,W.other]"       
[673] "r_ID[10470,W.other]"        "r_ID[10471,W.other]"       
[675] "r_ID[10472,W.other]"        "r_ID[10473,W.other]"       
[677] "r_ID[10474,W.other]"        "r_ID[10475,W.other]"       
[679] "r_ID[10476,W.other]"        "r_ID[10477,W.other]"       
[681] "r_ID[10479,W.other]"        "r_ID[10480,W.other]"       
[683] "r_ID[10481,W.other]"        "r_ID[10483,W.other]"       
[685] "r_ID[10484,W.other]"        "r_ID[10485,W.other]"       
[687] "r_ID[10486,W.other]"        "r_ID[10487,W.other]"       
[689] "r_ID[10488,W.other]"        "r_ID[10490,W.other]"       
[691] "r_ID[10492,W.other]"        "r_ID[10493,W.other]"       
[693] "r_ID[10494,W.other]"        "r_ID[10495,W.other]"       
[695] "r_ID[10496,W.other]"        "r_ID[10497,W.other]"       
[697] "r_ID[10498,W.other]"        "r_ID[10500,W.other]"       
[699] "r_ID[10503,W.other]"        "r_ID[10506,W.other]"       
[701] "r_ID[10508,W.other]"        "r_ID[10509,W.other]"       
[703] "r_ID[10510,W.other]"        "r_ID[10511,W.other]"       
[705] "r_ID[10512,W.other]"        "r_ID[10513,W.other]"       
[707] "r_ID[10515,W.other]"        "r_ID[10516,W.other]"       
[709] "r_ID[10517,W.other]"        "r_ID[10518,W.other]"       
[711] "r_ID[10522,W.other]"        "r_ID[10523,W.other]"       
[713] "r_ID[10524,W.other]"        "r_ID[10525,W.other]"       
[715] "r_ID[10526,W.other]"        "r_ID[10528,W.other]"       
[717] "r_ID[10529,W.other]"        "r_ID[10530,W.other]"       
[719] "r_ID[10532,W.other]"        "r_ID[10533,W.other]"       
[721] "r_ID[10535,W.other]"        "r_ID[10536,W.other]"       
[723] "r_ID[10537,W.other]"        "r_ID[10538,W.other]"       
[725] "r_ID[10539,W.other]"        "r_ID[10540,W.other]"       
[727] "r_ID[10541,W.other]"        "r_ID[10542,W.other]"       
[729] "r_ID[10543,W.other]"        "r_ID[10544,W.other]"       
[731] "r_ID[10545,W.other]"        "r_ID[10547,W.other]"       
[733] "r_ID[10549,W.other]"        "r_ID[10550,W.other]"       
[735] "prior_Intercept"            "prior_b"                   
[737] "prior_sigma"                "prior_sd_ID__Intercept"    
[739] "prior_sd_ID__W.other"       "prior_cor_ID"              
[741] "lprior"                     "lp__"                      
[743] "accept_stat__"              "treedepth__"               
[745] "stepsize__"                 "divergent__"               
[747] "n_leapfrog__"               "energy__"                  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">summary</span>(mlm<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: PA ~ 1 + W.other + (1 + W.other | ID) 
   Data: esm (Number of observations: 9461) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 364) 
                       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)              0.50      0.03     0.44     0.55 1.00     4405
sd(W.other)                0.18      0.04     0.10     0.26 1.00     1251
cor(Intercept,W.other)    -0.43      0.11    -0.63    -0.19 1.00    10095
                       Tail_ESS
sd(Intercept)              7218
sd(W.other)                1834
cor(Intercept,W.other)     6956

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     3.15      0.04     3.08     3.22 1.00     5313     7266
W.other       0.32      0.03     0.27     0.37 1.00    15524     9887

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.85      0.01     0.84     0.86 1.00    17740     8791

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>partially_pooled_params2 <span class="ot">&lt;-</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.5</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb85-4"><a href="#cb85-4"></a></span>
<span id="cb85-5"><a href="#cb85-5"></a></span>
<span id="cb85-6"><a href="#cb85-6"></a>un_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>  esm <span class="sc">%&gt;%</span></span>
<span id="cb85-8"><a href="#cb85-8"></a>  <span class="fu">filter</span>((<span class="sc">!</span><span class="fu">is.na</span>(PA))) <span class="sc">%&gt;%</span> </span>
<span id="cb85-9"><a href="#cb85-9"></a>  <span class="fu">group_by</span>(ID, W.other) <span class="sc">%&gt;%</span></span>
<span id="cb85-10"><a href="#cb85-10"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PA)) <span class="sc">%&gt;%</span></span>
<span id="cb85-11"><a href="#cb85-11"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> W.other, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb85-12"><a href="#cb85-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb85-13"><a href="#cb85-13"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb85-14"><a href="#cb85-14"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb85-15"><a href="#cb85-15"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-16"><a href="#cb85-16"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-17"><a href="#cb85-17"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb85-18"><a href="#cb85-18"></a></span>
<span id="cb85-19"><a href="#cb85-19"></a>params <span class="ot">&lt;-</span></span>
<span id="cb85-20"><a href="#cb85-20"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb85-21"><a href="#cb85-21"></a>  <span class="fu">bind_rows</span>(partially_pooled_params2, un_pooled_params) <span class="sc">%&gt;%</span></span>
<span id="cb85-22"><a href="#cb85-22"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb85-23"><a href="#cb85-23"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb85-24"><a href="#cb85-24"></a></span>
<span id="cb85-25"><a href="#cb85-25"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb85-26"><a href="#cb85-26"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params, <span class="fu">aes</span>(<span class="at">x =</span> W.other, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb85-27"><a href="#cb85-27"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb85-28"><a href="#cb85-28"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb85-29"><a href="#cb85-29"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb85-30"><a href="#cb85-30"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb85-31"><a href="#cb85-31"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(params<span class="sc">$</span>W.other),</span>
<span id="cb85-32"><a href="#cb85-32"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(params<span class="sc">$</span>Intercept))</span>
<span id="cb85-33"><a href="#cb85-33"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-65-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>mlm<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2"></a>  <span class="fu">spread_draws</span>(b_W.other, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"W.other"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="#cb86-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_W.other <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb86-7"><a href="#cb86-7"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-66-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>esm <span class="ot">&lt;-</span> esm <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="fu">mutate</span>(<span class="at">W.other.pm =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">W.other</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(W.other.pm)) <span class="sc">%&gt;%</span>   </span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="fu">mutate</span>(<span class="at">W.other.pc =</span> W.other <span class="sc">-</span> W.other.pm) <span class="sc">%&gt;%</span> </span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="fu">mutate</span>(<span class="at">W.other.gmc =</span>W.other.pm  <span class="sc">-</span> <span class="fu">mean</span> (W.other.pm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>mlm<span class="fl">.6</span> <span class="ot">&lt;-</span> </span>
<span id="cb88-2"><a href="#cb88-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb88-3"><a href="#cb88-3"></a>      PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other.pc  <span class="sc">+</span>  W.other.gmc <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other.pc  <span class="sc">|</span> ID),</span>
<span id="cb88-4"><a href="#cb88-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb88-5"><a href="#cb88-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb88-6"><a href="#cb88-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb88-7"><a href="#cb88-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> W.other.pc, <span class="at">group =</span> ID), </span>
<span id="cb88-8"><a href="#cb88-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb88-9"><a href="#cb88-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">10</span>), <span class="at">class =</span> cor)),</span>
<span id="cb88-10"><a href="#cb88-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb88-11"><a href="#cb88-11"></a>      <span class="at">file =</span> <span class="st">"mlm.6"</span>,</span>
<span id="cb88-12"><a href="#cb88-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb88-13"><a href="#cb88-13"></a>      <span class="at">data =</span> esm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">summary</span>(mlm<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: PA ~ 1 + W.other.pc + W.other.gmc + (1 + W.other.pc | ID) 
   Data: esm (Number of observations: 8321) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 326) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.45      0.02     0.41     0.50 1.00     1758
sd(W.other.pc)                0.20      0.04     0.12     0.28 1.00     3702
cor(Intercept,W.other.pc)    -0.25      0.13    -0.51     0.00 1.00     9630
                          Tail_ESS
sd(Intercept)                 4293
sd(W.other.pc)                5292
cor(Intercept,W.other.pc)     8296

Population-Level Effects: 
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept       3.40      0.03     3.34     3.45 1.00     1698     3188
W.other.pc      0.33      0.03     0.28     0.39 1.00    10487     9038
W.other.gmc     0.86      0.18     0.51     1.22 1.00     1963     3738

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.86      0.01     0.84     0.87 1.00    14321     9005

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>partially_pooled_params3 <span class="ot">&lt;-</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.6</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb91-4"><a href="#cb91-4"></a></span>
<span id="cb91-5"><a href="#cb91-5"></a></span>
<span id="cb91-6"><a href="#cb91-6"></a>un_pooled_params2 <span class="ot">&lt;-</span></span>
<span id="cb91-7"><a href="#cb91-7"></a>  esm <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="#cb91-8"></a>  <span class="fu">filter</span>((<span class="sc">!</span><span class="fu">is.na</span>(PA))) <span class="sc">%&gt;%</span> </span>
<span id="cb91-9"><a href="#cb91-9"></a>  <span class="fu">group_by</span>(ID, W.other.pc) <span class="sc">%&gt;%</span></span>
<span id="cb91-10"><a href="#cb91-10"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PA)) <span class="sc">%&gt;%</span></span>
<span id="cb91-11"><a href="#cb91-11"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> W.other.pc, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb91-12"><a href="#cb91-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb91-13"><a href="#cb91-13"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb91-14"><a href="#cb91-14"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb91-15"><a href="#cb91-15"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-16"><a href="#cb91-16"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-17"><a href="#cb91-17"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb91-18"><a href="#cb91-18"></a></span>
<span id="cb91-19"><a href="#cb91-19"></a>params2 <span class="ot">&lt;-</span></span>
<span id="cb91-20"><a href="#cb91-20"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb91-21"><a href="#cb91-21"></a>  <span class="fu">bind_rows</span>(partially_pooled_params3, un_pooled_params2) <span class="sc">%&gt;%</span></span>
<span id="cb91-22"><a href="#cb91-22"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb91-23"><a href="#cb91-23"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb91-24"><a href="#cb91-24"></a></span>
<span id="cb91-25"><a href="#cb91-25"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb91-26"><a href="#cb91-26"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params2, <span class="fu">aes</span>(<span class="at">x =</span> W.other.pc, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb91-27"><a href="#cb91-27"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb91-28"><a href="#cb91-28"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb91-29"><a href="#cb91-29"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb91-30"><a href="#cb91-30"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb91-31"><a href="#cb91-31"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(params<span class="sc">$</span>W.other.pc),</span>
<span id="cb91-32"><a href="#cb91-32"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(params<span class="sc">$</span>Intercept))</span>
<span id="cb91-33"><a href="#cb91-33"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-70-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>mlm<span class="fl">.6</span> <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>  <span class="fu">spread_draws</span>(b_W.other.pc, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="#cb92-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"W.other.pc"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-4"><a href="#cb92-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_W.other.pc <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb92-5"><a href="#cb92-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb92-7"><a href="#cb92-7"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-71-1.png" width="960" class="r-stretch"></section>
<section id="making-predictions" class="slide level2">
<h2>Making predictions</h2>
<p>We often want to make predictions for different groups or individuals. The previous slide is one example. We made these predictions using/borrowing information from other individuals, through partial pooling. This improves our predictions.</p>
<p>Can we improve it further? Think about predictions in presidential races, or think about if we want to make some decision for a cancer drug. Do we stick with these standard MLM based predictions?</p>
</section>
<section id="mr.-p" class="slide level2">
<h2>Mr.&nbsp;P</h2>
<p>Improving predictions by incorporating outside (of the model) information. MRP = multilevel regression with poststratification</p>
<p>One of the biggest problems with psych data is that it is unrepresentative. (Do you trust undergrads or adults off the street wanting to help science?) Often survey weights are used. But if we know the distribution of the broader population, we can reweight (post-stratify) our results to get more accurate estimates. Instead of making assumptions about how the observed sample was produced from the population, we make assumptions about how the observed sample can be used to reconstruct the rest of the population</p>
</section>
<section id="weighting-vs-postratifying" class="slide level2">
<h2>Weighting vs postratifying</h2>
<p>Weighting is done all the time with data. It gives more or less “weight” to observations that are over or under sampled. Some people “count” more than others in the service of getting data that represents some population.</p>
<p>Poststratification is similar in that it weights the posterior samples rather than the observations.</p>
<p>Why is this preferred? A few reasons, but mainly one can make generalization to new groups or groups with little data. Rather than weighting those specific individuals, partial pooling from other information will help with learning</p>
</section>
<section class="slide level2">

<p>What do we need? A reliable data source (such as a census) that gives us the population weights. Data can be re-weighted based on many different categories, not just one: for example, we could post-stratify based on age, education, state of residence, etc.</p>
</section>
<section class="slide level2">

<p>Estimating the proportion of heterosexual women who kept their maiden name after marriage.</p>
<p>https://www.monicaalexander.com/posts/2019-08-07-mrp/ https://bookdown.org/content/4857/models-with-memory.html#summary-bonus-post-stratification-in-an-example</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>mrp <span class="ot">&lt;-</span><span class="fu">load</span>(<span class="st">"mrp.rds"</span>)</span>
<span id="cb93-2"><a href="#cb93-2"></a>mrp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d"           "cell_counts"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,413 × 5
   kept_name state_name     age_group decade_married educ_group
       &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;     
 1         0 ohio           50        1979           &gt;BA       
 2         0 virginia       35        1999           &gt;BA       
 3         1 new york       35        2009           &gt;BA       
 4         0 rhode island   55        1999           &gt;BA       
 5         0 illinois       35        2009           &gt;BA       
 6         0 north carolina 25        2009           &gt;BA       
 7         1 iowa           35        1999           &gt;BA       
 8         1 texas          35        2009           &gt;BA       
 9         0 south dakota   35        1999           &gt;BA       
10         0 texas          35        2009           &gt;BA       
# ℹ 4,403 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>cell_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,058 × 5
   state_name age_group decade_married educ_group     n
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;
 1 alabama    25        1999           &lt;BA        19012
 2 alabama    25        2009           &lt;BA        37488
 3 alabama    25        1999           &gt;BA          959
 4 alabama    25        2009           &gt;BA         5319
 5 alabama    25        1999           BA          2986
 6 alabama    25        2009           BA         14261
 7 alaska     25        1999           &lt;BA         3320
 8 alaska     25        2009           &lt;BA         7001
 9 alaska     25        1999           &gt;BA          159
10 alaska     25        2009           &gt;BA          435
# ℹ 6,048 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>mlm.mrp <span class="ot">&lt;-</span></span>
<span id="cb99-2"><a href="#cb99-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> binomial,</span>
<span id="cb99-3"><a href="#cb99-3"></a>      kept_name <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> age_group) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> decade_married) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> educ_group) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_name),</span>
<span id="cb99-4"><a href="#cb99-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb99-5"><a href="#cb99-5"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd)),</span>
<span id="cb99-6"><a href="#cb99-6"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb99-7"><a href="#cb99-7"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">98</span>),</span>
<span id="cb99-8"><a href="#cb99-8"></a>      <span class="at">data =</span> d,</span>
<span id="cb99-9"><a href="#cb99-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb99-10"><a href="#cb99-10"></a>      <span class="at">file =</span> <span class="st">"mlm.mrp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">summary</span>(mlm.mrp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: kept_name | trials(1) ~ 1 + (1 | age_group) + (1 | decade_married) + (1 | educ_group) + (1 | state_name) 
   Data: d (Number of observations: 4373) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~age_group (Number of levels: 11) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     1.15      0.29     0.72     1.88 1.00     1470     2235

~decade_married (Number of levels: 5) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     1.00      0.39     0.49     2.03 1.00     2246     2946

~educ_group (Number of levels: 4) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.92      0.49     0.35     2.17 1.00     2553     2773

~state_name (Number of levels: 52) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.25      0.06     0.15     0.38 1.00     1407     2328

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    -0.72      0.63    -1.99     0.50 1.00     1966     2475

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">posterior_samples</span>(mlm.mrp) <span class="sc">%&gt;%</span> </span>
<span id="cb102-2"><a href="#cb102-2"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"sd_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="#cb102-3"></a>  <span class="fu">set_names</span>(<span class="fu">str_c</span>(<span class="st">"sigma["</span>, <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"decade~married"</span>, <span class="st">"education"</span>, <span class="st">"state"</span>), <span class="st">"]"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="#cb102-4"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb102-5"><a href="#cb102-5"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb102-6"><a href="#cb102-6"></a>  <span class="fu">median_qi</span>(<span class="at">.width =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">70</span>, <span class="at">to =</span> .<span class="dv">95</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb102-7"><a href="#cb102-7"></a>  </span>
<span id="cb102-8"><a href="#cb102-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> <span class="fu">reorder</span>(name, value))) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .width), <span class="at">color =</span> <span class="st">"orange3"</span>) <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe) <span class="sc">+</span></span>
<span id="cb102-11"><a href="#cb102-11"></a>  <span class="fu">scale_alpha_continuous</span>(<span class="st">"CI width"</span>, <span class="at">range =</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb102-12"><a href="#cb102-12"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb102-13"><a href="#cb102-13"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb102-14"><a href="#cb102-14"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-77-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Census data we will use to make predictions. We will make predictions for every combination of variable we are interested in (state, age, decade married, edu)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>age_prop <span class="ot">&lt;-</span> </span>
<span id="cb103-2"><a href="#cb103-2"></a>  cell_counts <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb103-4"><a href="#cb103-4"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-5"><a href="#cb103-5"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb103-6"><a href="#cb103-6"></a></span>
<span id="cb103-7"><a href="#cb103-7"></a>age_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,058 × 6
   state_name age_group decade_married educ_group     n      prop
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 alabama    25        1999           &lt;BA        19012 0.00414  
 2 alabama    25        2009           &lt;BA        37488 0.00816  
 3 alabama    25        1999           &gt;BA          959 0.000209 
 4 alabama    25        2009           &gt;BA         5319 0.00116  
 5 alabama    25        1999           BA          2986 0.000650 
 6 alabama    25        2009           BA         14261 0.00310  
 7 alaska     25        1999           &lt;BA         3320 0.000723 
 8 alaska     25        2009           &lt;BA         7001 0.00152  
 9 alaska     25        1999           &gt;BA          159 0.0000346
10 alaska     25        2009           &gt;BA          435 0.0000947
# ℹ 6,048 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>p <span class="ot">&lt;-</span> mlm.mrp <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2"></a>  <span class="fu">add_predicted_draws</span>(<span class="at">newdata =</span> age_prop <span class="sc">%&gt;%</span> </span>
<span id="cb105-3"><a href="#cb105-3"></a>                        <span class="fu">filter</span>(age_group <span class="sc">&gt;</span> <span class="dv">20</span>, </span>
<span id="cb105-4"><a href="#cb105-4"></a>                               age_group <span class="sc">&lt;</span> <span class="dv">80</span>, </span>
<span id="cb105-5"><a href="#cb105-5"></a>                               decade_married <span class="sc">&gt;</span> <span class="dv">1969</span>),</span>
<span id="cb105-6"><a href="#cb105-6"></a>                      <span class="at">allow_new_levels =</span> T)</span>
<span id="cb105-7"><a href="#cb105-7"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24,232,000 × 11
# Groups:   state_name, age_group, decade_married, educ_group, n, prop, .row
#   [6,058]
   state_name age_group decade_married educ_group     n    prop  .row .chain
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;
 1 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 2 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 3 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 4 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 5 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 6 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 7 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 8 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 9 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
10 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
# ℹ 24,231,990 more rows
# ℹ 3 more variables: .iteration &lt;int&gt;, .draw &lt;int&gt;, .prediction &lt;int&gt;</code></pre>
</div>
</div>
<p>6,058 census categories * 4,000 samples = 24,232,000</p>
</section>
<section class="slide level2">

<p>If we group the results by age_group and .draw, we can sum the product of the posterior predictions and the weights (prop), which will leave us with 4,000 stratified posterior draws for each of the 11 levels of age_group</p>
<p><span class="math display">\[\frac{\sum_i N_i p_i}{\sum_i N_i}\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>pp <span class="ot">&lt;-</span></span>
<span id="cb107-2"><a href="#cb107-2"></a>  p <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3"></a>  <span class="fu">group_by</span>(age_group, .draw) <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="#cb107-4"></a>  <span class="fu">summarise</span>(<span class="at">kept_name_predict =</span> <span class="fu">sum</span>(.prediction <span class="sc">*</span> prop)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-5"><a href="#cb107-5"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb107-6"><a href="#cb107-6"></a>  <span class="fu">mean_qi</span>(kept_name_predict)</span>
<span id="cb107-7"><a href="#cb107-7"></a></span>
<span id="cb107-8"><a href="#cb107-8"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 7
   age_group kept_name_predict .lower .upper .width .point .interval
   &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1 25                    0.175 0.0932  0.277   0.95 mean   qi       
 2 30                    0.182 0.116   0.261   0.95 mean   qi       
 3 35                    0.219 0.149   0.300   0.95 mean   qi       
 4 40                    0.244 0.174   0.325   0.95 mean   qi       
 5 45                    0.279 0.199   0.368   0.95 mean   qi       
 6 50                    0.301 0.220   0.399   0.95 mean   qi       
 7 55                    0.324 0.234   0.423   0.95 mean   qi       
 8 60                    0.438 0.326   0.557   0.95 mean   qi       
 9 65                    0.561 0.419   0.703   0.95 mean   qi       
10 70                    0.515 0.298   0.745   0.95 mean   qi       
11 75                    0.227 0.0455  0.521   0.95 mean   qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"raw data"</span>, <span class="st">"multilevel"</span>, <span class="st">"MRP"</span>)</span>
<span id="cb109-2"><a href="#cb109-2"></a></span>
<span id="cb109-3"><a href="#cb109-3"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb109-4"><a href="#cb109-4"></a>  <span class="co"># compute the proportions from the data</span></span>
<span id="cb109-5"><a href="#cb109-5"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb109-6"><a href="#cb109-6"></a>  <span class="fu">group_by</span>(age_group, kept_name) <span class="sc">%&gt;%</span></span>
<span id="cb109-7"><a href="#cb109-7"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb109-8"><a href="#cb109-8"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb109-9"><a href="#cb109-9"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb109-10"><a href="#cb109-10"></a>         <span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"raw data"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-11"><a href="#cb109-11"></a>  <span class="fu">filter</span>(kept_name <span class="sc">==</span> <span class="dv">1</span>, age_group <span class="sc">&lt;</span> <span class="dv">80</span>, age_group <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-12"><a href="#cb109-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb109-13"><a href="#cb109-13"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb109-14"><a href="#cb109-14"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb109-15"><a href="#cb109-15"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb109-16"><a href="#cb109-16"></a></span>
<span id="cb109-17"><a href="#cb109-17"></a></span>
<span id="cb109-18"><a href="#cb109-18"></a>nd <span class="ot">&lt;-</span> <span class="fu">distinct</span>(d, age_group) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(age_group)</span>
<span id="cb109-19"><a href="#cb109-19"></a></span>
<span id="cb109-20"><a href="#cb109-20"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb109-21"><a href="#cb109-21"></a>  <span class="fu">fitted</span>(mlm.mrp,</span>
<span id="cb109-22"><a href="#cb109-22"></a>         <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> age_group),</span>
<span id="cb109-23"><a href="#cb109-23"></a>         <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb109-24"><a href="#cb109-24"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb109-25"><a href="#cb109-25"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb109-26"><a href="#cb109-26"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> Estimate,</span>
<span id="cb109-27"><a href="#cb109-27"></a>         <span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"multilevel"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-28"><a href="#cb109-28"></a>  </span>
<span id="cb109-29"><a href="#cb109-29"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb109-30"><a href="#cb109-30"></a>  <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"blue2"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">fatten =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb109-31"><a href="#cb109-31"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb109-32"><a href="#cb109-32"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb109-33"><a href="#cb109-33"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb109-34"><a href="#cb109-34"></a></span>
<span id="cb109-35"><a href="#cb109-35"></a></span>
<span id="cb109-36"><a href="#cb109-36"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb109-37"><a href="#cb109-37"></a>  pp <span class="sc">%&gt;%</span></span>
<span id="cb109-38"><a href="#cb109-38"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"MRP"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-39"><a href="#cb109-39"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> kept_name_predict, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb109-40"><a href="#cb109-40"></a>  <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"orange2"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">fatten =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb109-41"><a href="#cb109-41"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb109-42"><a href="#cb109-42"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb109-43"><a href="#cb109-43"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb109-44"><a href="#cb109-44"></a></span>
<span id="cb109-45"><a href="#cb109-45"></a><span class="co"># combine!</span></span>
<span id="cb109-46"><a href="#cb109-46"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">+</span></span>
<span id="cb109-47"><a href="#cb109-47"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Proportion of women keeping name after marriage, by age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-81-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>The general idea is that we can create predictions based on what we want to do with the predictions. Previously when we wanted to plot prediction lines we made predictions across the levels of X. When we want to see observational level variability we incorporate sigma in the predictions rather than focus on expected predictions. If we wanted the CI around a specific value rather than a band then we calculate predictions around that X value. All involve feeding in data.</p>
<p>Here we are doing the same thing, feeding in values to predict but choosing them to be “weighted” however we want.</p>
</section>
<section id="mr.p-not-limited-to-surveys" class="slide level2">
<h2>Mr.P Not limited to surveys</h2>
<p>Example (using brms) with experimental data – can you generalize from your sample of undergraduates to other undergraduates at your university, let alone undergraduates in general, let alone young adults, to say nothing about the population of humans. https://arxiv.org/pdf/1906.11323.pdf</p>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>