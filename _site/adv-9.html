<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>Bayesian Statistics 2023 - advanced MLM</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">advanced MLM</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="the-rest-of-the-semester" class="slide level2">
<h2>The rest of the semester</h2>
<ol type="1">
<li>Plots</li>
<li>Mr.P</li>
<li>Multivariate models</li>
<li>Mediation</li>
<li>Distributional models</li>
<li>Missing data</li>
<li>Meta analysis</li>
<li>IRT/Cog models</li>
<li>gams!</li>
</ol>
</section>
<section id="mlm-plots" class="slide level2">
<h2>MLM plots</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>melsm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Library/CloudStorage/Box-Box/Bayesian Statistics/bayes22/static/Lectures/melsm.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>melsm <span class="ot">&lt;-</span> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="fu">mutate</span>(<span class="at">day01 =</span> (day <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>((day <span class="sc">-</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">distinct</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    n
1 193</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Participants filled out daily affective measures and physical activity</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="fu">count</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"number of days"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Participant level</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">!</span>record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> N_A.lag)) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">ylab</span>(<span class="st">"negative affect (standardized)"</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>day01 is coded such that it is a percentage of the 100 total possible days.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>melsm<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb6-3"><a href="#cb6-3"></a>      N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span> record_id),</span>
<span id="cb6-4"><a href="#cb6-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb6-5"><a href="#cb6-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb6-6"><a href="#cb6-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb6-7"><a href="#cb6-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb6-8"><a href="#cb6-8"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb6-9"><a href="#cb6-9"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb6-11"><a href="#cb6-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>      <span class="at">file =</span> <span class="st">"melsm.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">summary</span>(melsm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | record_id) 
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.77      0.04     0.70     0.86 1.00     1597
sd(day01)                0.65      0.04     0.57     0.74 1.00     3333
cor(Intercept,day01)    -0.34      0.08    -0.49    -0.18 1.00     2848
                     Tail_ESS
sd(Intercept)            2806
sd(day01)                4841
cor(Intercept,day01)     4793

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.03      0.06    -0.08     0.14 1.00      819     1483
day01        -0.16      0.06    -0.27    -0.05 1.00     2414     3857

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.61      0.00     0.60     0.62 1.00    14044     5922

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>We have to be careful with plotting MLMs</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model=</span> melsm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 9
    day01 P_A.std   day P_A.lag N_A.lag steps.pm steps.pmd record_id N_A.std
    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 0       0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 2 0.0526  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 3 0.105   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 4 0.158   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 5 0.211   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 6 0.263   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 7 0.316   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 8 0.368   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 9 0.421   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
10 0.474   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
11 0.526   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
12 0.579   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
13 0.632   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
14 0.684   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
15 0.737   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
16 0.789   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
17 0.842   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
18 0.895   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
19 0.947   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
20 1       0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model=</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160,000 × 14
# Groups:   day01, P_A.std, day, P_A.lag, N_A.lag, steps.pm, steps.pmd,
#   record_id, N_A.std, .row [20]
   day01 P_A.std   day P_A.lag N_A.lag steps.pm steps.pmd record_id N_A.std
   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 2     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 3     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 4     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 5     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 6     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 7     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 8     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 9     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
10     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
# ℹ 159,990 more rows
# ℹ 5 more variables: .row &lt;int&gt;, .chain &lt;int&gt;, .iteration &lt;int&gt;, .draw &lt;int&gt;,
#   .epred &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>If we do not care about random effects, specify re_formula = NA</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>fixed.slope<span class="ot">&lt;-</span> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NA</span> )</span>
<span id="cb13-4"><a href="#cb13-4"></a>  fixed.slope</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160,000 × 6
# Groups:   day01, .row [20]
   day01  .row .chain .iteration .draw .epred
   &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
 1     0     1     NA         NA     1 0.0235
 2     0     1     NA         NA     2 0.121 
 3     0     1     NA         NA     3 0.145 
 4     0     1     NA         NA     4 0.0997
 5     0     1     NA         NA     5 0.0995
 6     0     1     NA         NA     6 0.0262
 7     0     1     NA         NA     7 0.0445
 8     0     1     NA         NA     8 0.0748
 9     0     1     NA         NA     9 0.0618
10     0     1     NA         NA    10 0.0356
# ℹ 159,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>If we want random effects we need to specify the variable to get ALL levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,860 × 2
   day01 record_id
   &lt;dbl&gt;     &lt;int&gt;
 1     0         1
 2     0         2
 3     0         3
 4     0         4
 5     0         5
 6     0         6
 7     0         7
 8     0         8
 9     0         9
10     0        10
# ℹ 3,850 more rows</code></pre>
</div>
</div>
<p>193 people * 20 = 3860</p>
</section>
<section class="slide level2">

<p>Then we need to state re_forumla = NULL (which is the default)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,880,000 × 7
# Groups:   day01, record_id, .row [3,860]
   day01 record_id  .row .chain .iteration .draw   .epred
   &lt;dbl&gt;     &lt;int&gt; &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
 1     0         1     1     NA         NA     1  0.105  
 2     0         1     1     NA         NA     2  0.241  
 3     0         1     1     NA         NA     3  0.289  
 4     0         1     1     NA         NA     4 -0.00407
 5     0         1     1     NA         NA     5 -0.0554 
 6     0         1     1     NA         NA     6  0.339  
 7     0         1     1     NA         NA     7  0.0825 
 8     0         1     1     NA         NA     8  0.171  
 9     0         1     1     NA         NA     9  0.302  
10     0         1     1     NA         NA    10  0.136  
# ℹ 30,879,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>re_formula formula helps us focus on either the average trajectory (gammas) or the group specific (person Us). If NULL (default), include all group-level effects; if NA, include no group-level effects.</p>
<p>160,000 = 20 (different values of X we chose) x 8000 iterations (2k x 4 chains)</p>
<p>30,880,000 = 20* 8000 iterations * 193 people in our dataset</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> .epred) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="do">## https://www.tjmahr.com/sample-n-groups/</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>sample_n_of <span class="ot">&lt;-</span> <span class="cf">function</span>(data, size, ...) {</span>
<span id="cb20-3"><a href="#cb20-3"></a>  dots <span class="ot">&lt;-</span> <span class="fu">quos</span>(...)</span>
<span id="cb20-4"><a href="#cb20-4"></a>  group_ids <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5"></a>    <span class="fu">group_by</span>(<span class="sc">!!!</span> dots) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6"></a>    <span class="fu">group_indices</span>()</span>
<span id="cb20-7"><a href="#cb20-7"></a>  sampled_groups <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(group_ids), size)</span>
<span id="cb20-8"><a href="#cb20-8"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb20-9"><a href="#cb20-9"></a>    <span class="fu">filter</span>(group_ids <span class="sc">%in%</span> sampled_groups)</span>
<span id="cb20-10"><a href="#cb20-10"></a>}</span>
<span id="cb20-11"><a href="#cb20-11"></a></span>
<span id="cb20-12"><a href="#cb20-12"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb20-13"><a href="#cb20-13"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb20-14"><a href="#cb20-14"></a>    <span class="fu">sample_n_of</span>(<span class="dv">5</span>,record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-16"><a href="#cb20-16"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> record_id, <span class="at">alpha =</span> .<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>    <span class="fu">sample_n_of</span>(<span class="dv">50</span>,record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> record_id, <span class="at">color =</span> record_id), <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>    <span class="fu">sample_n_of</span>(<span class="dv">50</span>,record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> record_id, <span class="at">color =</span> record_id), <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> fixed.slope, <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> .epred), <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>What about interactions?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>melsm<span class="fl">.1</span>i <span class="ot">&lt;-</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb23-3"><a href="#cb23-3"></a>      N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01<span class="sc">+</span> P_A.std<span class="sc">*</span>steps.pm <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span> record_id),</span>
<span id="cb23-4"><a href="#cb23-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb23-5"><a href="#cb23-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb23-6"><a href="#cb23-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb23-7"><a href="#cb23-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb23-8"><a href="#cb23-8"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb23-9"><a href="#cb23-9"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb23-10"><a href="#cb23-10"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb23-11"><a href="#cb23-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb23-12"><a href="#cb23-12"></a>      <span class="at">file =</span> <span class="st">"melsm.1i"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">summary</span>(melsm<span class="fl">.1</span>i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: N_A.std ~ 1 + day01 + P_A.std * steps.pm + (1 + day01 | record_id) 
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.77      0.04     0.70     0.86 1.00     1657
sd(day01)                0.64      0.04     0.56     0.74 1.00     3073
cor(Intercept,day01)    -0.34      0.08    -0.49    -0.19 1.00     2791
                     Tail_ESS
sd(Intercept)            2982
sd(day01)                5536
cor(Intercept,day01)     4155

Population-Level Effects: 
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            0.03      0.06    -0.07     0.14 1.00      852     1920
day01               -0.17      0.06    -0.28    -0.06 1.00     1934     3969
P_A.std             -0.05      0.01    -0.07    -0.03 1.00    14252     6904
steps.pm            -0.02      0.08    -0.18     0.14 1.01     1050     2024
P_A.std:steps.pm     0.02      0.02    -0.01     0.05 1.00    15176     6541

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.61      0.00     0.60     0.62 1.00    15202     5570

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">describe</span>(melsm<span class="sc">$</span>steps.pm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars     n mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 13033 0.05 0.63   0.05    0.04 0.54 -1.41 2.48   3.9 0.39     1.19 0.01</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">data_grid</span>(<span class="at">steps.pm =</span> <span class="fu">seq_range</span>(steps.pm, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">P_A.std =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">day01 =</span> .<span class="dv">5</span>, <span class="at">.model =</span> melsm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 9
   steps.pm P_A.std day01   day P_A.lag N_A.lag steps.pmd record_id N_A.std
      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1   -1.41       -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 2   -1.41        0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 3   -1.41        1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 4   -0.441      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 5   -0.441       0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 6   -0.441       1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 7    0.533      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 8    0.533       0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 9    0.533       1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
10    1.51       -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
11    1.51        0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
12    1.51        1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
13    2.48       -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
14    2.48        0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
15    2.48        1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351</code></pre>
</div>
</div>
<p>5 * 3 = 15 rows</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">data_grid</span>(<span class="at">steps.pm =</span> <span class="fu">seq_range</span>(steps.pm, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">P_A.std =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">day01 =</span> .<span class="dv">5</span>, <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>i, <span class="at">re_formula =</span> <span class="cn">NA</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120,000 × 14
# Groups:   steps.pm, P_A.std, day01, day, P_A.lag, N_A.lag, steps.pmd,
#   record_id, N_A.std, .row [15]
   steps.pm P_A.std day01   day P_A.lag N_A.lag steps.pmd record_id N_A.std
      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 2    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 3    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 4    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 5    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 6    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 7    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 8    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 9    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
10    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
# ℹ 119,990 more rows
# ℹ 5 more variables: .row &lt;int&gt;, .chain &lt;int&gt;, .iteration &lt;int&gt;, .draw &lt;int&gt;,
#   .epred &lt;dbl&gt;</code></pre>
</div>
</div>
<p>12 * 8000 samples = 120,000 rows</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">data_grid</span>(<span class="at">steps.pm =</span> <span class="fu">seq_range</span>(steps.pm, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">P_A.std =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">day01 =</span> .<span class="dv">5</span>, <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>i, <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> steps.pm, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> P_A.std, <span class="at">color =</span> <span class="fu">as.factor</span>(P_A.std)),  <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="making-predictions" class="slide level2">
<h2>Making predictions</h2>
<p>We often want to make predictions for different groups or individuals. We make predictions using/borrowing information from other individuals, through partial pooling. This improves our predictions.</p>
<p>Can we improve it further? Do we stick with these standard MLM based predictions? What if we want to look at sub samples in our data, especially rarer ones (e.g., gay black republicans) or are worried some are over-represented (e.g., age and high education/SES)</p>
</section>
<section id="mr.p" class="slide level2">
<h2>Mr.P</h2>
<p>Improving predictions by incorporating outside (of the model) information. MRP = multilevel regression with poststratification</p>
<p>One of the biggest problems with psych data is that it is unrepresentative. (Do you trust undergrads or adults off the street wanting to help science?)</p>
<p>If we know the distribution of the broader population, we can reweight (post-stratify) our results to get more accurate estimates. We take the observed sample to reconstruct the rest of the population</p>
</section>
<section id="mr.p-1" class="slide level2">
<h2>Mr.P</h2>
<p>Mr = Multi-level regression aka MLM P = poststratification, with post for posterior and stratification for stratify.</p>
<p>You take your posterior and make predictions based on different strata</p>
<p>Weighted average of predicted values, where weights are the population shares of each category</p>
</section>
<section id="weighting-vs-postratifying" class="slide level2">
<h2>Weighting vs postratifying</h2>
<p>Weighting is done all the time with data. It gives more or less “weight” to observations that are over or under sampled. Some people “count” more than others in the service of getting data that represents some population.</p>
<p>Poststratification is similar in that it weights the posterior samples rather than the observations.</p>
<p>Why is this preferred? A few reasons, but mainly one can make generalization to new groups or groups with little data. Rather than weighting those specific individuals, partial pooling from other information will help with learning</p>
</section>
<section class="slide level2">

<p>What do we need? A reliable data source (such as a census) that gives us the population weights. Data can be re-weighted based on many different categories, not just one: for example, we could post-stratify based on age, education, state of residence, etc.</p>
<p>Don’t need to even attempt a random sample. All we need is a sample that is large and diverse enough + population data (e.g., from the census).</p>
</section>
<section class="slide level2">

<p>Estimating the proportion of heterosexual women who kept their maiden name after marriage.</p>
<p>https://www.monicaalexander.com/posts/2019-08-07-mrp/ https://bookdown.org/content/4857/models-with-memory.html#summary-bonus-post-stratification-in-an-example</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mrp <span class="ot">&lt;-</span><span class="fu">load</span>(<span class="st">"mrp.rds"</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>mrp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d"           "cell_counts"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,413 × 5
   kept_name state_name     age_group decade_married educ_group
       &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;     
 1         0 ohio           50        1979           &gt;BA       
 2         0 virginia       35        1999           &gt;BA       
 3         1 new york       35        2009           &gt;BA       
 4         0 rhode island   55        1999           &gt;BA       
 5         0 illinois       35        2009           &gt;BA       
 6         0 north carolina 25        2009           &gt;BA       
 7         1 iowa           35        1999           &gt;BA       
 8         1 texas          35        2009           &gt;BA       
 9         0 south dakota   35        1999           &gt;BA       
10         0 texas          35        2009           &gt;BA       
# ℹ 4,403 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>cell_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,058 × 5
   state_name age_group decade_married educ_group     n
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;
 1 alabama    25        1999           &lt;BA        19012
 2 alabama    25        2009           &lt;BA        37488
 3 alabama    25        1999           &gt;BA          959
 4 alabama    25        2009           &gt;BA         5319
 5 alabama    25        1999           BA          2986
 6 alabama    25        2009           BA         14261
 7 alaska     25        1999           &lt;BA         3320
 8 alaska     25        2009           &lt;BA         7001
 9 alaska     25        1999           &gt;BA          159
10 alaska     25        2009           &gt;BA          435
# ℹ 6,048 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>mlm.mrp <span class="ot">&lt;-</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> binomial,</span>
<span id="cb39-3"><a href="#cb39-3"></a>      kept_name <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> age_group) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> decade_married) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> educ_group) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> state_name),</span>
<span id="cb39-4"><a href="#cb39-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb39-5"><a href="#cb39-5"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd)),</span>
<span id="cb39-6"><a href="#cb39-6"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb39-7"><a href="#cb39-7"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">98</span>),</span>
<span id="cb39-8"><a href="#cb39-8"></a>      <span class="at">data =</span> d,</span>
<span id="cb39-9"><a href="#cb39-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb39-10"><a href="#cb39-10"></a>      <span class="at">file =</span> <span class="st">"mlm.mrp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">summary</span>(mlm.mrp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: kept_name | trials(1) ~ 1 + (1 | age_group) + (1 | decade_married) + (1 | educ_group) + (1 | state_name) 
   Data: d (Number of observations: 4373) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~age_group (Number of levels: 11) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     1.15      0.29     0.72     1.88 1.00     1470     2235

~decade_married (Number of levels: 5) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     1.00      0.39     0.49     2.03 1.00     2246     2946

~educ_group (Number of levels: 4) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.92      0.49     0.35     2.17 1.00     2553     2773

~state_name (Number of levels: 52) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.25      0.06     0.15     0.38 1.00     1407     2328

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    -0.72      0.63    -1.99     0.50 1.00     1966     2475

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">get_variables</span>(mlm.mrp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "b_Intercept"                                 
 [2] "sd_age_group__Intercept"                     
 [3] "sd_decade_married__Intercept"                
 [4] "sd_educ_group__Intercept"                    
 [5] "sd_state_name__Intercept"                    
 [6] "r_age_group[25,Intercept]"                   
 [7] "r_age_group[30,Intercept]"                   
 [8] "r_age_group[35,Intercept]"                   
 [9] "r_age_group[40,Intercept]"                   
[10] "r_age_group[45,Intercept]"                   
[11] "r_age_group[50,Intercept]"                   
[12] "r_age_group[55,Intercept]"                   
[13] "r_age_group[60,Intercept]"                   
[14] "r_age_group[65,Intercept]"                   
[15] "r_age_group[70,Intercept]"                   
[16] "r_age_group[75,Intercept]"                   
[17] "r_decade_married[1979,Intercept]"            
[18] "r_decade_married[1989,Intercept]"            
[19] "r_decade_married[1999,Intercept]"            
[20] "r_decade_married[2009,Intercept]"            
[21] "r_decade_married[2019,Intercept]"            
[22] "r_educ_group[&lt;BA,Intercept]"                 
[23] "r_educ_group[&gt;BA,Intercept]"                 
[24] "r_educ_group[BA,Intercept]"                  
[25] "r_educ_group[NA,Intercept]"                  
[26] "r_state_name[alabama,Intercept]"             
[27] "r_state_name[alaska,Intercept]"              
[28] "r_state_name[arizona,Intercept]"             
[29] "r_state_name[arkansas,Intercept]"            
[30] "r_state_name[california,Intercept]"          
[31] "r_state_name[colorado,Intercept]"            
[32] "r_state_name[connecticut,Intercept]"         
[33] "r_state_name[delaware,Intercept]"            
[34] "r_state_name[district.of.columbia,Intercept]"
[35] "r_state_name[florida,Intercept]"             
[36] "r_state_name[georgia,Intercept]"             
[37] "r_state_name[hawaii,Intercept]"              
[38] "r_state_name[idaho,Intercept]"               
[39] "r_state_name[illinois,Intercept]"            
[40] "r_state_name[indiana,Intercept]"             
[41] "r_state_name[iowa,Intercept]"                
[42] "r_state_name[kansas,Intercept]"              
[43] "r_state_name[kentucky,Intercept]"            
[44] "r_state_name[louisiana,Intercept]"           
[45] "r_state_name[maine,Intercept]"               
[46] "r_state_name[maryland,Intercept]"            
[47] "r_state_name[massachusetts,Intercept]"       
[48] "r_state_name[michigan,Intercept]"            
[49] "r_state_name[minnesota,Intercept]"           
[50] "r_state_name[mississippi,Intercept]"         
[51] "r_state_name[missouri,Intercept]"            
[52] "r_state_name[montana,Intercept]"             
[53] "r_state_name[nebraska,Intercept]"            
[54] "r_state_name[nevada,Intercept]"              
[55] "r_state_name[new.hampshire,Intercept]"       
[56] "r_state_name[new.jersey,Intercept]"          
[57] "r_state_name[new.mexico,Intercept]"          
[58] "r_state_name[new.york,Intercept]"            
[59] "r_state_name[north.carolina,Intercept]"      
[60] "r_state_name[north.dakota,Intercept]"        
[61] "r_state_name[ohio,Intercept]"                
[62] "r_state_name[oklahoma,Intercept]"            
[63] "r_state_name[oregon,Intercept]"              
[64] "r_state_name[pennsylvania,Intercept]"        
[65] "r_state_name[puerto.rico,Intercept]"         
[66] "r_state_name[rhode.island,Intercept]"        
[67] "r_state_name[south.carolina,Intercept]"      
[68] "r_state_name[south.dakota,Intercept]"        
[69] "r_state_name[tennessee,Intercept]"           
[70] "r_state_name[texas,Intercept]"               
[71] "r_state_name[utah,Intercept]"                
[72] "r_state_name[vermont,Intercept]"             
[73] "r_state_name[virginia,Intercept]"            
[74] "r_state_name[washington,Intercept]"          
[75] "r_state_name[west.virginia,Intercept]"       
[76] "r_state_name[wisconsin,Intercept]"           
[77] "r_state_name[wyoming,Intercept]"             
[78] "lprior"                                      
[79] "lp__"                                        
[80] "accept_stat__"                               
[81] "treedepth__"                                 
[82] "stepsize__"                                  
[83] "divergent__"                                 
[84] "n_leapfrog__"                                
[85] "energy__"                                    </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">posterior_samples</span>(mlm.mrp) <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"sd_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">set_names</span>(<span class="fu">str_c</span>(<span class="st">"sigma["</span>, <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"decade~married"</span>, <span class="st">"education"</span>, <span class="st">"state"</span>), <span class="st">"]"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>  <span class="fu">median_qi</span>(<span class="at">.width =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">70</span>, <span class="at">to =</span> .<span class="dv">95</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>  </span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> <span class="fu">reorder</span>(name, value))) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .width), <span class="at">color =</span> <span class="st">"orange3"</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>  <span class="fu">scale_alpha_continuous</span>(<span class="st">"CI width"</span>, <span class="at">range =</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb44-14"><a href="#cb44-14"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-29-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Census data we will use to make predictions. We will make predictions for every combination of variable we are interested in (state, age, decade married, edu)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>age_prop <span class="ot">&lt;-</span> </span>
<span id="cb45-2"><a href="#cb45-2"></a>  cell_counts <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb45-6"><a href="#cb45-6"></a></span>
<span id="cb45-7"><a href="#cb45-7"></a>age_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,058 × 6
   state_name age_group decade_married educ_group     n      prop
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 alabama    25        1999           &lt;BA        19012 0.00414  
 2 alabama    25        2009           &lt;BA        37488 0.00816  
 3 alabama    25        1999           &gt;BA          959 0.000209 
 4 alabama    25        2009           &gt;BA         5319 0.00116  
 5 alabama    25        1999           BA          2986 0.000650 
 6 alabama    25        2009           BA         14261 0.00310  
 7 alaska     25        1999           &lt;BA         3320 0.000723 
 8 alaska     25        2009           &lt;BA         7001 0.00152  
 9 alaska     25        1999           &gt;BA          159 0.0000346
10 alaska     25        2009           &gt;BA          435 0.0000947
# ℹ 6,048 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>p <span class="ot">&lt;-</span> mlm.mrp <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">add_predicted_draws</span>(<span class="at">newdata =</span> age_prop <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3"></a>                        <span class="fu">filter</span>(age_group <span class="sc">&gt;</span> <span class="dv">20</span>, </span>
<span id="cb47-4"><a href="#cb47-4"></a>                               age_group <span class="sc">&lt;</span> <span class="dv">80</span>, </span>
<span id="cb47-5"><a href="#cb47-5"></a>                               decade_married <span class="sc">&gt;</span> <span class="dv">1969</span>),</span>
<span id="cb47-6"><a href="#cb47-6"></a>                      <span class="at">allow_new_levels =</span> T)</span>
<span id="cb47-7"><a href="#cb47-7"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24,232,000 × 11
# Groups:   state_name, age_group, decade_married, educ_group, n, prop, .row
#   [6,058]
   state_name age_group decade_married educ_group     n    prop  .row .chain
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;
 1 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 2 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 3 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 4 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 5 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 6 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 7 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 8 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
 9 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
10 alabama    25        1999           &lt;BA        19012 0.00414     1     NA
# ℹ 24,231,990 more rows
# ℹ 3 more variables: .iteration &lt;int&gt;, .draw &lt;int&gt;, .prediction &lt;int&gt;</code></pre>
</div>
</div>
<p>6,058 census categories * 4,000 samples = 24,232,000</p>
</section>
<section class="slide level2">

<p>If we group the results by age_group and .draw, we can sum the product of the posterior predictions and the weights (prop), which will leave us with 4,000 stratified posterior draws for each of the 11 levels of age_group</p>
<p><span class="math display">\[\frac{\sum_i N_i p_i}{\sum_i N_i}\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>pp <span class="ot">&lt;-</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>  p <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">group_by</span>(age_group, .draw) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">summarise</span>(<span class="at">kept_name_predict =</span> <span class="fu">sum</span>(.prediction <span class="sc">*</span> prop)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="fu">mean_qi</span>(kept_name_predict)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 7
   age_group kept_name_predict .lower .upper .width .point .interval
   &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1 25                    0.175 0.0926  0.278   0.95 mean   qi       
 2 30                    0.182 0.117   0.261   0.95 mean   qi       
 3 35                    0.218 0.150   0.299   0.95 mean   qi       
 4 40                    0.244 0.172   0.329   0.95 mean   qi       
 5 45                    0.277 0.201   0.364   0.95 mean   qi       
 6 50                    0.301 0.219   0.392   0.95 mean   qi       
 7 55                    0.324 0.232   0.424   0.95 mean   qi       
 8 60                    0.437 0.328   0.554   0.95 mean   qi       
 9 65                    0.561 0.418   0.706   0.95 mean   qi       
10 70                    0.515 0.297   0.754   0.95 mean   qi       
11 75                    0.226 0.0431  0.530   0.95 mean   qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb51-2"><a href="#cb51-2"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"raw data"</span>, <span class="st">"multilevel"</span>, <span class="st">"MRP"</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a></span>
<span id="cb51-4"><a href="#cb51-4"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="co"># compute the proportions from the data</span></span>
<span id="cb51-6"><a href="#cb51-6"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb51-7"><a href="#cb51-7"></a>  <span class="fu">group_by</span>(age_group, kept_name) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb51-9"><a href="#cb51-9"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb51-10"><a href="#cb51-10"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n),</span>
<span id="cb51-11"><a href="#cb51-11"></a>         <span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"raw data"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-12"><a href="#cb51-12"></a>  <span class="fu">filter</span>(kept_name <span class="sc">==</span> <span class="dv">1</span>, age_group <span class="sc">&lt;</span> <span class="dv">80</span>, age_group <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb51-14"><a href="#cb51-14"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb51-17"><a href="#cb51-17"></a></span>
<span id="cb51-18"><a href="#cb51-18"></a></span>
<span id="cb51-19"><a href="#cb51-19"></a>nd <span class="ot">&lt;-</span> <span class="fu">distinct</span>(d, age_group) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(age_group)</span>
<span id="cb51-20"><a href="#cb51-20"></a></span>
<span id="cb51-21"><a href="#cb51-21"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb51-22"><a href="#cb51-22"></a>  <span class="fu">fitted</span>(mlm.mrp,</span>
<span id="cb51-23"><a href="#cb51-23"></a>         <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> age_group),</span>
<span id="cb51-24"><a href="#cb51-24"></a>         <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb51-25"><a href="#cb51-25"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-26"><a href="#cb51-26"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb51-27"><a href="#cb51-27"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> Estimate,</span>
<span id="cb51-28"><a href="#cb51-28"></a>         <span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"multilevel"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-29"><a href="#cb51-29"></a>  </span>
<span id="cb51-30"><a href="#cb51-30"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb51-31"><a href="#cb51-31"></a>  <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"blue2"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">fatten =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb51-32"><a href="#cb51-32"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb51-33"><a href="#cb51-33"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb51-34"><a href="#cb51-34"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb51-35"><a href="#cb51-35"></a></span>
<span id="cb51-36"><a href="#cb51-36"></a></span>
<span id="cb51-37"><a href="#cb51-37"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb51-38"><a href="#cb51-38"></a>  pp <span class="sc">%&gt;%</span></span>
<span id="cb51-39"><a href="#cb51-39"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(<span class="st">"MRP"</span>, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-40"><a href="#cb51-40"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> kept_name_predict, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> age_group)) <span class="sc">+</span> </span>
<span id="cb51-41"><a href="#cb51-41"></a>  <span class="fu">geom_pointrange</span>(<span class="at">color =</span> <span class="st">"orange2"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">fatten =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb51-42"><a href="#cb51-42"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb51-43"><a href="#cb51-43"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb51-44"><a href="#cb51-44"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span>
<span id="cb51-45"><a href="#cb51-45"></a></span>
<span id="cb51-46"><a href="#cb51-46"></a><span class="co"># combine!</span></span>
<span id="cb51-47"><a href="#cb51-47"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">+</span></span>
<span id="cb51-48"><a href="#cb51-48"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Proportion of women keeping name after marriage, by age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Can also be done simply in {marginaleffects}</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predictions</span>(  <span class="co"># Compute predictions,</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>    <span class="at">model =</span> mod, <span class="co"># using the mlm model `mod`, </span></span>
<span id="cb52-3"><a href="#cb52-3"></a>    <span class="at">newdata =</span> stratification, <span class="co"># for each row of the `stratification` table.</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>    <span class="at">by =</span> <span class="st">"age"</span>, <span class="co">#select which grouping variable</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>    <span class="at">wts =</span> <span class="st">"proportion"</span>) <span class="co">#weight them</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mr.p-not-limited-to-surveys" class="slide level2">
<h2>Mr.P Not limited to surveys</h2>
<p>Example (using brms) with experimental data – can you generalize from your sample of undergraduates to other undergraduates at your university, let alone undergraduates in general, let alone young adults, to say nothing about the population of humans. https://arxiv.org/pdf/1906.11323.pdf</p>
<p>More info: https://marginaleffects.com/articles/mrp.html</p>
</section>
<section id="recent-example" class="slide level2">
<h2>recent example</h2>
<p>https://osf.io/preprints/psyarxiv/fcm3n/</p>

<img data-src="mrp.png" class="r-stretch"></section>
<section id="multivariate-models" class="slide level2">
<h2>Multivariate models</h2>
<p>Any model that has more than 1 DV. While common within SEM frameworks, multivariate models are not often used within standard linear modeling (outside of MANOVA), mostly because of computational difficulties.</p>
<p>When do you want to use multivariate models? All the time! Mediation, path models, distributional models, IRT models, parallel process MLMs, etc etc. What are advantages? Fewer models than doing separate, additional parameters, novel Qs.</p>
<p>We’ve already done one of these: the multinomial logistic</p>
</section>
<section id="multivariate-mlms" class="slide level2">
<h2>multivariate MLMs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="fu">library</span>(modelr)</span>
<span id="cb53-5"><a href="#cb53-5"></a></span>
<span id="cb53-6"><a href="#cb53-6"></a>data <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/josh-jackson/bayes/master/mlm.csv"</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>mlm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>mv<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb54-3"><a href="#cb54-3"></a>      <span class="fu">mvbind</span>(CON, DAN) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> ID),</span>
<span id="cb54-4"><a href="#cb54-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb54-5"><a href="#cb54-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb54-6"><a href="#cb54-6"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor),</span>
<span id="cb54-7"><a href="#cb54-7"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> rescor)),</span>
<span id="cb54-8"><a href="#cb54-8"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb54-9"><a href="#cb54-9"></a>      <span class="at">file =</span> <span class="st">"mv.1"</span>,</span>
<span id="cb54-10"><a href="#cb54-10"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb54-11"><a href="#cb54-11"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">summary</span>(mv<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: CON ~ 1 + time + (1 + time | ID) 
         DAN ~ 1 + time + (1 + time | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 91) 
                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(CON_Intercept)               0.06      0.01     0.05     0.07 1.00     3633
sd(CON_time)                    0.00      0.00     0.00     0.01 1.00     1308
sd(DAN_Intercept)               0.04      0.01     0.03     0.05 1.00     2647
sd(DAN_time)                    0.00      0.00     0.00     0.01 1.00      862
cor(CON_Intercept,CON_time)    -0.13      0.39    -0.77     0.70 1.00     6805
cor(DAN_Intercept,DAN_time)    -0.04      0.41    -0.75     0.77 1.00     6734
                            Tail_ESS
sd(CON_Intercept)               4618
sd(CON_time)                    1914
sd(DAN_Intercept)               2757
sd(DAN_time)                     426
cor(CON_Intercept,CON_time)     6264
cor(DAN_Intercept,DAN_time)     6734

Population-Level Effects: 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
CON_Intercept     0.19      0.01     0.18     0.21 1.00     4740     7147
DAN_Intercept     0.20      0.01     0.19     0.22 1.00     7390     8949
CON_time         -0.00      0.00    -0.01     0.00 1.00     9513    10010
DAN_time         -0.01      0.00    -0.01    -0.00 1.00    11311     7447

Family Specific Parameters: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_CON     0.05      0.00     0.04     0.05 1.00     3485     4099
sigma_DAN     0.05      0.00     0.04     0.06 1.00     1319      444

Residual Correlations: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
rescor(CON,DAN)     0.12      0.09    -0.05     0.30 1.00     2631     1949

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">fixef</span>(mv<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Estimate   Est.Error         Q2.5         Q97.5
CON_Intercept  0.194401583 0.007755149  0.179150800  0.2096571000
DAN_Intercept  0.203508451 0.006666302  0.190382950  0.2165806000
CON_time      -0.002897454 0.002302044 -0.007350416  0.0016120035
DAN_time      -0.005130118 0.002269263 -0.009560008 -0.0007081081</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>mv<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">gather_draws</span>(sd_ID__CON_Intercept, sd_ID__CON_time, sd_ID__DAN_Intercept, sd_ID__DAN_time, cor_ID__CON_Intercept__CON_time, cor_ID__DAN_Intercept__DAN_time, rescor__CON__DAN) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3"></a>   <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  .variable                       .value   .lower .upper .width .point .interval
  &lt;chr&gt;                            &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 cor_ID__CON_Intercept__CON_t… -0.175   -7.68e-1 0.699    0.95 median qi       
2 cor_ID__DAN_Intercept__DAN_t… -0.0640  -7.53e-1 0.766    0.95 median qi       
3 rescor__CON__DAN               0.121   -5.33e-2 0.298    0.95 median qi       
4 sd_ID__CON_Intercept           0.0563   4.51e-2 0.0704   0.95 median qi       
5 sd_ID__CON_time                0.00397  1.96e-4 0.0126   0.95 median qi       
6 sd_ID__DAN_Intercept           0.0413   2.97e-2 0.0537   0.95 median qi       
7 sd_ID__DAN_time                0.00378  1.42e-4 0.0127   0.95 median qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>mv<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">spread_draws</span>(sd_ID__CON_time) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">x =</span> sd_ID__CON_time))<span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="fu">stat_halfeye</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-40-1.png" width="960" class="r-stretch"></section>
<section id="correlation-between-slopes" class="slide level2">
<h2>correlation between slopes</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">library</span>(correlation)</span>
<span id="cb62-2"><a href="#cb62-2"></a></span>
<span id="cb62-3"><a href="#cb62-3"></a>CON_slope <span class="ot">&lt;-</span> mv<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="fu">spread_draws</span>(r_ID__CON[ID,time]) <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-6"><a href="#cb62-6"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7"></a>  <span class="fu">median_qi</span>(r_ID__CON) <span class="sc">%&gt;%</span> </span>
<span id="cb62-8"><a href="#cb62-8"></a>  <span class="fu">select</span>(ID, r_ID__CON)</span>
<span id="cb62-9"><a href="#cb62-9"></a></span>
<span id="cb62-10"><a href="#cb62-10"></a>DAN_slope <span class="ot">&lt;-</span> mv<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb62-11"><a href="#cb62-11"></a><span class="fu">spread_draws</span>(r_ID__DAN[ID,time]) <span class="sc">%&gt;%</span> </span>
<span id="cb62-12"><a href="#cb62-12"></a>  <span class="fu">filter</span>(time <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-13"><a href="#cb62-13"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb62-14"><a href="#cb62-14"></a>  <span class="fu">median_qi</span>(r_ID__DAN) <span class="sc">%&gt;%</span> </span>
<span id="cb62-15"><a href="#cb62-15"></a>  <span class="fu">select</span>(ID, r_ID__DAN)</span>
<span id="cb62-16"><a href="#cb62-16"></a></span>
<span id="cb62-17"><a href="#cb62-17"></a>slope_cor<span class="ot">&lt;-</span> <span class="fu">left_join</span>(CON_slope,DAN_slope)</span>
<span id="cb62-18"><a href="#cb62-18"></a><span class="fu">plot</span>(<span class="fu">cor_test</span>(slope_cor, <span class="st">"r_ID__CON"</span>, <span class="st">"r_ID__DAN"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-41-1.png" width="960" class="r-stretch"></section>
<section id="everything-is-sem" class="slide level2">
<h2>Everything is SEM</h2>
<p>Structural equation modeling (SEM) is the most popular way to handle multiple DVs. SEM is also known as covariance structure analysis, which really means unstandardized correlations. We can fit some simple SEM models using brms!</p>
<p>Also, SEM is really regression but a broader form. Also SEM can be equivalent to MLM in many respects.</p>
</section>
<section id="correlations-as-multivariate-models" class="slide level2">
<h2>correlations (as multivariate models)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>mv<span class="fl">.1</span>c <span class="ot">&lt;-</span> </span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb63-3"><a href="#cb63-3"></a>      <span class="fu">bf</span>(<span class="fu">mvbind</span>(CON, DAN) <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>      <span class="fu">set_rescor</span>(<span class="cn">TRUE</span>),</span>
<span id="cb63-5"><a href="#cb63-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> CON),</span>
<span id="cb63-6"><a href="#cb63-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> DAN),</span>
<span id="cb63-7"><a href="#cb63-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> CON),</span>
<span id="cb63-8"><a href="#cb63-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> DAN),</span>
<span id="cb63-9"><a href="#cb63-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> rescor)),</span>
<span id="cb63-10"><a href="#cb63-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb63-11"><a href="#cb63-11"></a>      <span class="at">file =</span> <span class="st">"mv.1c"</span>,</span>
<span id="cb63-12"><a href="#cb63-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb63-13"><a href="#cb63-13"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">summary</span>(mv<span class="fl">.1</span>c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: CON ~ 1 
         DAN ~ 1 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Population-Level Effects: 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
CON_Intercept     0.19      0.00     0.18     0.20 1.00    14697     9363
DAN_Intercept     0.19      0.00     0.19     0.20 1.00    15634     9714

Family Specific Parameters: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_CON     0.07      0.00     0.07     0.08 1.00    12996     8947
sigma_DAN     0.06      0.00     0.06     0.07 1.00    12810     8728

Residual Correlations: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
rescor(CON,DAN)     0.26      0.06     0.14     0.38 1.00    12059     8823

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>mv<span class="fl">.1</span>c <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">spread_draws</span>(rescor__CON__DAN) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">mean_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  rescor__CON__DAN .lower .upper .width .point .interval
             &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1            0.262  0.136  0.380   0.95 mean   qi       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">cor</span>(mlm<span class="sc">$</span>CON, mlm<span class="sc">$</span>DAN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2657764</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Make it robust</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>mv<span class="fl">.1</span>cr <span class="ot">&lt;-</span> </span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> student,</span>
<span id="cb70-3"><a href="#cb70-3"></a>      <span class="fu">bf</span>(<span class="fu">mvbind</span>(CON, DAN) <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4"></a>      <span class="fu">set_rescor</span>(<span class="cn">TRUE</span>),</span>
<span id="cb70-5"><a href="#cb70-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">gamma</span>(<span class="dv">2</span>, .<span class="dv">1</span>), <span class="at">class =</span> nu),</span>
<span id="cb70-6"><a href="#cb70-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> CON),</span>
<span id="cb70-7"><a href="#cb70-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> DAN),</span>
<span id="cb70-8"><a href="#cb70-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> CON),</span>
<span id="cb70-9"><a href="#cb70-9"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> DAN),</span>
<span id="cb70-10"><a href="#cb70-10"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> rescor)),</span>
<span id="cb70-11"><a href="#cb70-11"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb70-12"><a href="#cb70-12"></a>      <span class="at">file =</span> <span class="st">"mv.1cr"</span>,</span>
<span id="cb70-13"><a href="#cb70-13"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb70-14"><a href="#cb70-14"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">summary</span>(mv<span class="fl">.1</span>cr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(student, student) 
  Links: mu = identity; sigma = identity; nu = identity
         mu = identity; sigma = identity; nu = identity 
Formula: CON ~ 1 
         DAN ~ 1 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Population-Level Effects: 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
CON_Intercept     0.19      0.00     0.18     0.20 1.00    18108     9153
DAN_Intercept     0.19      0.00     0.18     0.20 1.00    17472     9281

Family Specific Parameters: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_CON     0.07      0.00     0.06     0.08 1.00    11443     9110
sigma_DAN     0.06      0.00     0.05     0.07 1.00    10716     8829
nu           20.82     11.04     8.07    50.10 1.00    10262     9456
nu_CON        1.00      0.00     1.00     1.00   NA       NA       NA
nu_DAN        1.00      0.00     1.00     1.00   NA       NA       NA

Residual Correlations: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
rescor(CON,DAN)     0.26      0.07     0.12     0.38 1.00    14092     8842

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb73-2"><a href="#cb73-2"></a>g1 <span class="ot">&lt;-</span> mv<span class="fl">.1</span>c <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3"></a>  <span class="fu">spread_draws</span>(rescor__CON__DAN) <span class="sc">%&gt;%</span> </span>
<span id="cb73-4"><a href="#cb73-4"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">x =</span> rescor__CON__DAN))<span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5"></a>    <span class="fu">stat_pointinterval</span>() <span class="sc">+</span><span class="fu">xlim</span>(.<span class="dv">1</span>,.<span class="dv">4</span>)</span>
<span id="cb73-6"><a href="#cb73-6"></a></span>
<span id="cb73-7"><a href="#cb73-7"></a>g2 <span class="ot">&lt;-</span> mv<span class="fl">.1</span>cr <span class="sc">%&gt;%</span> </span>
<span id="cb73-8"><a href="#cb73-8"></a>  <span class="fu">spread_draws</span>(rescor__CON__DAN) <span class="sc">%&gt;%</span> </span>
<span id="cb73-9"><a href="#cb73-9"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">x =</span> rescor__CON__DAN))<span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10"></a>    <span class="fu">stat_pointinterval</span>()<span class="sc">+</span><span class="fu">xlim</span>(.<span class="dv">1</span>,.<span class="dv">4</span>)</span>
<span id="cb73-11"><a href="#cb73-11"></a></span>
<span id="cb73-12"><a href="#cb73-12"></a>(g1 <span class="sc">/</span> g2)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-48-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Residual correlations are useful because they can be conceptualized as what is left over in the DV after accounting for your predictors. Or it is a measure of your DV controlling/adjusting for the predictors.</p>
<p>What can we do with this outside of looking at correlations?</p>
</section>
<section id="simple-mediation" class="slide level2">
<h2>Simple mediation</h2>
<p><span class="math display">\[M  = i_M + a X + e_M\]</span> <span class="math display">\[Y  = i_Y + c' X + b M + e_Y\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb74-2"><a href="#cb74-2"></a></span>
<span id="cb74-3"><a href="#cb74-3"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"M"</span>, <span class="st">"Y"</span>),</span>
<span id="cb74-5"><a href="#cb74-5"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb74-6"><a href="#cb74-6"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb74-7"><a href="#cb74-7"></a></span>
<span id="cb74-8"><a href="#cb74-8"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb74-9"><a href="#cb74-9"></a>  <span class="fu">dagify</span>(M <span class="sc">~</span> X,</span>
<span id="cb74-10"><a href="#cb74-10"></a>       Y <span class="sc">~</span> X <span class="sc">+</span> M,</span>
<span id="cb74-11"><a href="#cb74-11"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="#cb74-12"></a>  </span>
<span id="cb74-13"><a href="#cb74-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb74-14"><a href="#cb74-14"></a>  <span class="fu">geom_dag_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb74-15"><a href="#cb74-15"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb74-16"><a href="#cb74-16"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb74-17"><a href="#cb74-17"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb74-18"><a href="#cb74-18"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb74-19"><a href="#cb74-19"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb74-20"><a href="#cb74-20"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb74-21"><a href="#cb74-21"></a>  <span class="fu">ggtitle</span>(<span class="st">"direct + indirect effect"</span>)</span>
<span id="cb74-22"><a href="#cb74-22"></a></span>
<span id="cb74-23"><a href="#cb74-23"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb74-24"><a href="#cb74-24"></a>  <span class="fu">dagify</span>(Y <span class="sc">~</span> X,</span>
<span id="cb74-25"><a href="#cb74-25"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb74-26"><a href="#cb74-26"></a>  </span>
<span id="cb74-27"><a href="#cb74-27"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb74-28"><a href="#cb74-28"></a>  <span class="fu">geom_dag_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb74-29"><a href="#cb74-29"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb74-30"><a href="#cb74-30"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb74-31"><a href="#cb74-31"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb74-32"><a href="#cb74-32"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb74-33"><a href="#cb74-33"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb74-34"><a href="#cb74-34"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb74-35"><a href="#cb74-35"></a>  <span class="fu">ggtitle</span>(<span class="st">"Total effect"</span>)</span>
<span id="cb74-36"><a href="#cb74-36"></a></span>
<span id="cb74-37"><a href="#cb74-37"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb74-38"><a href="#cb74-38"></a></span>
<span id="cb74-39"><a href="#cb74-39"></a>p2 <span class="sc">|</span> p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-49-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb75-2"><a href="#cb75-2"></a>M <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb75-3"><a href="#cb75-3"></a>Y <span class="ot">&lt;-</span> <span class="fl">0.7</span><span class="sc">*</span>M <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb75-4"><a href="#cb75-4"></a>Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y, <span class="at">M =</span> M)</span>
<span id="cb75-5"><a href="#cb75-5"></a></span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="co"># describe your equations</span></span>
<span id="cb75-7"><a href="#cb75-7"></a>y_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(Y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M)</span>
<span id="cb75-8"><a href="#cb75-8"></a>m_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(M <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X)</span>
<span id="cb75-9"><a href="#cb75-9"></a></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="co"># simultaneously estimate</span></span>
<span id="cb75-11"><a href="#cb75-11"></a>med<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb75-12"><a href="#cb75-12"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb75-13"><a href="#cb75-13"></a>      y_model <span class="sc">+</span> m_model <span class="sc">+</span> <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>),</span>
<span id="cb75-14"><a href="#cb75-14"></a>      <span class="at">data =</span> Data,</span>
<span id="cb75-15"><a href="#cb75-15"></a>      <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb75-16"><a href="#cb75-16"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb75-17"><a href="#cb75-17"></a>      <span class="at">file =</span> <span class="st">"med.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">summary</span>(med<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: Y ~ 1 + X + M 
         M ~ 1 + X 
   Data: Data (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Y_Intercept    -0.03      0.09    -0.20     0.15 1.00     6280     2928
M_Intercept    -0.14      0.10    -0.34     0.06 1.00     6715     2906
Y_X             0.27      0.10     0.08     0.47 1.00     5434     3172
Y_M             0.75      0.09     0.56     0.92 1.00     5293     2808
M_X             0.25      0.11     0.03     0.47 1.00     5652     3212

Family Specific Parameters: 
        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_Y     0.91      0.07     0.79     1.06 1.00     5265     3088
sigma_M     1.02      0.07     0.89     1.18 1.00     6467     2876

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="indirect-effects" class="slide level2">
<h2>Indirect effects</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="fu">get_variables</span>(med<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "b_Y_Intercept" "b_M_Intercept" "b_Y_X"         "b_Y_M"        
 [5] "b_M_X"         "sigma_Y"       "sigma_M"       "lprior"       
 [9] "lp__"          "accept_stat__" "treedepth__"   "stepsize__"   
[13] "divergent__"   "n_leapfrog__"  "energy__"     </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>med<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="#cb80-2"></a>  <span class="fu">spread_draws</span>(b_Y_M, b_M_X,b_Y_X) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,000 × 6
   .chain .iteration .draw b_Y_M b_M_X b_Y_X
    &lt;int&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1      1          1     1 0.723 0.321 0.361
 2      1          2     2 0.823 0.195 0.254
 3      1          3     3 0.697 0.314 0.312
 4      1          4     4 0.787 0.133 0.242
 5      1          5     5 0.675 0.362 0.281
 6      1          6     6 0.847 0.247 0.223
 7      1          7     7 0.304 0.359 0.186
 8      1          8     8 0.695 0.318 0.248
 9      1          9     9 0.706 0.165 0.420
10      1         10    10 0.736 0.298 0.156
# ℹ 3,990 more rows</code></pre>
</div>
</div>
</section>
<section id="calculate-indirect-effects" class="slide level2">
<h2>calculate indirect effects</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>med<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2"></a>  <span class="fu">spread_draws</span>(b_Y_M, b_M_X, b_Y_X) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3"></a>  <span class="fu">mutate</span>(<span class="at">indirect =</span> b_Y_M <span class="sc">*</span> b_M_X) <span class="sc">%&gt;%</span> </span>
<span id="cb82-4"><a href="#cb82-4"></a>  <span class="fu">mutate</span>(<span class="at">direct =</span> b_Y_X) <span class="sc">%&gt;%</span> </span>
<span id="cb82-5"><a href="#cb82-5"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> indirect <span class="sc">+</span> direct ) <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="#cb82-6"></a>  <span class="fu">median_qi</span>(indirect, direct,total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  indirect indirect.lower indirect.upper direct direct.lower direct.upper total
     &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;
1    0.184         0.0256          0.371  0.273       0.0804        0.467 0.460
# ℹ 5 more variables: total.lower &lt;dbl&gt;, total.upper &lt;dbl&gt;, .width &lt;dbl&gt;,
#   .point &lt;chr&gt;, .interval &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>med<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2"></a>  <span class="fu">spread_draws</span>(b_Y_M, b_M_X, b_Y_X) <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="#cb84-3"></a>  <span class="fu">mutate</span>(<span class="at">indirect =</span> b_Y_M <span class="sc">*</span> b_M_X) <span class="sc">%&gt;%</span> </span>
<span id="cb84-4"><a href="#cb84-4"></a>  <span class="fu">mutate</span>(<span class="at">direct =</span> b_Y_X) <span class="sc">%&gt;%</span> </span>
<span id="cb84-5"><a href="#cb84-5"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> indirect <span class="sc">+</span> direct ) <span class="sc">%&gt;%</span> </span>
<span id="cb84-6"><a href="#cb84-6"></a>  <span class="fu">select</span>(indirect, direct, total) <span class="sc">%&gt;%</span> </span>
<span id="cb84-7"><a href="#cb84-7"></a>  <span class="fu">gather</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb84-8"><a href="#cb84-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> key, <span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb84-9"><a href="#cb84-9"></a>  <span class="fu">stat_dotsinterval</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-55-1.png" width="960" class="r-stretch"></section>
<section id="priors-for-mediation" class="slide level2">
<h2>priors for mediation</h2>
<p>7 parameters to estimate</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>med<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb85-3"><a href="#cb85-3"></a>      y_model <span class="sc">+</span> m_model <span class="sc">+</span> <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>),</span>
<span id="cb85-4"><a href="#cb85-4"></a>       <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> M),</span>
<span id="cb85-5"><a href="#cb85-5"></a>                 <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> Y),</span>
<span id="cb85-6"><a href="#cb85-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> b, <span class="at">coef =</span> X, <span class="at">resp =</span> M),</span>
<span id="cb85-7"><a href="#cb85-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> b, <span class="at">coef =</span> M, <span class="at">resp =</span> Y),</span>
<span id="cb85-8"><a href="#cb85-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> b, <span class="at">coef =</span> X, <span class="at">resp =</span> Y),</span>
<span id="cb85-9"><a href="#cb85-9"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> M),</span>
<span id="cb85-10"><a href="#cb85-10"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> Y)),</span>
<span id="cb85-11"><a href="#cb85-11"></a>      <span class="at">data =</span> Data,</span>
<span id="cb85-12"><a href="#cb85-12"></a>      <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb85-13"><a href="#cb85-13"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb85-14"><a href="#cb85-14"></a>      <span class="at">file =</span> <span class="st">"med.2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">summary</span>(med<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: Y ~ 1 + X + M 
         M ~ 1 + X 
   Data: Data (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Y_Intercept    -0.02      0.09    -0.21     0.15 1.00     5210     3072
M_Intercept    -0.13      0.10    -0.33     0.07 1.00     6012     2669
Y_X             0.27      0.10     0.07     0.47 1.00     5712     3234
Y_M             0.75      0.09     0.57     0.93 1.00     6451     3192
M_X             0.25      0.11     0.05     0.46 1.00     5492     2983

Family Specific Parameters: 
        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_Y     0.91      0.07     0.79     1.05 1.00     5801     3179
sigma_M     1.02      0.07     0.89     1.17 1.00     5559     3223

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>med<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2"></a>  <span class="fu">spread_draws</span>(b_Y_M, b_M_X) <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3"></a>  <span class="fu">mutate</span>(<span class="at">indirect =</span> b_Y_M <span class="sc">*</span> b_M_X) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4"></a>  <span class="fu">median_qi</span>(indirect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  indirect .lower .upper .width .point .interval
     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1    0.186 0.0360  0.354   0.95 median qi       </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>med<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="#cb90-2"></a>  <span class="fu">spread_draws</span>(b_Y_M, b_M_X) <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="#cb90-3"></a>  <span class="fu">mutate</span>(<span class="at">indirect =</span> b_Y_M <span class="sc">*</span> b_M_X) <span class="sc">%&gt;%</span> </span>
<span id="cb90-4"><a href="#cb90-4"></a>  <span class="fu">median_qi</span>(indirect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  indirect .lower .upper .width .point .interval
     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1    0.184 0.0256  0.371   0.95 median qi       </code></pre>
</div>
</div>
</section>
<section id="multiple-predictors-mediators-and-outcomes" class="slide level2">
<h2>Multiple Predictors, mediators and outcomes</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="fu">set.seed</span>(<span class="fl">4.5</span>)</span>
<span id="cb92-3"><a href="#cb92-3"></a>mult.X <span class="ot">&lt;-</span></span>
<span id="cb92-4"><a href="#cb92-4"></a>  <span class="fu">tibble</span>(<span class="at">X1 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb92-5"><a href="#cb92-5"></a>         <span class="at">X2 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb92-6"><a href="#cb92-6"></a>         <span class="at">X3 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-7"><a href="#cb92-7"></a>  <span class="fu">mutate</span>(<span class="at">med =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span> <span class="sc">+</span> X1 <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> X2 <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> X3 <span class="sc">*</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb92-8"><a href="#cb92-8"></a>         <span class="at">dv  =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span> <span class="sc">+</span> X1 <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> X2 <span class="sc">*</span> .<span class="dv">5</span> <span class="sc">+</span> X3 <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> M <span class="sc">*</span> .<span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>MultX_coords <span class="ot">&lt;-</span></span>
<span id="cb93-2"><a href="#cb93-2"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>,  <span class="st">"M"</span>, <span class="st">"Y"</span>),</span>
<span id="cb93-3"><a href="#cb93-3"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb93-4"><a href="#cb93-4"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb93-5"><a href="#cb93-5"></a></span>
<span id="cb93-6"><a href="#cb93-6"></a>X1 <span class="ot">&lt;-</span></span>
<span id="cb93-7"><a href="#cb93-7"></a>  <span class="fu">dagify</span>(M <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3,</span>
<span id="cb93-8"><a href="#cb93-8"></a>       Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> M,</span>
<span id="cb93-9"><a href="#cb93-9"></a>       <span class="at">coords =</span> MultX_coords) <span class="sc">%&gt;%</span></span>
<span id="cb93-10"><a href="#cb93-10"></a>  </span>
<span id="cb93-11"><a href="#cb93-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12"></a>  <span class="fu">geom_dag_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb93-13"><a href="#cb93-13"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb93-14"><a href="#cb93-14"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb93-15"><a href="#cb93-15"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb93-16"><a href="#cb93-16"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb93-17"><a href="#cb93-17"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-18"><a href="#cb93-18"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb93-19"><a href="#cb93-19"></a>  <span class="fu">ggtitle</span>(<span class="st">"direct + indirect effect"</span>)</span>
<span id="cb93-20"><a href="#cb93-20"></a>X1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-61-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>med<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb94-2"><a href="#cb94-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb94-3"><a href="#cb94-3"></a>      <span class="fu">bf</span>(dv <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> med) <span class="sc">+</span> </span>
<span id="cb94-4"><a href="#cb94-4"></a>        <span class="fu">bf</span>(med <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3) <span class="sc">+</span> </span>
<span id="cb94-5"><a href="#cb94-5"></a>        <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>),</span>
<span id="cb94-6"><a href="#cb94-6"></a>      <span class="at">data =</span> mult.X, </span>
<span id="cb94-7"><a href="#cb94-7"></a>      <span class="at">file =</span> <span class="st">"med.3"</span>, </span>
<span id="cb94-8"><a href="#cb94-8"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb94-9"><a href="#cb94-9"></a>      <span class="at">cores =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">summary</span>(med<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: dv ~ 1 + X1 + X2 + X3 + med 
         med ~ 1 + X1 + X2 + X3 
   Data: mult.X (Number of observations: 1000) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
dv_Intercept     -0.09      0.04    -0.16    -0.01 1.00     6626     2807
med_Intercept     0.00      0.03    -0.06     0.06 1.00     5649     3349
dv_X1             0.05      0.05    -0.05     0.14 1.00     2684     3091
dv_X2             0.58      0.04     0.51     0.65 1.00     5743     2598
dv_X3             1.00      0.05     0.90     1.10 1.00     2522     3050
dv_med           -0.02      0.04    -0.09     0.05 1.00     2258     2869
med_X1           -0.93      0.03    -0.99    -0.87 1.00     5494     3040
med_X2            0.03      0.03    -0.03     0.09 1.00     5379     3193
med_X3            0.98      0.03     0.92     1.04 1.00     5688     2817

Family Specific Parameters: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_dv      1.14      0.03     1.09     1.19 1.00     4593     2769
sigma_med     0.97      0.02     0.93     1.02 1.00     6043     3188

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>med<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="#cb97-2"></a>  <span class="fu">spread_draws</span>(b_dv_Intercept, b_med_Intercept, b_dv_X1, b_dv_X2, b_dv_X3, b_dv_med, b_med_X1, b_med_X2, b_med_X3) <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3"></a>  <span class="fu">mutate</span>(<span class="at">indirect1 =</span> b_dv_med <span class="sc">*</span> b_med_X1) <span class="sc">%&gt;%</span> </span>
<span id="cb97-4"><a href="#cb97-4"></a>  <span class="fu">mutate</span>(<span class="at">indirect2 =</span> b_dv_med <span class="sc">*</span> b_med_X2) <span class="sc">%&gt;%</span> </span>
<span id="cb97-5"><a href="#cb97-5"></a>  <span class="fu">mutate</span>(<span class="at">indirect3 =</span> b_dv_med <span class="sc">*</span> b_med_X3) <span class="sc">%&gt;%</span> </span>
<span id="cb97-6"><a href="#cb97-6"></a>  <span class="fu">mutate</span>(<span class="at">direct1 =</span> b_dv_X1) <span class="sc">%&gt;%</span> </span>
<span id="cb97-7"><a href="#cb97-7"></a>  <span class="fu">mutate</span>(<span class="at">direct2 =</span> b_dv_X2) <span class="sc">%&gt;%</span> </span>
<span id="cb97-8"><a href="#cb97-8"></a>  <span class="fu">mutate</span>(<span class="at">direct3 =</span> b_dv_X3) <span class="sc">%&gt;%</span> </span>
<span id="cb97-9"><a href="#cb97-9"></a>  <span class="fu">mutate</span>(<span class="at">total1 =</span> indirect1 <span class="sc">+</span> direct1 ) <span class="sc">%&gt;%</span> </span>
<span id="cb97-10"><a href="#cb97-10"></a>  <span class="fu">mutate</span>(<span class="at">total2 =</span> indirect2 <span class="sc">+</span> direct2 ) <span class="sc">%&gt;%</span> </span>
<span id="cb97-11"><a href="#cb97-11"></a>  <span class="fu">mutate</span>(<span class="at">total3 =</span> indirect3 <span class="sc">+</span> direct3 ) <span class="sc">%&gt;%</span> </span>
<span id="cb97-12"><a href="#cb97-12"></a>  <span class="fu">select</span>(.draw, indirect1<span class="sc">:</span>total3) <span class="sc">%&gt;%</span> </span>
<span id="cb97-13"><a href="#cb97-13"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 30
  indirect1 indirect1.lower indirect1.upper indirect2 indirect2.lower
      &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;           &lt;dbl&gt;
1    0.0210         -0.0456          0.0881 -0.000322        -0.00512
# ℹ 25 more variables: indirect2.upper &lt;dbl&gt;, indirect3 &lt;dbl&gt;,
#   indirect3.lower &lt;dbl&gt;, indirect3.upper &lt;dbl&gt;, direct1 &lt;dbl&gt;,
#   direct1.lower &lt;dbl&gt;, direct1.upper &lt;dbl&gt;, direct2 &lt;dbl&gt;,
#   direct2.lower &lt;dbl&gt;, direct2.upper &lt;dbl&gt;, direct3 &lt;dbl&gt;,
#   direct3.lower &lt;dbl&gt;, direct3.upper &lt;dbl&gt;, total1 &lt;dbl&gt;, total1.lower &lt;dbl&gt;,
#   total1.upper &lt;dbl&gt;, total2 &lt;dbl&gt;, total2.lower &lt;dbl&gt;, total2.upper &lt;dbl&gt;,
#   total3 &lt;dbl&gt;, total3.lower &lt;dbl&gt;, total3.upper &lt;dbl&gt;, .width &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="multiple-outcomes" class="slide level2">
<h2>Multiple Outcomes</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb99-2"><a href="#cb99-2"></a></span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="fu">set.seed</span>(<span class="fl">4.5</span>)</span>
<span id="cb99-4"><a href="#cb99-4"></a>Ys <span class="ot">&lt;-</span></span>
<span id="cb99-5"><a href="#cb99-5"></a>  <span class="fu">tibble</span>(<span class="at">X  =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-6"><a href="#cb99-6"></a>  <span class="fu">mutate</span>(<span class="at">M =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span> <span class="sc">+</span> X <span class="sc">*</span> .<span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-7"><a href="#cb99-7"></a>  <span class="fu">mutate</span>(<span class="at">Y1 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span> <span class="sc">+</span> X <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> M <span class="sc">*</span> <span class="dv">0</span>,  <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb99-8"><a href="#cb99-8"></a>         <span class="at">Y2 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span> <span class="sc">+</span> X <span class="sc">*</span> <span class="dv">0</span>  <span class="sc">+</span> M <span class="sc">*</span> .<span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb99-9"><a href="#cb99-9"></a>         <span class="at">Y3 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span> <span class="sc">+</span> X <span class="sc">*</span> <span class="dv">1</span>  <span class="sc">+</span> M <span class="sc">*</span> <span class="dv">1</span>,  <span class="at">sd =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>MultY_coords <span class="ot">&lt;-</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"M"</span>,<span class="st">"Y1"</span>,  <span class="st">"Y2"</span>, <span class="st">"Y3"</span>),</span>
<span id="cb100-3"><a href="#cb100-3"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb100-4"><a href="#cb100-4"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">2.25</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb100-5"><a href="#cb100-5"></a></span>
<span id="cb100-6"><a href="#cb100-6"></a>Y1 <span class="ot">&lt;-</span></span>
<span id="cb100-7"><a href="#cb100-7"></a>  <span class="fu">dagify</span>(M <span class="sc">~</span> X,</span>
<span id="cb100-8"><a href="#cb100-8"></a>       Y1 <span class="sc">~</span> X <span class="sc">+</span>  M,</span>
<span id="cb100-9"><a href="#cb100-9"></a>       Y2 <span class="sc">~</span> X <span class="sc">+</span>  M,</span>
<span id="cb100-10"><a href="#cb100-10"></a>       Y3 <span class="sc">~</span> X <span class="sc">+</span>  M,</span>
<span id="cb100-11"><a href="#cb100-11"></a>       <span class="at">coords =</span> MultY_coords) <span class="sc">%&gt;%</span></span>
<span id="cb100-12"><a href="#cb100-12"></a>  </span>
<span id="cb100-13"><a href="#cb100-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb100-14"><a href="#cb100-14"></a>  <span class="fu">geom_dag_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb100-15"><a href="#cb100-15"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb100-16"><a href="#cb100-16"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb100-17"><a href="#cb100-17"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb100-18"><a href="#cb100-18"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb100-19"><a href="#cb100-19"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb100-20"><a href="#cb100-20"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb100-21"><a href="#cb100-21"></a>  <span class="fu">ggtitle</span>(<span class="st">"direct + indirect effect"</span>)</span>
<span id="cb100-22"><a href="#cb100-22"></a>Y1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-66-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>mult.Ys <span class="ot">&lt;-</span></span>
<span id="cb101-2"><a href="#cb101-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb101-3"><a href="#cb101-3"></a>      <span class="fu">bf</span>(Y1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M) <span class="sc">+</span> </span>
<span id="cb101-4"><a href="#cb101-4"></a>        <span class="fu">bf</span>(Y2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M) <span class="sc">+</span> </span>
<span id="cb101-5"><a href="#cb101-5"></a>        <span class="fu">bf</span>(Y3 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M) <span class="sc">+</span> </span>
<span id="cb101-6"><a href="#cb101-6"></a>        <span class="fu">bf</span>(M <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X) <span class="sc">+</span> </span>
<span id="cb101-7"><a href="#cb101-7"></a>        <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>),</span>
<span id="cb101-8"><a href="#cb101-8"></a>      <span class="at">data =</span> Ys,</span>
<span id="cb101-9"><a href="#cb101-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb101-10"><a href="#cb101-10"></a>      <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb101-11"><a href="#cb101-11"></a>      <span class="at">file =</span> <span class="st">"med.4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">summary</span>(mult.Ys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian, gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity
         mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: Y1 ~ 1 + X + M 
         Y2 ~ 1 + X + M 
         Y3 ~ 1 + X + M 
         M ~ 1 + X 
   Data: Ys (Number of observations: 1000) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Y1_Intercept     0.01      0.03    -0.05     0.07 1.00     9239     2970
Y2_Intercept     0.00      0.03    -0.06     0.06 1.00     9282     3150
Y3_Intercept    -0.01      0.03    -0.07     0.05 1.00    10126     2817
M_Intercept      0.03      0.03    -0.04     0.09 1.00     9200     2581
Y1_X            -1.05      0.04    -1.12    -0.98 1.00     6834     3166
Y1_M             0.05      0.03    -0.01     0.11 1.00     7152     3442
Y2_X             0.05      0.04    -0.02     0.12 1.00     7078     3468
Y2_M             0.53      0.03     0.47     0.59 1.00     7314     3391
Y3_X             1.03      0.04     0.95     1.10 1.00     6441     3313
Y3_M             1.06      0.03     1.00     1.12 1.00     7482     3224
M_X              0.53      0.03     0.47     0.59 1.00     9330     2682

Family Specific Parameters: 
         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_Y1     0.98      0.02     0.93     1.02 1.00     8863     2464
sigma_Y2     0.97      0.02     0.93     1.02 1.00    10626     2736
sigma_Y3     1.00      0.02     0.96     1.05 1.00     9318     3296
sigma_M      1.00      0.02     0.96     1.04 1.00     9829     3028

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="multiple-mediators" class="slide level2">
<h2>Multiple Mediators</h2>
<p>Note we can compute individual and total indirect effects</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>parallel <span class="ot">&lt;-</span></span>
<span id="cb104-2"><a href="#cb104-2"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"M1"</span>,<span class="st">"M2"</span>,  <span class="st">"Y"</span>),</span>
<span id="cb104-3"><a href="#cb104-3"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb104-4"><a href="#cb104-4"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">2.25</span>,<span class="fl">1.75</span>, <span class="dv">2</span>))</span>
<span id="cb104-5"><a href="#cb104-5"></a></span>
<span id="cb104-6"><a href="#cb104-6"></a></span>
<span id="cb104-7"><a href="#cb104-7"></a> X2<span class="ot">&lt;-</span> <span class="fu">dagify</span>(M1 <span class="sc">~</span> X,</span>
<span id="cb104-8"><a href="#cb104-8"></a>       M2 <span class="sc">~</span> X ,</span>
<span id="cb104-9"><a href="#cb104-9"></a>       Y <span class="sc">~</span> X <span class="sc">+</span>  M1,</span>
<span id="cb104-10"><a href="#cb104-10"></a>       Y <span class="sc">~</span> X <span class="sc">+</span>  M2,</span>
<span id="cb104-11"><a href="#cb104-11"></a>       <span class="at">coords =</span> parallel) <span class="sc">%&gt;%</span></span>
<span id="cb104-12"><a href="#cb104-12"></a>  </span>
<span id="cb104-13"><a href="#cb104-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb104-14"><a href="#cb104-14"></a>  <span class="fu">geom_dag_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb104-15"><a href="#cb104-15"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb104-16"><a href="#cb104-16"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb104-17"><a href="#cb104-17"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb104-18"><a href="#cb104-18"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb104-19"><a href="#cb104-19"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb104-20"><a href="#cb104-20"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb104-21"><a href="#cb104-21"></a>  <span class="fu">ggtitle</span>(<span class="st">"parallel"</span>)</span>
<span id="cb104-22"><a href="#cb104-22"></a> </span>
<span id="cb104-23"><a href="#cb104-23"></a> </span>
<span id="cb104-24"><a href="#cb104-24"></a> serial <span class="ot">&lt;-</span></span>
<span id="cb104-25"><a href="#cb104-25"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"M1"</span>,<span class="st">"M2"</span>,  <span class="st">"Y"</span>),</span>
<span id="cb104-26"><a href="#cb104-26"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="dv">3</span>),</span>
<span id="cb104-27"><a href="#cb104-27"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">2.25</span>,<span class="fl">2.25</span>, <span class="dv">2</span>))</span>
<span id="cb104-28"><a href="#cb104-28"></a> </span>
<span id="cb104-29"><a href="#cb104-29"></a>  X3<span class="ot">&lt;-</span> <span class="fu">dagify</span>(M1 <span class="sc">~</span> X,</span>
<span id="cb104-30"><a href="#cb104-30"></a>       M2 <span class="sc">~</span> M1 ,</span>
<span id="cb104-31"><a href="#cb104-31"></a>        M2 <span class="sc">~</span> X ,</span>
<span id="cb104-32"><a href="#cb104-32"></a>       Y <span class="sc">~</span> M1,</span>
<span id="cb104-33"><a href="#cb104-33"></a>       Y <span class="sc">~</span> X <span class="sc">+</span>  M2,</span>
<span id="cb104-34"><a href="#cb104-34"></a>       <span class="at">coords =</span> serial)  <span class="sc">%&gt;%</span></span>
<span id="cb104-35"><a href="#cb104-35"></a>  </span>
<span id="cb104-36"><a href="#cb104-36"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb104-37"><a href="#cb104-37"></a>  <span class="fu">geom_dag_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb104-38"><a href="#cb104-38"></a>  <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb104-39"><a href="#cb104-39"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb104-40"><a href="#cb104-40"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb104-41"><a href="#cb104-41"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb104-42"><a href="#cb104-42"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb104-43"><a href="#cb104-43"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb104-44"><a href="#cb104-44"></a>  <span class="fu">ggtitle</span>(<span class="st">"serial"</span>)</span>
<span id="cb104-45"><a href="#cb104-45"></a></span>
<span id="cb104-46"><a href="#cb104-46"></a>X2 <span class="sc">|</span> X3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-69-1.png" width="960" class="r-stretch"></section>
<section id="parallel" class="slide level2">
<h2>parallel</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>m1_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(M1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X)</span>
<span id="cb105-2"><a href="#cb105-2"></a>m2_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(M2  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X)</span>
<span id="cb105-3"><a href="#cb105-3"></a>y_model  <span class="ot">&lt;-</span> <span class="fu">bf</span>(Y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M1 <span class="sc">+</span> M2)</span>
<span id="cb105-4"><a href="#cb105-4"></a></span>
<span id="cb105-5"><a href="#cb105-5"></a>par <span class="ot">&lt;-</span></span>
<span id="cb105-6"><a href="#cb105-6"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb105-7"><a href="#cb105-7"></a>      y_model <span class="sc">+</span> m1_model <span class="sc">+</span> m2_model <span class="sc">+</span> <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>),</span>
<span id="cb105-8"><a href="#cb105-8"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb105-9"><a href="#cb105-9"></a>      <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>3 indirect effects can be calculated</p>
</section>
<section id="serial" class="slide level2">
<h2>serial</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>ser <span class="ot">&lt;-</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb106-3"><a href="#cb106-3"></a>        <span class="fu">bf</span>(M1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X) <span class="sc">+</span> </span>
<span id="cb106-4"><a href="#cb106-4"></a>        <span class="fu">bf</span>(M2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M1) <span class="sc">+</span> </span>
<span id="cb106-5"><a href="#cb106-5"></a>        <span class="fu">bf</span>(Y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M1 <span class="sc">+</span> M2) <span class="sc">+</span> </span>
<span id="cb106-6"><a href="#cb106-6"></a>        <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>),</span>
<span id="cb106-7"><a href="#cb106-7"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb106-8"><a href="#cb106-8"></a>        <span class="at">data=</span>d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>4 indirect effects can be calculated</p>
</section>
<section id="moderated-mediation" class="slide level2">
<h2>moderated mediation?</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>y_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(Y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> M)</span>
<span id="cb107-2"><a href="#cb107-2"></a>m_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(M <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X<span class="sc">*</span>moderator)</span>
<span id="cb107-3"><a href="#cb107-3"></a></span>
<span id="cb107-4"><a href="#cb107-4"></a>med<span class="fl">.5</span> <span class="ot">&lt;-</span></span>
<span id="cb107-5"><a href="#cb107-5"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb107-6"><a href="#cb107-6"></a>      y_model <span class="sc">+</span> m_model <span class="sc">+</span> <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>),</span>
<span id="cb107-7"><a href="#cb107-7"></a>      <span class="at">data =</span> Data,</span>
<span id="cb107-8"><a href="#cb107-8"></a>      <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb107-9"><a href="#cb107-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb107-10"><a href="#cb107-10"></a>      <span class="at">file =</span> <span class="st">"med.5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="distributional-models" class="slide level2">
<h2>Distributional Models</h2>
<p>In basic regression with a Gaussian DV, we predict the mean, <span class="math inline">\(\mu\)</span> through some linear model. The second parameter of the normal distribution – the residual standard deviation <span class="math inline">\(\sigma\)</span> – is assumed to be constant across observations. We estimate it but do not try to predict it.</p>
<p>This extends beyond Gaussian DVs, as most response distributions have a “location” parameter and one or more “scale” or “shape” parameters. Instead of only predicting the location parameters, we can also predict the scale parameters</p>
<p>When to use? You’ve seen this with Welch’s t-test, and if you’ve ever done SEM you can model variance differences through constraints or group models</p>
</section>
<section class="slide level2">

<p><span class="math display">\[y_{ik} \sim t(\mu_{ik}, \sigma_{ik})\]</span> <span class="math display">\[\mu_{ik} = \beta_0 + \beta_1 Group_{ik}\]</span> <span class="math display">\[\sigma_{ik} = \gamma_0 + \gamma_1 Group_{ik}\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>d<span class="fl">.1</span>a <span class="ot">&lt;-</span> </span>
<span id="cb108-2"><a href="#cb108-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> student,</span>
<span id="cb108-3"><a href="#cb108-3"></a>     <span class="fu">bf</span>( CON <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> group,</span>
<span id="cb108-4"><a href="#cb108-4"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> group),</span>
<span id="cb108-5"><a href="#cb108-5"></a>                <span class="at">file =</span> <span class="st">"d.1a"</span>,</span>
<span id="cb108-6"><a href="#cb108-6"></a>                <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb108-7"><a href="#cb108-7"></a>                <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">summary</span>(d<span class="fl">.1</span>a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: student 
  Links: mu = identity; sigma = log; nu = identity 
Formula: CON ~ 0 + group 
         sigma ~ 0 + group
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
groupCTRL           0.20      0.01     0.19     0.22 1.00     4005     2373
groupPD             0.18      0.01     0.17     0.20 1.00     4205     2918
sigma_groupCTRL    -2.87      0.11    -3.09    -2.65 1.00     3355     2784
sigma_groupPD      -2.64      0.07    -2.79    -2.50 1.00     3133     2136

Family Specific Parameters: 
   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
nu    19.07     11.55     5.81    49.75 1.00     2953     3008

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>d<span class="fl">.1</span>b <span class="ot">&lt;-</span> </span>
<span id="cb111-2"><a href="#cb111-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb111-3"><a href="#cb111-3"></a>     <span class="fu">bf</span>( CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> group,</span>
<span id="cb111-4"><a href="#cb111-4"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> group),</span>
<span id="cb111-5"><a href="#cb111-5"></a>                <span class="at">file =</span> <span class="st">"d.1b"</span>,</span>
<span id="cb111-6"><a href="#cb111-6"></a>                <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb111-7"><a href="#cb111-7"></a>                <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="fu">summary</span>(d<span class="fl">.1</span>b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: CON ~ 1 + group 
         sigma ~ 1 + group
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           0.20      0.01     0.19     0.22 1.00     4262     3250
sigma_Intercept    -2.80      0.09    -2.97    -2.60 1.00     3600     2519
groupPD            -0.02      0.01    -0.04     0.00 1.00     3679     2706
sigma_groupPD       0.25      0.11     0.03     0.46 1.00     3621     2603

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>d<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb114-2"><a href="#cb114-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb114-3"><a href="#cb114-3"></a>     <span class="fu">bf</span>( CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> group,</span>
<span id="cb114-4"><a href="#cb114-4"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> group<span class="sc">*</span>Education),</span>
<span id="cb114-5"><a href="#cb114-5"></a>                <span class="at">file =</span> <span class="st">"d.2"</span>,</span>
<span id="cb114-6"><a href="#cb114-6"></a>                 <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb114-7"><a href="#cb114-7"></a>                <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="fu">summary</span>(d<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: CON ~ 1 + group 
         sigma ~ 1 + group * Education
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   0.20      0.01     0.19     0.22 1.00     3231
sigma_Intercept            -3.27      0.46    -4.22    -2.41 1.00     1826
groupPD                    -0.02      0.01    -0.03     0.00 1.00     2845
sigma_groupPD               0.05      0.58    -1.06     1.21 1.00     1660
sigma_Education             0.03      0.03    -0.03     0.10 1.00     1829
sigma_groupPD:Education     0.01      0.04    -0.07     0.08 1.00     1629
                        Tail_ESS
Intercept                   2114
sigma_Intercept             1932
groupPD                     2369
sigma_groupPD               1935
sigma_Education             1857
sigma_groupPD:Education     1700

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>d<span class="fl">.1</span>a <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2"></a>  <span class="fu">gather_draws</span>(b_sigma_groupCTRL, b_sigma_groupPD) <span class="sc">%&gt;%</span> </span>
<span id="cb117-3"><a href="#cb117-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .value, <span class="at">group =</span> .variable,  <span class="at">fill =</span> .variable)) <span class="sc">+</span></span>
<span id="cb117-4"><a href="#cb117-4"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> .<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-79-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>d<span class="fl">.1</span>a <span class="sc">%&gt;%</span> </span>
<span id="cb118-2"><a href="#cb118-2"></a>  <span class="fu">gather_draws</span>(b_sigma_groupCTRL, b_sigma_groupPD) <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href="#cb118-3"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">exp</span>(.value)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-4"><a href="#cb118-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">group =</span> .variable,  <span class="at">fill =</span> .variable)) <span class="sc">+</span></span>
<span id="cb118-5"><a href="#cb118-5"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> .<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="adv-9_files/figure-revealjs/unnamed-chunk-80-1.png" width="960"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>d<span class="fl">.1</span>a <span class="sc">%&gt;%</span> </span>
<span id="cb119-2"><a href="#cb119-2"></a>  <span class="fu">gather_draws</span>(b_sigma_groupCTRL, b_sigma_groupPD) <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">exp</span>(.value)) <span class="sc">%&gt;%</span> </span>
<span id="cb119-4"><a href="#cb119-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">group =</span> .variable,  <span class="at">fill =</span> .variable)) <span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> .<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="adv-9_files/figure-revealjs/unnamed-chunk-81-1.png" width="960"></p>
</div>
</div>
</section>
<section class="slide level2">

<p>But these are estimates of the parameter, not variances per se. Can we have a plot that includes variances and means?</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>mlm <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2"></a>  <span class="fu">data_grid</span>(<span class="at">group =</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="#cb120-3"></a>  <span class="fu">add_predicted_draws</span>(d<span class="fl">.1</span>a) <span class="sc">%&gt;%</span> </span>
<span id="cb120-4"><a href="#cb120-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .prediction, <span class="at">group =</span>  <span class="fu">fct_rev</span>(group), <span class="at">fill =</span> <span class="fu">fct_rev</span>(group))) <span class="sc">+</span></span>
<span id="cb120-5"><a href="#cb120-5"></a>  <span class="fu">stat_halfeye</span>(<span class="at">alpha =</span> .<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-82-1.png" width="960" class="r-stretch"></section>
<section id="mlm-assumptions" class="slide level2">
<h2>MLM assumptions</h2>
<p>Sigma, which captures the variation in NA not accounted for by the intercepts, time predictors, and the correlation. An assumption is that sigma does NOT vary across persons, occasions, or other variables.</p>
<p>Posterior predictive interval is the same (and fitted) even though it seem inappropriate from person to person</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>newd <span class="ot">&lt;-</span></span>
<span id="cb121-2"><a href="#cb121-2"></a>  melsm <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="#cb121-3"></a>  <span class="fu">filter</span>(record_id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">115</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb121-4"><a href="#cb121-4"></a>  <span class="fu">select</span>(record_id, N_A.std, day01)</span>
<span id="cb121-5"><a href="#cb121-5"></a></span>
<span id="cb121-6"><a href="#cb121-6"></a>fits <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb121-7"><a href="#cb121-7"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>)</span>
<span id="cb121-8"><a href="#cb121-8"></a></span>
<span id="cb121-9"><a href="#cb121-9"></a>preds <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb121-10"><a href="#cb121-10"></a>  <span class="fu">add_predicted_draws</span>(melsm<span class="fl">.1</span>)</span>
<span id="cb121-11"><a href="#cb121-11"></a></span>
<span id="cb121-12"><a href="#cb121-12"></a>fits <span class="sc">%&gt;%</span> </span>
<span id="cb121-13"><a href="#cb121-13"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb121-14"><a href="#cb121-14"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb121-15"><a href="#cb121-15"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> preds, <span class="fu">aes</span>(<span class="at">y =</span> .prediction),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb121-16"><a href="#cb121-16"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> newd) <span class="sc">+</span></span>
<span id="cb121-17"><a href="#cb121-17"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-83-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p><span class="math display">\[NA_{ij} \sim \operatorname{Normal}(\mu_{ij}, \sigma_{i})\]</span></p>
<p><span class="math display">\[\mu_{ij}  = \beta_0 + \beta_1 time_{ij} + u_{0i} + u_{1i} time_{ij}\]</span> <span class="math display">\[\log(\sigma_i )  = \eta_0 + u_{2i}\]</span></p>
<p><span class="math display">\[\begin{bmatrix} u_{0i} \\ u_{1i} \\ {u_{2i}} \end{bmatrix}  \sim \operatorname{MVNormal}\begin{pmatrix} \begin{bmatrix} 0 \\ 0 \\ 0 \end{bmatrix}, \mathbf S \mathbf R \mathbf S \end{pmatrix}\]</span> <span class="math display">\[\mathbf S  = \begin{bmatrix} \sigma_0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma_1 &amp; 0 \\ 0 &amp; 0 &amp; \sigma_2 \end{bmatrix}\]</span> <span class="math display">\[\mathbf R = \begin{bmatrix} 1 &amp; \rho_{12} &amp; \rho_{13} \\ \rho_{21} &amp; 1 &amp; \rho_{23} \\ \rho_{31} &amp; \rho_{32} &amp; 1 \end{bmatrix}\]</span> <span class="math display">\[\beta_0  \sim \operatorname{Normal}(0, 0.2)\]</span> <span class="math display">\[\beta_1 \text{and } \eta_0  \sim \operatorname{Normal}(0, 1) \]</span> <span class="math display">\[ \sigma_0,\dots, \sigma_2 \sim \operatorname{Exponential}(1) \]</span> <span class="math display">\[\mathbf R  \sim \operatorname{LKJ}(2)\]</span></p>
</section>
<section class="slide level2">

<p>note: 1) brms default is to use log-link when modeling sigma 2) |i| syntax within the parentheses allow for correlated random effects. Without this, the random intercept and slope would not be correlated with the random sigma term, effectively setting the correlation equal to zero</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>melsm<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb122-2"><a href="#cb122-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb122-3"><a href="#cb122-3"></a>      <span class="fu">bf</span>(N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id),</span>
<span id="cb122-4"><a href="#cb122-4"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>i<span class="sc">|</span> record_id)),</span>
<span id="cb122-5"><a href="#cb122-5"></a>                <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb122-6"><a href="#cb122-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb122-7"><a href="#cb122-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb122-8"><a href="#cb122-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma),</span>
<span id="cb122-9"><a href="#cb122-9"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma),</span>
<span id="cb122-10"><a href="#cb122-10"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb122-11"><a href="#cb122-11"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb122-12"><a href="#cb122-12"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb122-13"><a href="#cb122-13"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb122-14"><a href="#cb122-14"></a>      <span class="at">file =</span> <span class="st">"melsm.2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="fu">summary</span>(melsm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | i | record_id) 
         sigma ~ 1 + (1 | i | record_id)
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                               Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)                      0.76      0.04     0.69     0.85 1.01
sd(day01)                          0.61      0.04     0.53     0.69 1.00
sd(sigma_Intercept)                0.70      0.04     0.63     0.77 1.00
cor(Intercept,day01)              -0.33      0.08    -0.49    -0.17 1.00
cor(Intercept,sigma_Intercept)     0.61      0.05     0.52     0.70 1.01
cor(day01,sigma_Intercept)        -0.10      0.08    -0.26     0.06 1.01
                               Bulk_ESS Tail_ESS
sd(Intercept)                       381      964
sd(day01)                          1467     3061
sd(sigma_Intercept)                 750     1155
cor(Intercept,day01)                974     2058
cor(Intercept,sigma_Intercept)      830     1606
cor(day01,sigma_Intercept)          558     1530

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           0.03      0.06    -0.08     0.14 1.01      252      428
sigma_Intercept    -0.78      0.05    -0.89    -0.69 1.01      366      827
day01              -0.16      0.05    -0.26    -0.05 1.00      478     1481

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb125-2"><a href="#cb125-2"></a>  <span class="fu">spread_draws</span>(b_sigma_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb125-3"><a href="#cb125-3"></a>  <span class="fu">exp</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb125-4"><a href="#cb125-4"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  b_sigma_Intercept .lower .upper .width .point .interval
              &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1             0.457  0.412  0.504   0.95 median qi       </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb127-2"><a href="#cb127-2"></a>  <span class="fu">spread_draws</span>(b_day01) <span class="sc">%&gt;%</span> </span>
<span id="cb127-3"><a href="#cb127-3"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  b_day01 .lower  .upper .width .point .interval
    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1  -0.157 -0.262 -0.0522   0.95 median qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="#cb129-2"></a><span class="fu">spread_draws</span>(b_sigma_Intercept,r_record_id__sigma[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,544,000 × 7
# Groups:   ID, term [193]
   .chain .iteration .draw b_sigma_Intercept    ID term      r_record_id__sigma
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;             &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;                  &lt;dbl&gt;
 1      1          1     1            -0.713     1 Intercept             0.235 
 2      1          1     1            -0.713     2 Intercept            -1.16  
 3      1          1     1            -0.713     3 Intercept             0.179 
 4      1          1     1            -0.713     4 Intercept             0.447 
 5      1          1     1            -0.713     5 Intercept            -0.987 
 6      1          1     1            -0.713     6 Intercept             0.295 
 7      1          1     1            -0.713     7 Intercept             0.0524
 8      1          1     1            -0.713     8 Intercept            -0.994 
 9      1          1     1            -0.713     9 Intercept            -0.569 
10      1          1     1            -0.713    10 Intercept            -0.342 
# ℹ 1,543,990 more rows</code></pre>
</div>
</div>
<p>8000 samples * 193 participants = 1544000</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="#cb131-2"></a><span class="fu">spread_draws</span>(b_sigma_Intercept,r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb131-3"><a href="#cb131-3"></a>  <span class="fu">mutate</span>(<span class="at">b_sigma_Intercept =</span> <span class="fu">exp</span>(b_sigma_Intercept)) <span class="sc">%&gt;%</span> </span>
<span id="cb131-4"><a href="#cb131-4"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb131-5"><a href="#cb131-5"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> b_sigma_Intercept <span class="sc">+</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb131-6"><a href="#cb131-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-89-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>fits2 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="#cb132-2"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.2</span>)</span>
<span id="cb132-3"><a href="#cb132-3"></a></span>
<span id="cb132-4"><a href="#cb132-4"></a>preds2 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb132-5"><a href="#cb132-5"></a>  <span class="fu">add_predicted_draws</span>(melsm<span class="fl">.2</span>)</span>
<span id="cb132-6"><a href="#cb132-6"></a></span>
<span id="cb132-7"><a href="#cb132-7"></a>fits2 <span class="sc">%&gt;%</span> </span>
<span id="cb132-8"><a href="#cb132-8"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb132-9"><a href="#cb132-9"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb132-10"><a href="#cb132-10"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> preds2, <span class="fu">aes</span>(<span class="at">y =</span> .prediction),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb132-11"><a href="#cb132-11"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> newd) <span class="sc">+</span></span>
<span id="cb132-12"><a href="#cb132-12"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-90-1.png" width="960" class="r-stretch"></section>
<section id="time-as-a-predictor-of-sigma" class="slide level2">
<h2>time as a predictor of sigma</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>melsm<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb133-2"><a href="#cb133-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb133-3"><a href="#cb133-3"></a>      <span class="fu">bf</span>(N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id),</span>
<span id="cb133-4"><a href="#cb133-4"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id)),</span>
<span id="cb133-5"><a href="#cb133-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb133-6"><a href="#cb133-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb133-7"><a href="#cb133-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb133-8"><a href="#cb133-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma),</span>
<span id="cb133-9"><a href="#cb133-9"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">dpar =</span> sigma),</span>
<span id="cb133-10"><a href="#cb133-10"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma),</span>
<span id="cb133-11"><a href="#cb133-11"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb133-12"><a href="#cb133-12"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb133-13"><a href="#cb133-13"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb133-14"><a href="#cb133-14"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb133-15"><a href="#cb133-15"></a>      <span class="at">file =</span> <span class="st">"melsm.3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="fu">summary</span>(melsm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | i | record_id) 
         sigma ~ 1 + day01 + (1 + day01 | i | record_id)
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                                 Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)                        0.75      0.04     0.68     0.84 1.01
sd(day01)                            0.60      0.04     0.52     0.69 1.00
sd(sigma_Intercept)                  0.70      0.04     0.63     0.78 1.00
sd(sigma_day01)                      0.36      0.04     0.29     0.44 1.00
cor(Intercept,day01)                -0.31      0.08    -0.46    -0.14 1.00
cor(Intercept,sigma_Intercept)       0.64      0.05     0.54     0.72 1.00
cor(day01,sigma_Intercept)          -0.21      0.08    -0.35    -0.04 1.00
cor(Intercept,sigma_day01)          -0.16      0.10    -0.36     0.04 1.00
cor(day01,sigma_day01)               0.61      0.09     0.42     0.76 1.00
cor(sigma_Intercept,sigma_day01)    -0.16      0.10    -0.34     0.04 1.00
                                 Bulk_ESS Tail_ESS
sd(Intercept)                         965     2122
sd(day01)                            2356     4338
sd(sigma_Intercept)                  1433     2597
sd(sigma_day01)                      4063     6209
cor(Intercept,day01)                 1207     2386
cor(Intercept,sigma_Intercept)       1732     3346
cor(day01,sigma_Intercept)           1300     2462
cor(Intercept,sigma_day01)           4688     6012
cor(day01,sigma_day01)               3737     5650
cor(sigma_Intercept,sigma_day01)     4309     5694

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           0.03      0.06    -0.08     0.14 1.01      359      807
sigma_Intercept    -0.75      0.05    -0.85    -0.65 1.00      666     1906
day01              -0.15      0.05    -0.26    -0.05 1.00     1006     2466
sigma_day01        -0.11      0.04    -0.18    -0.03 1.00     3570     5031

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb136-2"><a href="#cb136-2"></a>  <span class="fu">gather_draws</span>(b_sigma_Intercept, b_sigma_day01) <span class="sc">%&gt;%</span> </span>
<span id="cb136-3"><a href="#cb136-3"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  .variable         .value .lower  .upper .width .point .interval
  &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 b_sigma_Intercept -0.748 -0.848 -0.647    0.95 median qi       
2 b_sigma_day01     -0.107 -0.182 -0.0304   0.95 median qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb138-2"><a href="#cb138-2"></a>  <span class="fu">spread_draws</span>(b_sigma_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb138-3"><a href="#cb138-3"></a>  <span class="fu">mutate</span>(<span class="at">sigma_day0 =</span> <span class="fu">exp</span>(b_sigma_Intercept)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-4"><a href="#cb138-4"></a>  <span class="fu">select</span>(sigma_day0) <span class="sc">%&gt;%</span> </span>
<span id="cb138-5"><a href="#cb138-5"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  sigma_day0 .lower .upper .width .point .interval
       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1      0.473  0.428  0.524   0.95 median qi       </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb140-2"><a href="#cb140-2"></a>  <span class="fu">spread_draws</span>(b_sigma_Intercept, b_sigma_day01) <span class="sc">%&gt;%</span> </span>
<span id="cb140-3"><a href="#cb140-3"></a>  <span class="fu">mutate</span>(<span class="at">sigma_day1 =</span> <span class="fu">exp</span>(b_sigma_Intercept <span class="sc">+</span> b_sigma_day01)) <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="#cb140-4"></a>  <span class="fu">select</span>(sigma_day1) <span class="sc">%&gt;%</span> </span>
<span id="cb140-5"><a href="#cb140-5"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  sigma_day1 .lower .upper .width .point .interval
       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1      0.426  0.381  0.474   0.95 median qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="#cb142-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb142-3"><a href="#cb142-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.3</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>, <span class="at">dpar =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb142-4"><a href="#cb142-4"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb142-5"><a href="#cb142-5"></a>  <span class="fu">select</span>(day01, .epred, sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160,000 × 3
   day01   .epred sigma
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1     0  0.00437 0.475
 2     0  0.0347  0.467
 3     0  0.0248  0.444
 4     0 -0.0167  0.455
 5     0 -0.0114  0.446
 6     0  0.0162  0.462
 7     0  0.0423  0.507
 8     0  0.0585  0.564
 9     0  0.0641  0.510
10     0  0.0519  0.463
# ℹ 159,990 more rows</code></pre>
</div>
</div>
<p>20 * 8000 = 160000</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="#cb144-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb144-3"><a href="#cb144-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.3</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>, <span class="at">dpar =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb144-4"><a href="#cb144-4"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb144-5"><a href="#cb144-5"></a>  <span class="fu">select</span>(day01, .epred, sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb144-6"><a href="#cb144-6"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb144-7"><a href="#cb144-7"></a>  <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> sigma) <span class="sc">+</span></span>
<span id="cb144-8"><a href="#cb144-8"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-97-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb145-3"><a href="#cb145-3"></a>  <span class="fu">add_linpred_draws</span>(melsm<span class="fl">.3</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>, <span class="at">dpar =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb145-4"><a href="#cb145-4"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb145-5"><a href="#cb145-5"></a>  <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> sigma) <span class="sc">+</span></span>
<span id="cb145-6"><a href="#cb145-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-98-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Lets look at random effects. Remember we fit a random effect for both the intercept and the slope (time)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="#cb146-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb146-3"><a href="#cb146-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,088,000 × 6
# Groups:   ID, term [386]
      ID term  r_record_id__sigma .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     1 day01              1.28       1          1     1
 2     1 day01              1.09       1          2     2
 3     1 day01              1.53       1          3     3
 4     1 day01              0.822      1          4     4
 5     1 day01              0.785      1          5     5
 6     1 day01              1.06       1          6     6
 7     1 day01              1.62       1          7     7
 8     1 day01              0.933      1          8     8
 9     1 day01              1.42       1          9     9
10     1 day01              1.12       1         10    10
# ℹ 3,087,990 more rows</code></pre>
</div>
</div>
<p>193 * 8000 *2</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb148-2"><a href="#cb148-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb148-3"><a href="#cb148-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-4"><a href="#cb148-4"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 386 × 8
      ID term      estimate .lower .upper .width .point .interval
   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1     1 Intercept    1.40   1.08   1.84    0.95 median qi       
 2     1 day01        1.20   0.811  1.79    0.95 median qi       
 3     2 Intercept    0.237  0.178  0.322   0.95 median qi       
 4     2 day01        1.56   1.05   2.35    0.95 median qi       
 5     3 Intercept    1.32   1.02   1.73    0.95 median qi       
 6     3 day01        0.831  0.565  1.23    0.95 median qi       
 7     4 Intercept    1.90   1.45   2.52    0.95 median qi       
 8     4 day01        0.978  0.639  1.53    0.95 median qi       
 9     5 Intercept    0.431  0.301  0.664   0.95 median qi       
10     5 day01        1.14   0.622  2.09    0.95 median qi       
# ℹ 376 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb150-2"><a href="#cb150-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb150-3"><a href="#cb150-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb150-4"><a href="#cb150-4"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb150-5"><a href="#cb150-5"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"Intercept"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb150-6"><a href="#cb150-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb150-7"><a href="#cb150-7"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-101-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb151-2"><a href="#cb151-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb151-3"><a href="#cb151-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb151-4"><a href="#cb151-4"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb151-5"><a href="#cb151-5"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"day01"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-6"><a href="#cb151-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb151-7"><a href="#cb151-7"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-102-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>When on the log scale you can more easily see some people are less than average where some are more than average in terms of sigma</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb152-2"><a href="#cb152-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb152-3"><a href="#cb152-3"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="#cb152-4"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"day01"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-5"><a href="#cb152-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb152-6"><a href="#cb152-6"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-103-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a>fits3 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.3</span>)</span>
<span id="cb153-3"><a href="#cb153-3"></a></span>
<span id="cb153-4"><a href="#cb153-4"></a>preds3 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb153-5"><a href="#cb153-5"></a>  <span class="fu">add_predicted_draws</span>(melsm<span class="fl">.3</span>)</span>
<span id="cb153-6"><a href="#cb153-6"></a></span>
<span id="cb153-7"><a href="#cb153-7"></a>fits3 <span class="sc">%&gt;%</span> </span>
<span id="cb153-8"><a href="#cb153-8"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb153-9"><a href="#cb153-9"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb153-10"><a href="#cb153-10"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> preds3, <span class="fu">aes</span>(<span class="at">y =</span> .prediction),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb153-11"><a href="#cb153-11"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> newd) <span class="sc">+</span></span>
<span id="cb153-12"><a href="#cb153-12"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-104-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-105-1.png" width="960" class="r-stretch"></section>
<section id="multivariate-melsm" class="slide level2">
<h2>Multivariate MELSM</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a>melsm<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb154-2"><a href="#cb154-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb154-3"><a href="#cb154-3"></a>      <span class="fu">bf</span>(<span class="fu">mvbind</span>(N_A.std, P_A.std) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id),</span>
<span id="cb154-4"><a href="#cb154-4"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id)) <span class="sc">+</span> <span class="fu">set_rescor</span>(<span class="at">rescor =</span> <span class="cn">FALSE</span>),</span>
<span id="cb154-5"><a href="#cb154-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> NAstd),</span>
<span id="cb154-6"><a href="#cb154-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">resp =</span> NAstd),</span>
<span id="cb154-7"><a href="#cb154-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">resp =</span> NAstd),</span>
<span id="cb154-8"><a href="#cb154-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma, <span class="at">resp =</span> NAstd),</span>
<span id="cb154-9"><a href="#cb154-9"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">dpar =</span> sigma, <span class="at">resp =</span> NAstd),</span>
<span id="cb154-10"><a href="#cb154-10"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma, <span class="at">resp =</span> NAstd),</span>
<span id="cb154-11"><a href="#cb154-11"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> PAstd),</span>
<span id="cb154-12"><a href="#cb154-12"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">resp =</span> PAstd),</span>
<span id="cb154-13"><a href="#cb154-13"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">resp =</span> PAstd),</span>
<span id="cb154-14"><a href="#cb154-14"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma, <span class="at">resp =</span> PAstd),</span>
<span id="cb154-15"><a href="#cb154-15"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">dpar =</span> sigma, <span class="at">resp =</span> PAstd),</span>
<span id="cb154-16"><a href="#cb154-16"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma, <span class="at">resp =</span> PAstd),</span>
<span id="cb154-17"><a href="#cb154-17"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb154-18"><a href="#cb154-18"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb154-19"><a href="#cb154-19"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb154-20"><a href="#cb154-20"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb154-21"><a href="#cb154-21"></a>      <span class="at">file =</span> <span class="st">"melsm.4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="fu">summary</span>(melsm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = log
         mu = identity; sigma = log 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | i | record_id) 
         sigma ~ 1 + day01 + (1 + day01 | i | record_id)
         P_A.std ~ 1 + day01 + (1 + day01 | i | record_id) 
         sigma ~ 1 + day01 + (1 + day01 | i | record_id)
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                                                 Estimate Est.Error l-95% CI
sd(NAstd_Intercept)                                  0.76      0.04     0.68
sd(NAstd_day01)                                      0.61      0.04     0.53
sd(sigma_NAstd_Intercept)                            0.70      0.04     0.63
sd(sigma_NAstd_day01)                                0.36      0.04     0.29
sd(PAstd_Intercept)                                  0.83      0.04     0.75
sd(PAstd_day01)                                      0.81      0.05     0.71
sd(sigma_PAstd_Intercept)                            0.43      0.02     0.38
sd(sigma_PAstd_day01)                                0.10      0.06     0.01
cor(NAstd_Intercept,NAstd_day01)                    -0.29      0.08    -0.44
cor(NAstd_Intercept,sigma_NAstd_Intercept)           0.63      0.05     0.53
cor(NAstd_day01,sigma_NAstd_Intercept)              -0.19      0.08    -0.34
cor(NAstd_Intercept,sigma_NAstd_day01)              -0.15      0.10    -0.35
cor(NAstd_day01,sigma_NAstd_day01)                   0.58      0.09     0.38
cor(sigma_NAstd_Intercept,sigma_NAstd_day01)        -0.14      0.10    -0.33
cor(NAstd_Intercept,PAstd_Intercept)                -0.09      0.07    -0.23
cor(NAstd_day01,PAstd_Intercept)                     0.10      0.08    -0.05
cor(sigma_NAstd_Intercept,PAstd_Intercept)          -0.27      0.07    -0.40
cor(sigma_NAstd_day01,PAstd_Intercept)               0.09      0.10    -0.10
cor(NAstd_Intercept,PAstd_day01)                     0.09      0.08    -0.06
cor(NAstd_day01,PAstd_day01)                        -0.26      0.08    -0.42
cor(sigma_NAstd_Intercept,PAstd_day01)               0.02      0.07    -0.13
cor(sigma_NAstd_day01,PAstd_day01)                   0.06      0.11    -0.16
cor(PAstd_Intercept,PAstd_day01)                    -0.24      0.07    -0.38
cor(NAstd_Intercept,sigma_PAstd_Intercept)           0.18      0.07     0.04
cor(NAstd_day01,sigma_PAstd_Intercept)               0.00      0.08    -0.16
cor(sigma_NAstd_Intercept,sigma_PAstd_Intercept)     0.54      0.06     0.42
cor(sigma_NAstd_day01,sigma_PAstd_Intercept)         0.03      0.11    -0.19
cor(PAstd_Intercept,sigma_PAstd_Intercept)          -0.29      0.07    -0.43
cor(PAstd_day01,sigma_PAstd_Intercept)              -0.11      0.08    -0.27
cor(NAstd_Intercept,sigma_PAstd_day01)              -0.01      0.22    -0.44
cor(NAstd_day01,sigma_PAstd_day01)                   0.02      0.22    -0.43
cor(sigma_NAstd_Intercept,sigma_PAstd_day01)        -0.05      0.21    -0.47
cor(sigma_NAstd_day01,sigma_PAstd_day01)             0.17      0.25    -0.38
cor(PAstd_Intercept,sigma_PAstd_day01)               0.18      0.22    -0.29
cor(PAstd_day01,sigma_PAstd_day01)                  -0.14      0.23    -0.56
cor(sigma_PAstd_Intercept,sigma_PAstd_day01)         0.05      0.22    -0.36
                                                 u-95% CI Rhat Bulk_ESS
sd(NAstd_Intercept)                                  0.84 1.00      888
sd(NAstd_day01)                                      0.70 1.00     2163
sd(sigma_NAstd_Intercept)                            0.77 1.00     1513
sd(sigma_NAstd_day01)                                0.43 1.00     3175
sd(PAstd_Intercept)                                  0.92 1.00     1471
sd(PAstd_day01)                                      0.92 1.00     3316
sd(sigma_PAstd_Intercept)                            0.48 1.00     2588
sd(sigma_PAstd_day01)                                0.21 1.01      566
cor(NAstd_Intercept,NAstd_day01)                    -0.13 1.00     1314
cor(NAstd_Intercept,sigma_NAstd_Intercept)           0.72 1.00     1401
cor(NAstd_day01,sigma_NAstd_Intercept)              -0.03 1.00     1390
cor(NAstd_Intercept,sigma_NAstd_day01)               0.06 1.00     4758
cor(NAstd_day01,sigma_NAstd_day01)                   0.74 1.00     3681
cor(sigma_NAstd_Intercept,sigma_NAstd_day01)         0.05 1.00     3784
cor(NAstd_Intercept,PAstd_Intercept)                 0.04 1.00     1230
cor(NAstd_day01,PAstd_Intercept)                     0.25 1.01      895
cor(sigma_NAstd_Intercept,PAstd_Intercept)          -0.14 1.00      917
cor(sigma_NAstd_day01,PAstd_Intercept)               0.28 1.01      318
cor(NAstd_Intercept,PAstd_day01)                     0.24 1.00     2784
cor(NAstd_day01,PAstd_day01)                        -0.09 1.00     2134
cor(sigma_NAstd_Intercept,PAstd_day01)               0.17 1.00     2702
cor(sigma_NAstd_day01,PAstd_day01)                   0.28 1.00     1028
cor(PAstd_Intercept,PAstd_day01)                    -0.09 1.00     2414
cor(NAstd_Intercept,sigma_PAstd_Intercept)           0.32 1.00     1971
cor(NAstd_day01,sigma_PAstd_Intercept)               0.16 1.00     1512
cor(sigma_NAstd_Intercept,sigma_PAstd_Intercept)     0.64 1.00     1688
cor(sigma_NAstd_day01,sigma_PAstd_Intercept)         0.23 1.01      681
cor(PAstd_Intercept,sigma_PAstd_Intercept)          -0.15 1.00     1603
cor(PAstd_day01,sigma_PAstd_Intercept)               0.05 1.00     1728
cor(NAstd_Intercept,sigma_PAstd_day01)               0.43 1.00     8482
cor(NAstd_day01,sigma_PAstd_day01)                   0.46 1.00     9139
cor(sigma_NAstd_Intercept,sigma_PAstd_day01)         0.38 1.00     9957
cor(sigma_NAstd_day01,sigma_PAstd_day01)             0.60 1.00     5637
cor(PAstd_Intercept,sigma_PAstd_day01)               0.57 1.00     8393
cor(PAstd_day01,sigma_PAstd_day01)                   0.34 1.00     7958
cor(sigma_PAstd_Intercept,sigma_PAstd_day01)         0.50 1.00     7004
                                                 Tail_ESS
sd(NAstd_Intercept)                                  1612
sd(NAstd_day01)                                      3476
sd(sigma_NAstd_Intercept)                            2339
sd(sigma_NAstd_day01)                                4719
sd(PAstd_Intercept)                                  2515
sd(PAstd_day01)                                      4865
sd(sigma_PAstd_Intercept)                            4437
sd(sigma_PAstd_day01)                                2213
cor(NAstd_Intercept,NAstd_day01)                     3163
cor(NAstd_Intercept,sigma_NAstd_Intercept)           2497
cor(NAstd_day01,sigma_NAstd_Intercept)               2635
cor(NAstd_Intercept,sigma_NAstd_day01)               5725
cor(NAstd_day01,sigma_NAstd_day01)                   5149
cor(sigma_NAstd_Intercept,sigma_NAstd_day01)         5538
cor(NAstd_Intercept,PAstd_Intercept)                 2291
cor(NAstd_day01,PAstd_Intercept)                     1555
cor(sigma_NAstd_Intercept,PAstd_Intercept)           1926
cor(sigma_NAstd_day01,PAstd_Intercept)                972
cor(NAstd_Intercept,PAstd_day01)                     4020
cor(NAstd_day01,PAstd_day01)                         3312
cor(sigma_NAstd_Intercept,PAstd_day01)               4355
cor(sigma_NAstd_day01,PAstd_day01)                   1858
cor(PAstd_Intercept,PAstd_day01)                     3339
cor(NAstd_Intercept,sigma_PAstd_Intercept)           3073
cor(NAstd_day01,sigma_PAstd_Intercept)               2645
cor(sigma_NAstd_Intercept,sigma_PAstd_Intercept)     4160
cor(sigma_NAstd_day01,sigma_PAstd_Intercept)         1758
cor(PAstd_Intercept,sigma_PAstd_Intercept)           2604
cor(PAstd_day01,sigma_PAstd_Intercept)               3120
cor(NAstd_Intercept,sigma_PAstd_day01)               4279
cor(NAstd_day01,sigma_PAstd_day01)                   4862
cor(sigma_NAstd_Intercept,sigma_PAstd_day01)         3966
cor(sigma_NAstd_day01,sigma_PAstd_day01)             4004
cor(PAstd_Intercept,sigma_PAstd_day01)               4880
cor(PAstd_day01,sigma_PAstd_day01)                   4850
cor(sigma_PAstd_Intercept,sigma_PAstd_day01)         5169

Population-Level Effects: 
                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
NAstd_Intercept           0.03      0.05    -0.08     0.13 1.02      411
sigma_NAstd_Intercept    -0.75      0.05    -0.85    -0.65 1.00      799
PAstd_Intercept           0.10      0.06    -0.01     0.21 1.00     1059
sigma_PAstd_Intercept    -0.66      0.03    -0.72    -0.60 1.00     1762
NAstd_day01              -0.15      0.05    -0.25    -0.04 1.00      968
sigma_NAstd_day01        -0.11      0.04    -0.18    -0.03 1.00     3058
PAstd_day01              -0.31      0.07    -0.44    -0.18 1.00     2551
sigma_PAstd_day01        -0.08      0.03    -0.14    -0.03 1.00    11151
                      Tail_ESS
NAstd_Intercept            737
sigma_NAstd_Intercept     1748
PAstd_Intercept           2213
sigma_PAstd_Intercept     3190
NAstd_day01               2110
sigma_NAstd_day01         4798
PAstd_day01               4104
sigma_PAstd_day01         6347

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>1595 parameters estimated</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="fu">get_variables</span>(melsm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "b_NAstd_Intercept"                                          
   [2] "b_sigma_NAstd_Intercept"                                    
   [3] "b_PAstd_Intercept"                                          
   [4] "b_sigma_PAstd_Intercept"                                    
   [5] "b_NAstd_day01"                                              
   [6] "b_sigma_NAstd_day01"                                        
   [7] "b_PAstd_day01"                                              
   [8] "b_sigma_PAstd_day01"                                        
   [9] "sd_record_id__NAstd_Intercept"                              
  [10] "sd_record_id__NAstd_day01"                                  
  [11] "sd_record_id__sigma_NAstd_Intercept"                        
  [12] "sd_record_id__sigma_NAstd_day01"                            
  [13] "sd_record_id__PAstd_Intercept"                              
  [14] "sd_record_id__PAstd_day01"                                  
  [15] "sd_record_id__sigma_PAstd_Intercept"                        
  [16] "sd_record_id__sigma_PAstd_day01"                            
  [17] "cor_record_id__NAstd_Intercept__NAstd_day01"                
  [18] "cor_record_id__NAstd_Intercept__sigma_NAstd_Intercept"      
  [19] "cor_record_id__NAstd_day01__sigma_NAstd_Intercept"          
  [20] "cor_record_id__NAstd_Intercept__sigma_NAstd_day01"          
  [21] "cor_record_id__NAstd_day01__sigma_NAstd_day01"              
  [22] "cor_record_id__sigma_NAstd_Intercept__sigma_NAstd_day01"    
  [23] "cor_record_id__NAstd_Intercept__PAstd_Intercept"            
  [24] "cor_record_id__NAstd_day01__PAstd_Intercept"                
  [25] "cor_record_id__sigma_NAstd_Intercept__PAstd_Intercept"      
  [26] "cor_record_id__sigma_NAstd_day01__PAstd_Intercept"          
  [27] "cor_record_id__NAstd_Intercept__PAstd_day01"                
  [28] "cor_record_id__NAstd_day01__PAstd_day01"                    
  [29] "cor_record_id__sigma_NAstd_Intercept__PAstd_day01"          
  [30] "cor_record_id__sigma_NAstd_day01__PAstd_day01"              
  [31] "cor_record_id__PAstd_Intercept__PAstd_day01"                
  [32] "cor_record_id__NAstd_Intercept__sigma_PAstd_Intercept"      
  [33] "cor_record_id__NAstd_day01__sigma_PAstd_Intercept"          
  [34] "cor_record_id__sigma_NAstd_Intercept__sigma_PAstd_Intercept"
  [35] "cor_record_id__sigma_NAstd_day01__sigma_PAstd_Intercept"    
  [36] "cor_record_id__PAstd_Intercept__sigma_PAstd_Intercept"      
  [37] "cor_record_id__PAstd_day01__sigma_PAstd_Intercept"          
  [38] "cor_record_id__NAstd_Intercept__sigma_PAstd_day01"          
  [39] "cor_record_id__NAstd_day01__sigma_PAstd_day01"              
  [40] "cor_record_id__sigma_NAstd_Intercept__sigma_PAstd_day01"    
  [41] "cor_record_id__sigma_NAstd_day01__sigma_PAstd_day01"        
  [42] "cor_record_id__PAstd_Intercept__sigma_PAstd_day01"          
  [43] "cor_record_id__PAstd_day01__sigma_PAstd_day01"              
  [44] "cor_record_id__sigma_PAstd_Intercept__sigma_PAstd_day01"    
  [45] "r_record_id__NAstd[1,Intercept]"                            
  [46] "r_record_id__NAstd[2,Intercept]"                            
  [47] "r_record_id__NAstd[3,Intercept]"                            
  [48] "r_record_id__NAstd[4,Intercept]"                            
  [49] "r_record_id__NAstd[5,Intercept]"                            
  [50] "r_record_id__NAstd[6,Intercept]"                            
  [51] "r_record_id__NAstd[7,Intercept]"                            
  [52] "r_record_id__NAstd[8,Intercept]"                            
  [53] "r_record_id__NAstd[9,Intercept]"                            
  [54] "r_record_id__NAstd[10,Intercept]"                           
  [55] "r_record_id__NAstd[11,Intercept]"                           
  [56] "r_record_id__NAstd[12,Intercept]"                           
  [57] "r_record_id__NAstd[13,Intercept]"                           
  [58] "r_record_id__NAstd[14,Intercept]"                           
  [59] "r_record_id__NAstd[15,Intercept]"                           
  [60] "r_record_id__NAstd[16,Intercept]"                           
  [61] "r_record_id__NAstd[17,Intercept]"                           
  [62] "r_record_id__NAstd[20,Intercept]"                           
  [63] "r_record_id__NAstd[23,Intercept]"                           
  [64] "r_record_id__NAstd[24,Intercept]"                           
  [65] "r_record_id__NAstd[25,Intercept]"                           
  [66] "r_record_id__NAstd[26,Intercept]"                           
  [67] "r_record_id__NAstd[27,Intercept]"                           
  [68] "r_record_id__NAstd[28,Intercept]"                           
  [69] "r_record_id__NAstd[29,Intercept]"                           
  [70] "r_record_id__NAstd[30,Intercept]"                           
  [71] "r_record_id__NAstd[31,Intercept]"                           
  [72] "r_record_id__NAstd[32,Intercept]"                           
  [73] "r_record_id__NAstd[33,Intercept]"                           
  [74] "r_record_id__NAstd[34,Intercept]"                           
  [75] "r_record_id__NAstd[35,Intercept]"                           
  [76] "r_record_id__NAstd[36,Intercept]"                           
  [77] "r_record_id__NAstd[37,Intercept]"                           
  [78] "r_record_id__NAstd[38,Intercept]"                           
  [79] "r_record_id__NAstd[39,Intercept]"                           
  [80] "r_record_id__NAstd[40,Intercept]"                           
  [81] "r_record_id__NAstd[41,Intercept]"                           
  [82] "r_record_id__NAstd[42,Intercept]"                           
  [83] "r_record_id__NAstd[43,Intercept]"                           
  [84] "r_record_id__NAstd[44,Intercept]"                           
  [85] "r_record_id__NAstd[46,Intercept]"                           
  [86] "r_record_id__NAstd[47,Intercept]"                           
  [87] "r_record_id__NAstd[48,Intercept]"                           
  [88] "r_record_id__NAstd[49,Intercept]"                           
  [89] "r_record_id__NAstd[50,Intercept]"                           
  [90] "r_record_id__NAstd[51,Intercept]"                           
  [91] "r_record_id__NAstd[52,Intercept]"                           
  [92] "r_record_id__NAstd[53,Intercept]"                           
  [93] "r_record_id__NAstd[54,Intercept]"                           
  [94] "r_record_id__NAstd[55,Intercept]"                           
  [95] "r_record_id__NAstd[56,Intercept]"                           
  [96] "r_record_id__NAstd[58,Intercept]"                           
  [97] "r_record_id__NAstd[60,Intercept]"                           
  [98] "r_record_id__NAstd[64,Intercept]"                           
  [99] "r_record_id__NAstd[65,Intercept]"                           
 [100] "r_record_id__NAstd[67,Intercept]"                           
 [101] "r_record_id__NAstd[68,Intercept]"                           
 [102] "r_record_id__NAstd[69,Intercept]"                           
 [103] "r_record_id__NAstd[70,Intercept]"                           
 [104] "r_record_id__NAstd[72,Intercept]"                           
 [105] "r_record_id__NAstd[73,Intercept]"                           
 [106] "r_record_id__NAstd[75,Intercept]"                           
 [107] "r_record_id__NAstd[76,Intercept]"                           
 [108] "r_record_id__NAstd[80,Intercept]"                           
 [109] "r_record_id__NAstd[81,Intercept]"                           
 [110] "r_record_id__NAstd[82,Intercept]"                           
 [111] "r_record_id__NAstd[83,Intercept]"                           
 [112] "r_record_id__NAstd[85,Intercept]"                           
 [113] "r_record_id__NAstd[86,Intercept]"                           
 [114] "r_record_id__NAstd[88,Intercept]"                           
 [115] "r_record_id__NAstd[91,Intercept]"                           
 [116] "r_record_id__NAstd[92,Intercept]"                           
 [117] "r_record_id__NAstd[94,Intercept]"                           
 [118] "r_record_id__NAstd[95,Intercept]"                           
 [119] "r_record_id__NAstd[96,Intercept]"                           
 [120] "r_record_id__NAstd[97,Intercept]"                           
 [121] "r_record_id__NAstd[98,Intercept]"                           
 [122] "r_record_id__NAstd[99,Intercept]"                           
 [123] "r_record_id__NAstd[100,Intercept]"                          
 [124] "r_record_id__NAstd[101,Intercept]"                          
 [125] "r_record_id__NAstd[102,Intercept]"                          
 [126] "r_record_id__NAstd[104,Intercept]"                          
 [127] "r_record_id__NAstd[105,Intercept]"                          
 [128] "r_record_id__NAstd[106,Intercept]"                          
 [129] "r_record_id__NAstd[107,Intercept]"                          
 [130] "r_record_id__NAstd[109,Intercept]"                          
 [131] "r_record_id__NAstd[110,Intercept]"                          
 [132] "r_record_id__NAstd[111,Intercept]"                          
 [133] "r_record_id__NAstd[112,Intercept]"                          
 [134] "r_record_id__NAstd[113,Intercept]"                          
 [135] "r_record_id__NAstd[114,Intercept]"                          
 [136] "r_record_id__NAstd[115,Intercept]"                          
 [137] "r_record_id__NAstd[116,Intercept]"                          
 [138] "r_record_id__NAstd[117,Intercept]"                          
 [139] "r_record_id__NAstd[119,Intercept]"                          
 [140] "r_record_id__NAstd[120,Intercept]"                          
 [141] "r_record_id__NAstd[121,Intercept]"                          
 [142] "r_record_id__NAstd[123,Intercept]"                          
 [143] "r_record_id__NAstd[125,Intercept]"                          
 [144] "r_record_id__NAstd[127,Intercept]"                          
 [145] "r_record_id__NAstd[128,Intercept]"                          
 [146] "r_record_id__NAstd[129,Intercept]"                          
 [147] "r_record_id__NAstd[132,Intercept]"                          
 [148] "r_record_id__NAstd[133,Intercept]"                          
 [149] "r_record_id__NAstd[134,Intercept]"                          
 [150] "r_record_id__NAstd[135,Intercept]"                          
 [151] "r_record_id__NAstd[136,Intercept]"                          
 [152] "r_record_id__NAstd[137,Intercept]"                          
 [153] "r_record_id__NAstd[138,Intercept]"                          
 [154] "r_record_id__NAstd[139,Intercept]"                          
 [155] "r_record_id__NAstd[140,Intercept]"                          
 [156] "r_record_id__NAstd[142,Intercept]"                          
 [157] "r_record_id__NAstd[143,Intercept]"                          
 [158] "r_record_id__NAstd[144,Intercept]"                          
 [159] "r_record_id__NAstd[145,Intercept]"                          
 [160] "r_record_id__NAstd[147,Intercept]"                          
 [161] "r_record_id__NAstd[148,Intercept]"                          
 [162] "r_record_id__NAstd[149,Intercept]"                          
 [163] "r_record_id__NAstd[150,Intercept]"                          
 [164] "r_record_id__NAstd[151,Intercept]"                          
 [165] "r_record_id__NAstd[152,Intercept]"                          
 [166] "r_record_id__NAstd[153,Intercept]"                          
 [167] "r_record_id__NAstd[154,Intercept]"                          
 [168] "r_record_id__NAstd[155,Intercept]"                          
 [169] "r_record_id__NAstd[157,Intercept]"                          
 [170] "r_record_id__NAstd[158,Intercept]"                          
 [171] "r_record_id__NAstd[160,Intercept]"                          
 [172] "r_record_id__NAstd[162,Intercept]"                          
 [173] "r_record_id__NAstd[163,Intercept]"                          
 [174] "r_record_id__NAstd[164,Intercept]"                          
 [175] "r_record_id__NAstd[165,Intercept]"                          
 [176] "r_record_id__NAstd[166,Intercept]"                          
 [177] "r_record_id__NAstd[167,Intercept]"                          
 [178] "r_record_id__NAstd[168,Intercept]"                          
 [179] "r_record_id__NAstd[169,Intercept]"                          
 [180] "r_record_id__NAstd[170,Intercept]"                          
 [181] "r_record_id__NAstd[171,Intercept]"                          
 [182] "r_record_id__NAstd[173,Intercept]"                          
 [183] "r_record_id__NAstd[174,Intercept]"                          
 [184] "r_record_id__NAstd[176,Intercept]"                          
 [185] "r_record_id__NAstd[177,Intercept]"                          
 [186] "r_record_id__NAstd[178,Intercept]"                          
 [187] "r_record_id__NAstd[181,Intercept]"                          
 [188] "r_record_id__NAstd[182,Intercept]"                          
 [189] "r_record_id__NAstd[183,Intercept]"                          
 [190] "r_record_id__NAstd[184,Intercept]"                          
 [191] "r_record_id__NAstd[185,Intercept]"                          
 [192] "r_record_id__NAstd[186,Intercept]"                          
 [193] "r_record_id__NAstd[188,Intercept]"                          
 [194] "r_record_id__NAstd[189,Intercept]"                          
 [195] "r_record_id__NAstd[190,Intercept]"                          
 [196] "r_record_id__NAstd[191,Intercept]"                          
 [197] "r_record_id__NAstd[194,Intercept]"                          
 [198] "r_record_id__NAstd[195,Intercept]"                          
 [199] "r_record_id__NAstd[196,Intercept]"                          
 [200] "r_record_id__NAstd[197,Intercept]"                          
 [201] "r_record_id__NAstd[198,Intercept]"                          
 [202] "r_record_id__NAstd[199,Intercept]"                          
 [203] "r_record_id__NAstd[201,Intercept]"                          
 [204] "r_record_id__NAstd[202,Intercept]"                          
 [205] "r_record_id__NAstd[203,Intercept]"                          
 [206] "r_record_id__NAstd[204,Intercept]"                          
 [207] "r_record_id__NAstd[205,Intercept]"                          
 [208] "r_record_id__NAstd[206,Intercept]"                          
 [209] "r_record_id__NAstd[207,Intercept]"                          
 [210] "r_record_id__NAstd[208,Intercept]"                          
 [211] "r_record_id__NAstd[209,Intercept]"                          
 [212] "r_record_id__NAstd[211,Intercept]"                          
 [213] "r_record_id__NAstd[212,Intercept]"                          
 [214] "r_record_id__NAstd[213,Intercept]"                          
 [215] "r_record_id__NAstd[214,Intercept]"                          
 [216] "r_record_id__NAstd[216,Intercept]"                          
 [217] "r_record_id__NAstd[217,Intercept]"                          
 [218] "r_record_id__NAstd[219,Intercept]"                          
 [219] "r_record_id__NAstd[220,Intercept]"                          
 [220] "r_record_id__NAstd[221,Intercept]"                          
 [221] "r_record_id__NAstd[222,Intercept]"                          
 [222] "r_record_id__NAstd[223,Intercept]"                          
 [223] "r_record_id__NAstd[224,Intercept]"                          
 [224] "r_record_id__NAstd[225,Intercept]"                          
 [225] "r_record_id__NAstd[226,Intercept]"                          
 [226] "r_record_id__NAstd[227,Intercept]"                          
 [227] "r_record_id__NAstd[228,Intercept]"                          
 [228] "r_record_id__NAstd[229,Intercept]"                          
 [229] "r_record_id__NAstd[230,Intercept]"                          
 [230] "r_record_id__NAstd[231,Intercept]"                          
 [231] "r_record_id__NAstd[232,Intercept]"                          
 [232] "r_record_id__NAstd[233,Intercept]"                          
 [233] "r_record_id__NAstd[234,Intercept]"                          
 [234] "r_record_id__NAstd[236,Intercept]"                          
 [235] "r_record_id__NAstd[237,Intercept]"                          
 [236] "r_record_id__NAstd[238,Intercept]"                          
 [237] "r_record_id__NAstd[239,Intercept]"                          
 [238] "r_record_id__NAstd[1,day01]"                                
 [239] "r_record_id__NAstd[2,day01]"                                
 [240] "r_record_id__NAstd[3,day01]"                                
 [241] "r_record_id__NAstd[4,day01]"                                
 [242] "r_record_id__NAstd[5,day01]"                                
 [243] "r_record_id__NAstd[6,day01]"                                
 [244] "r_record_id__NAstd[7,day01]"                                
 [245] "r_record_id__NAstd[8,day01]"                                
 [246] "r_record_id__NAstd[9,day01]"                                
 [247] "r_record_id__NAstd[10,day01]"                               
 [248] "r_record_id__NAstd[11,day01]"                               
 [249] "r_record_id__NAstd[12,day01]"                               
 [250] "r_record_id__NAstd[13,day01]"                               
 [251] "r_record_id__NAstd[14,day01]"                               
 [252] "r_record_id__NAstd[15,day01]"                               
 [253] "r_record_id__NAstd[16,day01]"                               
 [254] "r_record_id__NAstd[17,day01]"                               
 [255] "r_record_id__NAstd[20,day01]"                               
 [256] "r_record_id__NAstd[23,day01]"                               
 [257] "r_record_id__NAstd[24,day01]"                               
 [258] "r_record_id__NAstd[25,day01]"                               
 [259] "r_record_id__NAstd[26,day01]"                               
 [260] "r_record_id__NAstd[27,day01]"                               
 [261] "r_record_id__NAstd[28,day01]"                               
 [262] "r_record_id__NAstd[29,day01]"                               
 [263] "r_record_id__NAstd[30,day01]"                               
 [264] "r_record_id__NAstd[31,day01]"                               
 [265] "r_record_id__NAstd[32,day01]"                               
 [266] "r_record_id__NAstd[33,day01]"                               
 [267] "r_record_id__NAstd[34,day01]"                               
 [268] "r_record_id__NAstd[35,day01]"                               
 [269] "r_record_id__NAstd[36,day01]"                               
 [270] "r_record_id__NAstd[37,day01]"                               
 [271] "r_record_id__NAstd[38,day01]"                               
 [272] "r_record_id__NAstd[39,day01]"                               
 [273] "r_record_id__NAstd[40,day01]"                               
 [274] "r_record_id__NAstd[41,day01]"                               
 [275] "r_record_id__NAstd[42,day01]"                               
 [276] "r_record_id__NAstd[43,day01]"                               
 [277] "r_record_id__NAstd[44,day01]"                               
 [278] "r_record_id__NAstd[46,day01]"                               
 [279] "r_record_id__NAstd[47,day01]"                               
 [280] "r_record_id__NAstd[48,day01]"                               
 [281] "r_record_id__NAstd[49,day01]"                               
 [282] "r_record_id__NAstd[50,day01]"                               
 [283] "r_record_id__NAstd[51,day01]"                               
 [284] "r_record_id__NAstd[52,day01]"                               
 [285] "r_record_id__NAstd[53,day01]"                               
 [286] "r_record_id__NAstd[54,day01]"                               
 [287] "r_record_id__NAstd[55,day01]"                               
 [288] "r_record_id__NAstd[56,day01]"                               
 [289] "r_record_id__NAstd[58,day01]"                               
 [290] "r_record_id__NAstd[60,day01]"                               
 [291] "r_record_id__NAstd[64,day01]"                               
 [292] "r_record_id__NAstd[65,day01]"                               
 [293] "r_record_id__NAstd[67,day01]"                               
 [294] "r_record_id__NAstd[68,day01]"                               
 [295] "r_record_id__NAstd[69,day01]"                               
 [296] "r_record_id__NAstd[70,day01]"                               
 [297] "r_record_id__NAstd[72,day01]"                               
 [298] "r_record_id__NAstd[73,day01]"                               
 [299] "r_record_id__NAstd[75,day01]"                               
 [300] "r_record_id__NAstd[76,day01]"                               
 [301] "r_record_id__NAstd[80,day01]"                               
 [302] "r_record_id__NAstd[81,day01]"                               
 [303] "r_record_id__NAstd[82,day01]"                               
 [304] "r_record_id__NAstd[83,day01]"                               
 [305] "r_record_id__NAstd[85,day01]"                               
 [306] "r_record_id__NAstd[86,day01]"                               
 [307] "r_record_id__NAstd[88,day01]"                               
 [308] "r_record_id__NAstd[91,day01]"                               
 [309] "r_record_id__NAstd[92,day01]"                               
 [310] "r_record_id__NAstd[94,day01]"                               
 [311] "r_record_id__NAstd[95,day01]"                               
 [312] "r_record_id__NAstd[96,day01]"                               
 [313] "r_record_id__NAstd[97,day01]"                               
 [314] "r_record_id__NAstd[98,day01]"                               
 [315] "r_record_id__NAstd[99,day01]"                               
 [316] "r_record_id__NAstd[100,day01]"                              
 [317] "r_record_id__NAstd[101,day01]"                              
 [318] "r_record_id__NAstd[102,day01]"                              
 [319] "r_record_id__NAstd[104,day01]"                              
 [320] "r_record_id__NAstd[105,day01]"                              
 [321] "r_record_id__NAstd[106,day01]"                              
 [322] "r_record_id__NAstd[107,day01]"                              
 [323] "r_record_id__NAstd[109,day01]"                              
 [324] "r_record_id__NAstd[110,day01]"                              
 [325] "r_record_id__NAstd[111,day01]"                              
 [326] "r_record_id__NAstd[112,day01]"                              
 [327] "r_record_id__NAstd[113,day01]"                              
 [328] "r_record_id__NAstd[114,day01]"                              
 [329] "r_record_id__NAstd[115,day01]"                              
 [330] "r_record_id__NAstd[116,day01]"                              
 [331] "r_record_id__NAstd[117,day01]"                              
 [332] "r_record_id__NAstd[119,day01]"                              
 [333] "r_record_id__NAstd[120,day01]"                              
 [334] "r_record_id__NAstd[121,day01]"                              
 [335] "r_record_id__NAstd[123,day01]"                              
 [336] "r_record_id__NAstd[125,day01]"                              
 [337] "r_record_id__NAstd[127,day01]"                              
 [338] "r_record_id__NAstd[128,day01]"                              
 [339] "r_record_id__NAstd[129,day01]"                              
 [340] "r_record_id__NAstd[132,day01]"                              
 [341] "r_record_id__NAstd[133,day01]"                              
 [342] "r_record_id__NAstd[134,day01]"                              
 [343] "r_record_id__NAstd[135,day01]"                              
 [344] "r_record_id__NAstd[136,day01]"                              
 [345] "r_record_id__NAstd[137,day01]"                              
 [346] "r_record_id__NAstd[138,day01]"                              
 [347] "r_record_id__NAstd[139,day01]"                              
 [348] "r_record_id__NAstd[140,day01]"                              
 [349] "r_record_id__NAstd[142,day01]"                              
 [350] "r_record_id__NAstd[143,day01]"                              
 [351] "r_record_id__NAstd[144,day01]"                              
 [352] "r_record_id__NAstd[145,day01]"                              
 [353] "r_record_id__NAstd[147,day01]"                              
 [354] "r_record_id__NAstd[148,day01]"                              
 [355] "r_record_id__NAstd[149,day01]"                              
 [356] "r_record_id__NAstd[150,day01]"                              
 [357] "r_record_id__NAstd[151,day01]"                              
 [358] "r_record_id__NAstd[152,day01]"                              
 [359] "r_record_id__NAstd[153,day01]"                              
 [360] "r_record_id__NAstd[154,day01]"                              
 [361] "r_record_id__NAstd[155,day01]"                              
 [362] "r_record_id__NAstd[157,day01]"                              
 [363] "r_record_id__NAstd[158,day01]"                              
 [364] "r_record_id__NAstd[160,day01]"                              
 [365] "r_record_id__NAstd[162,day01]"                              
 [366] "r_record_id__NAstd[163,day01]"                              
 [367] "r_record_id__NAstd[164,day01]"                              
 [368] "r_record_id__NAstd[165,day01]"                              
 [369] "r_record_id__NAstd[166,day01]"                              
 [370] "r_record_id__NAstd[167,day01]"                              
 [371] "r_record_id__NAstd[168,day01]"                              
 [372] "r_record_id__NAstd[169,day01]"                              
 [373] "r_record_id__NAstd[170,day01]"                              
 [374] "r_record_id__NAstd[171,day01]"                              
 [375] "r_record_id__NAstd[173,day01]"                              
 [376] "r_record_id__NAstd[174,day01]"                              
 [377] "r_record_id__NAstd[176,day01]"                              
 [378] "r_record_id__NAstd[177,day01]"                              
 [379] "r_record_id__NAstd[178,day01]"                              
 [380] "r_record_id__NAstd[181,day01]"                              
 [381] "r_record_id__NAstd[182,day01]"                              
 [382] "r_record_id__NAstd[183,day01]"                              
 [383] "r_record_id__NAstd[184,day01]"                              
 [384] "r_record_id__NAstd[185,day01]"                              
 [385] "r_record_id__NAstd[186,day01]"                              
 [386] "r_record_id__NAstd[188,day01]"                              
 [387] "r_record_id__NAstd[189,day01]"                              
 [388] "r_record_id__NAstd[190,day01]"                              
 [389] "r_record_id__NAstd[191,day01]"                              
 [390] "r_record_id__NAstd[194,day01]"                              
 [391] "r_record_id__NAstd[195,day01]"                              
 [392] "r_record_id__NAstd[196,day01]"                              
 [393] "r_record_id__NAstd[197,day01]"                              
 [394] "r_record_id__NAstd[198,day01]"                              
 [395] "r_record_id__NAstd[199,day01]"                              
 [396] "r_record_id__NAstd[201,day01]"                              
 [397] "r_record_id__NAstd[202,day01]"                              
 [398] "r_record_id__NAstd[203,day01]"                              
 [399] "r_record_id__NAstd[204,day01]"                              
 [400] "r_record_id__NAstd[205,day01]"                              
 [401] "r_record_id__NAstd[206,day01]"                              
 [402] "r_record_id__NAstd[207,day01]"                              
 [403] "r_record_id__NAstd[208,day01]"                              
 [404] "r_record_id__NAstd[209,day01]"                              
 [405] "r_record_id__NAstd[211,day01]"                              
 [406] "r_record_id__NAstd[212,day01]"                              
 [407] "r_record_id__NAstd[213,day01]"                              
 [408] "r_record_id__NAstd[214,day01]"                              
 [409] "r_record_id__NAstd[216,day01]"                              
 [410] "r_record_id__NAstd[217,day01]"                              
 [411] "r_record_id__NAstd[219,day01]"                              
 [412] "r_record_id__NAstd[220,day01]"                              
 [413] "r_record_id__NAstd[221,day01]"                              
 [414] "r_record_id__NAstd[222,day01]"                              
 [415] "r_record_id__NAstd[223,day01]"                              
 [416] "r_record_id__NAstd[224,day01]"                              
 [417] "r_record_id__NAstd[225,day01]"                              
 [418] "r_record_id__NAstd[226,day01]"                              
 [419] "r_record_id__NAstd[227,day01]"                              
 [420] "r_record_id__NAstd[228,day01]"                              
 [421] "r_record_id__NAstd[229,day01]"                              
 [422] "r_record_id__NAstd[230,day01]"                              
 [423] "r_record_id__NAstd[231,day01]"                              
 [424] "r_record_id__NAstd[232,day01]"                              
 [425] "r_record_id__NAstd[233,day01]"                              
 [426] "r_record_id__NAstd[234,day01]"                              
 [427] "r_record_id__NAstd[236,day01]"                              
 [428] "r_record_id__NAstd[237,day01]"                              
 [429] "r_record_id__NAstd[238,day01]"                              
 [430] "r_record_id__NAstd[239,day01]"                              
 [431] "r_record_id__sigma_NAstd[1,Intercept]"                      
 [432] "r_record_id__sigma_NAstd[2,Intercept]"                      
 [433] "r_record_id__sigma_NAstd[3,Intercept]"                      
 [434] "r_record_id__sigma_NAstd[4,Intercept]"                      
 [435] "r_record_id__sigma_NAstd[5,Intercept]"                      
 [436] "r_record_id__sigma_NAstd[6,Intercept]"                      
 [437] "r_record_id__sigma_NAstd[7,Intercept]"                      
 [438] "r_record_id__sigma_NAstd[8,Intercept]"                      
 [439] "r_record_id__sigma_NAstd[9,Intercept]"                      
 [440] "r_record_id__sigma_NAstd[10,Intercept]"                     
 [441] "r_record_id__sigma_NAstd[11,Intercept]"                     
 [442] "r_record_id__sigma_NAstd[12,Intercept]"                     
 [443] "r_record_id__sigma_NAstd[13,Intercept]"                     
 [444] "r_record_id__sigma_NAstd[14,Intercept]"                     
 [445] "r_record_id__sigma_NAstd[15,Intercept]"                     
 [446] "r_record_id__sigma_NAstd[16,Intercept]"                     
 [447] "r_record_id__sigma_NAstd[17,Intercept]"                     
 [448] "r_record_id__sigma_NAstd[20,Intercept]"                     
 [449] "r_record_id__sigma_NAstd[23,Intercept]"                     
 [450] "r_record_id__sigma_NAstd[24,Intercept]"                     
 [451] "r_record_id__sigma_NAstd[25,Intercept]"                     
 [452] "r_record_id__sigma_NAstd[26,Intercept]"                     
 [453] "r_record_id__sigma_NAstd[27,Intercept]"                     
 [454] "r_record_id__sigma_NAstd[28,Intercept]"                     
 [455] "r_record_id__sigma_NAstd[29,Intercept]"                     
 [456] "r_record_id__sigma_NAstd[30,Intercept]"                     
 [457] "r_record_id__sigma_NAstd[31,Intercept]"                     
 [458] "r_record_id__sigma_NAstd[32,Intercept]"                     
 [459] "r_record_id__sigma_NAstd[33,Intercept]"                     
 [460] "r_record_id__sigma_NAstd[34,Intercept]"                     
 [461] "r_record_id__sigma_NAstd[35,Intercept]"                     
 [462] "r_record_id__sigma_NAstd[36,Intercept]"                     
 [463] "r_record_id__sigma_NAstd[37,Intercept]"                     
 [464] "r_record_id__sigma_NAstd[38,Intercept]"                     
 [465] "r_record_id__sigma_NAstd[39,Intercept]"                     
 [466] "r_record_id__sigma_NAstd[40,Intercept]"                     
 [467] "r_record_id__sigma_NAstd[41,Intercept]"                     
 [468] "r_record_id__sigma_NAstd[42,Intercept]"                     
 [469] "r_record_id__sigma_NAstd[43,Intercept]"                     
 [470] "r_record_id__sigma_NAstd[44,Intercept]"                     
 [471] "r_record_id__sigma_NAstd[46,Intercept]"                     
 [472] "r_record_id__sigma_NAstd[47,Intercept]"                     
 [473] "r_record_id__sigma_NAstd[48,Intercept]"                     
 [474] "r_record_id__sigma_NAstd[49,Intercept]"                     
 [475] "r_record_id__sigma_NAstd[50,Intercept]"                     
 [476] "r_record_id__sigma_NAstd[51,Intercept]"                     
 [477] "r_record_id__sigma_NAstd[52,Intercept]"                     
 [478] "r_record_id__sigma_NAstd[53,Intercept]"                     
 [479] "r_record_id__sigma_NAstd[54,Intercept]"                     
 [480] "r_record_id__sigma_NAstd[55,Intercept]"                     
 [481] "r_record_id__sigma_NAstd[56,Intercept]"                     
 [482] "r_record_id__sigma_NAstd[58,Intercept]"                     
 [483] "r_record_id__sigma_NAstd[60,Intercept]"                     
 [484] "r_record_id__sigma_NAstd[64,Intercept]"                     
 [485] "r_record_id__sigma_NAstd[65,Intercept]"                     
 [486] "r_record_id__sigma_NAstd[67,Intercept]"                     
 [487] "r_record_id__sigma_NAstd[68,Intercept]"                     
 [488] "r_record_id__sigma_NAstd[69,Intercept]"                     
 [489] "r_record_id__sigma_NAstd[70,Intercept]"                     
 [490] "r_record_id__sigma_NAstd[72,Intercept]"                     
 [491] "r_record_id__sigma_NAstd[73,Intercept]"                     
 [492] "r_record_id__sigma_NAstd[75,Intercept]"                     
 [493] "r_record_id__sigma_NAstd[76,Intercept]"                     
 [494] "r_record_id__sigma_NAstd[80,Intercept]"                     
 [495] "r_record_id__sigma_NAstd[81,Intercept]"                     
 [496] "r_record_id__sigma_NAstd[82,Intercept]"                     
 [497] "r_record_id__sigma_NAstd[83,Intercept]"                     
 [498] "r_record_id__sigma_NAstd[85,Intercept]"                     
 [499] "r_record_id__sigma_NAstd[86,Intercept]"                     
 [500] "r_record_id__sigma_NAstd[88,Intercept]"                     
 [501] "r_record_id__sigma_NAstd[91,Intercept]"                     
 [502] "r_record_id__sigma_NAstd[92,Intercept]"                     
 [503] "r_record_id__sigma_NAstd[94,Intercept]"                     
 [504] "r_record_id__sigma_NAstd[95,Intercept]"                     
 [505] "r_record_id__sigma_NAstd[96,Intercept]"                     
 [506] "r_record_id__sigma_NAstd[97,Intercept]"                     
 [507] "r_record_id__sigma_NAstd[98,Intercept]"                     
 [508] "r_record_id__sigma_NAstd[99,Intercept]"                     
 [509] "r_record_id__sigma_NAstd[100,Intercept]"                    
 [510] "r_record_id__sigma_NAstd[101,Intercept]"                    
 [511] "r_record_id__sigma_NAstd[102,Intercept]"                    
 [512] "r_record_id__sigma_NAstd[104,Intercept]"                    
 [513] "r_record_id__sigma_NAstd[105,Intercept]"                    
 [514] "r_record_id__sigma_NAstd[106,Intercept]"                    
 [515] "r_record_id__sigma_NAstd[107,Intercept]"                    
 [516] "r_record_id__sigma_NAstd[109,Intercept]"                    
 [517] "r_record_id__sigma_NAstd[110,Intercept]"                    
 [518] "r_record_id__sigma_NAstd[111,Intercept]"                    
 [519] "r_record_id__sigma_NAstd[112,Intercept]"                    
 [520] "r_record_id__sigma_NAstd[113,Intercept]"                    
 [521] "r_record_id__sigma_NAstd[114,Intercept]"                    
 [522] "r_record_id__sigma_NAstd[115,Intercept]"                    
 [523] "r_record_id__sigma_NAstd[116,Intercept]"                    
 [524] "r_record_id__sigma_NAstd[117,Intercept]"                    
 [525] "r_record_id__sigma_NAstd[119,Intercept]"                    
 [526] "r_record_id__sigma_NAstd[120,Intercept]"                    
 [527] "r_record_id__sigma_NAstd[121,Intercept]"                    
 [528] "r_record_id__sigma_NAstd[123,Intercept]"                    
 [529] "r_record_id__sigma_NAstd[125,Intercept]"                    
 [530] "r_record_id__sigma_NAstd[127,Intercept]"                    
 [531] "r_record_id__sigma_NAstd[128,Intercept]"                    
 [532] "r_record_id__sigma_NAstd[129,Intercept]"                    
 [533] "r_record_id__sigma_NAstd[132,Intercept]"                    
 [534] "r_record_id__sigma_NAstd[133,Intercept]"                    
 [535] "r_record_id__sigma_NAstd[134,Intercept]"                    
 [536] "r_record_id__sigma_NAstd[135,Intercept]"                    
 [537] "r_record_id__sigma_NAstd[136,Intercept]"                    
 [538] "r_record_id__sigma_NAstd[137,Intercept]"                    
 [539] "r_record_id__sigma_NAstd[138,Intercept]"                    
 [540] "r_record_id__sigma_NAstd[139,Intercept]"                    
 [541] "r_record_id__sigma_NAstd[140,Intercept]"                    
 [542] "r_record_id__sigma_NAstd[142,Intercept]"                    
 [543] "r_record_id__sigma_NAstd[143,Intercept]"                    
 [544] "r_record_id__sigma_NAstd[144,Intercept]"                    
 [545] "r_record_id__sigma_NAstd[145,Intercept]"                    
 [546] "r_record_id__sigma_NAstd[147,Intercept]"                    
 [547] "r_record_id__sigma_NAstd[148,Intercept]"                    
 [548] "r_record_id__sigma_NAstd[149,Intercept]"                    
 [549] "r_record_id__sigma_NAstd[150,Intercept]"                    
 [550] "r_record_id__sigma_NAstd[151,Intercept]"                    
 [551] "r_record_id__sigma_NAstd[152,Intercept]"                    
 [552] "r_record_id__sigma_NAstd[153,Intercept]"                    
 [553] "r_record_id__sigma_NAstd[154,Intercept]"                    
 [554] "r_record_id__sigma_NAstd[155,Intercept]"                    
 [555] "r_record_id__sigma_NAstd[157,Intercept]"                    
 [556] "r_record_id__sigma_NAstd[158,Intercept]"                    
 [557] "r_record_id__sigma_NAstd[160,Intercept]"                    
 [558] "r_record_id__sigma_NAstd[162,Intercept]"                    
 [559] "r_record_id__sigma_NAstd[163,Intercept]"                    
 [560] "r_record_id__sigma_NAstd[164,Intercept]"                    
 [561] "r_record_id__sigma_NAstd[165,Intercept]"                    
 [562] "r_record_id__sigma_NAstd[166,Intercept]"                    
 [563] "r_record_id__sigma_NAstd[167,Intercept]"                    
 [564] "r_record_id__sigma_NAstd[168,Intercept]"                    
 [565] "r_record_id__sigma_NAstd[169,Intercept]"                    
 [566] "r_record_id__sigma_NAstd[170,Intercept]"                    
 [567] "r_record_id__sigma_NAstd[171,Intercept]"                    
 [568] "r_record_id__sigma_NAstd[173,Intercept]"                    
 [569] "r_record_id__sigma_NAstd[174,Intercept]"                    
 [570] "r_record_id__sigma_NAstd[176,Intercept]"                    
 [571] "r_record_id__sigma_NAstd[177,Intercept]"                    
 [572] "r_record_id__sigma_NAstd[178,Intercept]"                    
 [573] "r_record_id__sigma_NAstd[181,Intercept]"                    
 [574] "r_record_id__sigma_NAstd[182,Intercept]"                    
 [575] "r_record_id__sigma_NAstd[183,Intercept]"                    
 [576] "r_record_id__sigma_NAstd[184,Intercept]"                    
 [577] "r_record_id__sigma_NAstd[185,Intercept]"                    
 [578] "r_record_id__sigma_NAstd[186,Intercept]"                    
 [579] "r_record_id__sigma_NAstd[188,Intercept]"                    
 [580] "r_record_id__sigma_NAstd[189,Intercept]"                    
 [581] "r_record_id__sigma_NAstd[190,Intercept]"                    
 [582] "r_record_id__sigma_NAstd[191,Intercept]"                    
 [583] "r_record_id__sigma_NAstd[194,Intercept]"                    
 [584] "r_record_id__sigma_NAstd[195,Intercept]"                    
 [585] "r_record_id__sigma_NAstd[196,Intercept]"                    
 [586] "r_record_id__sigma_NAstd[197,Intercept]"                    
 [587] "r_record_id__sigma_NAstd[198,Intercept]"                    
 [588] "r_record_id__sigma_NAstd[199,Intercept]"                    
 [589] "r_record_id__sigma_NAstd[201,Intercept]"                    
 [590] "r_record_id__sigma_NAstd[202,Intercept]"                    
 [591] "r_record_id__sigma_NAstd[203,Intercept]"                    
 [592] "r_record_id__sigma_NAstd[204,Intercept]"                    
 [593] "r_record_id__sigma_NAstd[205,Intercept]"                    
 [594] "r_record_id__sigma_NAstd[206,Intercept]"                    
 [595] "r_record_id__sigma_NAstd[207,Intercept]"                    
 [596] "r_record_id__sigma_NAstd[208,Intercept]"                    
 [597] "r_record_id__sigma_NAstd[209,Intercept]"                    
 [598] "r_record_id__sigma_NAstd[211,Intercept]"                    
 [599] "r_record_id__sigma_NAstd[212,Intercept]"                    
 [600] "r_record_id__sigma_NAstd[213,Intercept]"                    
 [601] "r_record_id__sigma_NAstd[214,Intercept]"                    
 [602] "r_record_id__sigma_NAstd[216,Intercept]"                    
 [603] "r_record_id__sigma_NAstd[217,Intercept]"                    
 [604] "r_record_id__sigma_NAstd[219,Intercept]"                    
 [605] "r_record_id__sigma_NAstd[220,Intercept]"                    
 [606] "r_record_id__sigma_NAstd[221,Intercept]"                    
 [607] "r_record_id__sigma_NAstd[222,Intercept]"                    
 [608] "r_record_id__sigma_NAstd[223,Intercept]"                    
 [609] "r_record_id__sigma_NAstd[224,Intercept]"                    
 [610] "r_record_id__sigma_NAstd[225,Intercept]"                    
 [611] "r_record_id__sigma_NAstd[226,Intercept]"                    
 [612] "r_record_id__sigma_NAstd[227,Intercept]"                    
 [613] "r_record_id__sigma_NAstd[228,Intercept]"                    
 [614] "r_record_id__sigma_NAstd[229,Intercept]"                    
 [615] "r_record_id__sigma_NAstd[230,Intercept]"                    
 [616] "r_record_id__sigma_NAstd[231,Intercept]"                    
 [617] "r_record_id__sigma_NAstd[232,Intercept]"                    
 [618] "r_record_id__sigma_NAstd[233,Intercept]"                    
 [619] "r_record_id__sigma_NAstd[234,Intercept]"                    
 [620] "r_record_id__sigma_NAstd[236,Intercept]"                    
 [621] "r_record_id__sigma_NAstd[237,Intercept]"                    
 [622] "r_record_id__sigma_NAstd[238,Intercept]"                    
 [623] "r_record_id__sigma_NAstd[239,Intercept]"                    
 [624] "r_record_id__sigma_NAstd[1,day01]"                          
 [625] "r_record_id__sigma_NAstd[2,day01]"                          
 [626] "r_record_id__sigma_NAstd[3,day01]"                          
 [627] "r_record_id__sigma_NAstd[4,day01]"                          
 [628] "r_record_id__sigma_NAstd[5,day01]"                          
 [629] "r_record_id__sigma_NAstd[6,day01]"                          
 [630] "r_record_id__sigma_NAstd[7,day01]"                          
 [631] "r_record_id__sigma_NAstd[8,day01]"                          
 [632] "r_record_id__sigma_NAstd[9,day01]"                          
 [633] "r_record_id__sigma_NAstd[10,day01]"                         
 [634] "r_record_id__sigma_NAstd[11,day01]"                         
 [635] "r_record_id__sigma_NAstd[12,day01]"                         
 [636] "r_record_id__sigma_NAstd[13,day01]"                         
 [637] "r_record_id__sigma_NAstd[14,day01]"                         
 [638] "r_record_id__sigma_NAstd[15,day01]"                         
 [639] "r_record_id__sigma_NAstd[16,day01]"                         
 [640] "r_record_id__sigma_NAstd[17,day01]"                         
 [641] "r_record_id__sigma_NAstd[20,day01]"                         
 [642] "r_record_id__sigma_NAstd[23,day01]"                         
 [643] "r_record_id__sigma_NAstd[24,day01]"                         
 [644] "r_record_id__sigma_NAstd[25,day01]"                         
 [645] "r_record_id__sigma_NAstd[26,day01]"                         
 [646] "r_record_id__sigma_NAstd[27,day01]"                         
 [647] "r_record_id__sigma_NAstd[28,day01]"                         
 [648] "r_record_id__sigma_NAstd[29,day01]"                         
 [649] "r_record_id__sigma_NAstd[30,day01]"                         
 [650] "r_record_id__sigma_NAstd[31,day01]"                         
 [651] "r_record_id__sigma_NAstd[32,day01]"                         
 [652] "r_record_id__sigma_NAstd[33,day01]"                         
 [653] "r_record_id__sigma_NAstd[34,day01]"                         
 [654] "r_record_id__sigma_NAstd[35,day01]"                         
 [655] "r_record_id__sigma_NAstd[36,day01]"                         
 [656] "r_record_id__sigma_NAstd[37,day01]"                         
 [657] "r_record_id__sigma_NAstd[38,day01]"                         
 [658] "r_record_id__sigma_NAstd[39,day01]"                         
 [659] "r_record_id__sigma_NAstd[40,day01]"                         
 [660] "r_record_id__sigma_NAstd[41,day01]"                         
 [661] "r_record_id__sigma_NAstd[42,day01]"                         
 [662] "r_record_id__sigma_NAstd[43,day01]"                         
 [663] "r_record_id__sigma_NAstd[44,day01]"                         
 [664] "r_record_id__sigma_NAstd[46,day01]"                         
 [665] "r_record_id__sigma_NAstd[47,day01]"                         
 [666] "r_record_id__sigma_NAstd[48,day01]"                         
 [667] "r_record_id__sigma_NAstd[49,day01]"                         
 [668] "r_record_id__sigma_NAstd[50,day01]"                         
 [669] "r_record_id__sigma_NAstd[51,day01]"                         
 [670] "r_record_id__sigma_NAstd[52,day01]"                         
 [671] "r_record_id__sigma_NAstd[53,day01]"                         
 [672] "r_record_id__sigma_NAstd[54,day01]"                         
 [673] "r_record_id__sigma_NAstd[55,day01]"                         
 [674] "r_record_id__sigma_NAstd[56,day01]"                         
 [675] "r_record_id__sigma_NAstd[58,day01]"                         
 [676] "r_record_id__sigma_NAstd[60,day01]"                         
 [677] "r_record_id__sigma_NAstd[64,day01]"                         
 [678] "r_record_id__sigma_NAstd[65,day01]"                         
 [679] "r_record_id__sigma_NAstd[67,day01]"                         
 [680] "r_record_id__sigma_NAstd[68,day01]"                         
 [681] "r_record_id__sigma_NAstd[69,day01]"                         
 [682] "r_record_id__sigma_NAstd[70,day01]"                         
 [683] "r_record_id__sigma_NAstd[72,day01]"                         
 [684] "r_record_id__sigma_NAstd[73,day01]"                         
 [685] "r_record_id__sigma_NAstd[75,day01]"                         
 [686] "r_record_id__sigma_NAstd[76,day01]"                         
 [687] "r_record_id__sigma_NAstd[80,day01]"                         
 [688] "r_record_id__sigma_NAstd[81,day01]"                         
 [689] "r_record_id__sigma_NAstd[82,day01]"                         
 [690] "r_record_id__sigma_NAstd[83,day01]"                         
 [691] "r_record_id__sigma_NAstd[85,day01]"                         
 [692] "r_record_id__sigma_NAstd[86,day01]"                         
 [693] "r_record_id__sigma_NAstd[88,day01]"                         
 [694] "r_record_id__sigma_NAstd[91,day01]"                         
 [695] "r_record_id__sigma_NAstd[92,day01]"                         
 [696] "r_record_id__sigma_NAstd[94,day01]"                         
 [697] "r_record_id__sigma_NAstd[95,day01]"                         
 [698] "r_record_id__sigma_NAstd[96,day01]"                         
 [699] "r_record_id__sigma_NAstd[97,day01]"                         
 [700] "r_record_id__sigma_NAstd[98,day01]"                         
 [701] "r_record_id__sigma_NAstd[99,day01]"                         
 [702] "r_record_id__sigma_NAstd[100,day01]"                        
 [703] "r_record_id__sigma_NAstd[101,day01]"                        
 [704] "r_record_id__sigma_NAstd[102,day01]"                        
 [705] "r_record_id__sigma_NAstd[104,day01]"                        
 [706] "r_record_id__sigma_NAstd[105,day01]"                        
 [707] "r_record_id__sigma_NAstd[106,day01]"                        
 [708] "r_record_id__sigma_NAstd[107,day01]"                        
 [709] "r_record_id__sigma_NAstd[109,day01]"                        
 [710] "r_record_id__sigma_NAstd[110,day01]"                        
 [711] "r_record_id__sigma_NAstd[111,day01]"                        
 [712] "r_record_id__sigma_NAstd[112,day01]"                        
 [713] "r_record_id__sigma_NAstd[113,day01]"                        
 [714] "r_record_id__sigma_NAstd[114,day01]"                        
 [715] "r_record_id__sigma_NAstd[115,day01]"                        
 [716] "r_record_id__sigma_NAstd[116,day01]"                        
 [717] "r_record_id__sigma_NAstd[117,day01]"                        
 [718] "r_record_id__sigma_NAstd[119,day01]"                        
 [719] "r_record_id__sigma_NAstd[120,day01]"                        
 [720] "r_record_id__sigma_NAstd[121,day01]"                        
 [721] "r_record_id__sigma_NAstd[123,day01]"                        
 [722] "r_record_id__sigma_NAstd[125,day01]"                        
 [723] "r_record_id__sigma_NAstd[127,day01]"                        
 [724] "r_record_id__sigma_NAstd[128,day01]"                        
 [725] "r_record_id__sigma_NAstd[129,day01]"                        
 [726] "r_record_id__sigma_NAstd[132,day01]"                        
 [727] "r_record_id__sigma_NAstd[133,day01]"                        
 [728] "r_record_id__sigma_NAstd[134,day01]"                        
 [729] "r_record_id__sigma_NAstd[135,day01]"                        
 [730] "r_record_id__sigma_NAstd[136,day01]"                        
 [731] "r_record_id__sigma_NAstd[137,day01]"                        
 [732] "r_record_id__sigma_NAstd[138,day01]"                        
 [733] "r_record_id__sigma_NAstd[139,day01]"                        
 [734] "r_record_id__sigma_NAstd[140,day01]"                        
 [735] "r_record_id__sigma_NAstd[142,day01]"                        
 [736] "r_record_id__sigma_NAstd[143,day01]"                        
 [737] "r_record_id__sigma_NAstd[144,day01]"                        
 [738] "r_record_id__sigma_NAstd[145,day01]"                        
 [739] "r_record_id__sigma_NAstd[147,day01]"                        
 [740] "r_record_id__sigma_NAstd[148,day01]"                        
 [741] "r_record_id__sigma_NAstd[149,day01]"                        
 [742] "r_record_id__sigma_NAstd[150,day01]"                        
 [743] "r_record_id__sigma_NAstd[151,day01]"                        
 [744] "r_record_id__sigma_NAstd[152,day01]"                        
 [745] "r_record_id__sigma_NAstd[153,day01]"                        
 [746] "r_record_id__sigma_NAstd[154,day01]"                        
 [747] "r_record_id__sigma_NAstd[155,day01]"                        
 [748] "r_record_id__sigma_NAstd[157,day01]"                        
 [749] "r_record_id__sigma_NAstd[158,day01]"                        
 [750] "r_record_id__sigma_NAstd[160,day01]"                        
 [751] "r_record_id__sigma_NAstd[162,day01]"                        
 [752] "r_record_id__sigma_NAstd[163,day01]"                        
 [753] "r_record_id__sigma_NAstd[164,day01]"                        
 [754] "r_record_id__sigma_NAstd[165,day01]"                        
 [755] "r_record_id__sigma_NAstd[166,day01]"                        
 [756] "r_record_id__sigma_NAstd[167,day01]"                        
 [757] "r_record_id__sigma_NAstd[168,day01]"                        
 [758] "r_record_id__sigma_NAstd[169,day01]"                        
 [759] "r_record_id__sigma_NAstd[170,day01]"                        
 [760] "r_record_id__sigma_NAstd[171,day01]"                        
 [761] "r_record_id__sigma_NAstd[173,day01]"                        
 [762] "r_record_id__sigma_NAstd[174,day01]"                        
 [763] "r_record_id__sigma_NAstd[176,day01]"                        
 [764] "r_record_id__sigma_NAstd[177,day01]"                        
 [765] "r_record_id__sigma_NAstd[178,day01]"                        
 [766] "r_record_id__sigma_NAstd[181,day01]"                        
 [767] "r_record_id__sigma_NAstd[182,day01]"                        
 [768] "r_record_id__sigma_NAstd[183,day01]"                        
 [769] "r_record_id__sigma_NAstd[184,day01]"                        
 [770] "r_record_id__sigma_NAstd[185,day01]"                        
 [771] "r_record_id__sigma_NAstd[186,day01]"                        
 [772] "r_record_id__sigma_NAstd[188,day01]"                        
 [773] "r_record_id__sigma_NAstd[189,day01]"                        
 [774] "r_record_id__sigma_NAstd[190,day01]"                        
 [775] "r_record_id__sigma_NAstd[191,day01]"                        
 [776] "r_record_id__sigma_NAstd[194,day01]"                        
 [777] "r_record_id__sigma_NAstd[195,day01]"                        
 [778] "r_record_id__sigma_NAstd[196,day01]"                        
 [779] "r_record_id__sigma_NAstd[197,day01]"                        
 [780] "r_record_id__sigma_NAstd[198,day01]"                        
 [781] "r_record_id__sigma_NAstd[199,day01]"                        
 [782] "r_record_id__sigma_NAstd[201,day01]"                        
 [783] "r_record_id__sigma_NAstd[202,day01]"                        
 [784] "r_record_id__sigma_NAstd[203,day01]"                        
 [785] "r_record_id__sigma_NAstd[204,day01]"                        
 [786] "r_record_id__sigma_NAstd[205,day01]"                        
 [787] "r_record_id__sigma_NAstd[206,day01]"                        
 [788] "r_record_id__sigma_NAstd[207,day01]"                        
 [789] "r_record_id__sigma_NAstd[208,day01]"                        
 [790] "r_record_id__sigma_NAstd[209,day01]"                        
 [791] "r_record_id__sigma_NAstd[211,day01]"                        
 [792] "r_record_id__sigma_NAstd[212,day01]"                        
 [793] "r_record_id__sigma_NAstd[213,day01]"                        
 [794] "r_record_id__sigma_NAstd[214,day01]"                        
 [795] "r_record_id__sigma_NAstd[216,day01]"                        
 [796] "r_record_id__sigma_NAstd[217,day01]"                        
 [797] "r_record_id__sigma_NAstd[219,day01]"                        
 [798] "r_record_id__sigma_NAstd[220,day01]"                        
 [799] "r_record_id__sigma_NAstd[221,day01]"                        
 [800] "r_record_id__sigma_NAstd[222,day01]"                        
 [801] "r_record_id__sigma_NAstd[223,day01]"                        
 [802] "r_record_id__sigma_NAstd[224,day01]"                        
 [803] "r_record_id__sigma_NAstd[225,day01]"                        
 [804] "r_record_id__sigma_NAstd[226,day01]"                        
 [805] "r_record_id__sigma_NAstd[227,day01]"                        
 [806] "r_record_id__sigma_NAstd[228,day01]"                        
 [807] "r_record_id__sigma_NAstd[229,day01]"                        
 [808] "r_record_id__sigma_NAstd[230,day01]"                        
 [809] "r_record_id__sigma_NAstd[231,day01]"                        
 [810] "r_record_id__sigma_NAstd[232,day01]"                        
 [811] "r_record_id__sigma_NAstd[233,day01]"                        
 [812] "r_record_id__sigma_NAstd[234,day01]"                        
 [813] "r_record_id__sigma_NAstd[236,day01]"                        
 [814] "r_record_id__sigma_NAstd[237,day01]"                        
 [815] "r_record_id__sigma_NAstd[238,day01]"                        
 [816] "r_record_id__sigma_NAstd[239,day01]"                        
 [817] "r_record_id__PAstd[1,Intercept]"                            
 [818] "r_record_id__PAstd[2,Intercept]"                            
 [819] "r_record_id__PAstd[3,Intercept]"                            
 [820] "r_record_id__PAstd[4,Intercept]"                            
 [821] "r_record_id__PAstd[5,Intercept]"                            
 [822] "r_record_id__PAstd[6,Intercept]"                            
 [823] "r_record_id__PAstd[7,Intercept]"                            
 [824] "r_record_id__PAstd[8,Intercept]"                            
 [825] "r_record_id__PAstd[9,Intercept]"                            
 [826] "r_record_id__PAstd[10,Intercept]"                           
 [827] "r_record_id__PAstd[11,Intercept]"                           
 [828] "r_record_id__PAstd[12,Intercept]"                           
 [829] "r_record_id__PAstd[13,Intercept]"                           
 [830] "r_record_id__PAstd[14,Intercept]"                           
 [831] "r_record_id__PAstd[15,Intercept]"                           
 [832] "r_record_id__PAstd[16,Intercept]"                           
 [833] "r_record_id__PAstd[17,Intercept]"                           
 [834] "r_record_id__PAstd[20,Intercept]"                           
 [835] "r_record_id__PAstd[23,Intercept]"                           
 [836] "r_record_id__PAstd[24,Intercept]"                           
 [837] "r_record_id__PAstd[25,Intercept]"                           
 [838] "r_record_id__PAstd[26,Intercept]"                           
 [839] "r_record_id__PAstd[27,Intercept]"                           
 [840] "r_record_id__PAstd[28,Intercept]"                           
 [841] "r_record_id__PAstd[29,Intercept]"                           
 [842] "r_record_id__PAstd[30,Intercept]"                           
 [843] "r_record_id__PAstd[31,Intercept]"                           
 [844] "r_record_id__PAstd[32,Intercept]"                           
 [845] "r_record_id__PAstd[33,Intercept]"                           
 [846] "r_record_id__PAstd[34,Intercept]"                           
 [847] "r_record_id__PAstd[35,Intercept]"                           
 [848] "r_record_id__PAstd[36,Intercept]"                           
 [849] "r_record_id__PAstd[37,Intercept]"                           
 [850] "r_record_id__PAstd[38,Intercept]"                           
 [851] "r_record_id__PAstd[39,Intercept]"                           
 [852] "r_record_id__PAstd[40,Intercept]"                           
 [853] "r_record_id__PAstd[41,Intercept]"                           
 [854] "r_record_id__PAstd[42,Intercept]"                           
 [855] "r_record_id__PAstd[43,Intercept]"                           
 [856] "r_record_id__PAstd[44,Intercept]"                           
 [857] "r_record_id__PAstd[46,Intercept]"                           
 [858] "r_record_id__PAstd[47,Intercept]"                           
 [859] "r_record_id__PAstd[48,Intercept]"                           
 [860] "r_record_id__PAstd[49,Intercept]"                           
 [861] "r_record_id__PAstd[50,Intercept]"                           
 [862] "r_record_id__PAstd[51,Intercept]"                           
 [863] "r_record_id__PAstd[52,Intercept]"                           
 [864] "r_record_id__PAstd[53,Intercept]"                           
 [865] "r_record_id__PAstd[54,Intercept]"                           
 [866] "r_record_id__PAstd[55,Intercept]"                           
 [867] "r_record_id__PAstd[56,Intercept]"                           
 [868] "r_record_id__PAstd[58,Intercept]"                           
 [869] "r_record_id__PAstd[60,Intercept]"                           
 [870] "r_record_id__PAstd[64,Intercept]"                           
 [871] "r_record_id__PAstd[65,Intercept]"                           
 [872] "r_record_id__PAstd[67,Intercept]"                           
 [873] "r_record_id__PAstd[68,Intercept]"                           
 [874] "r_record_id__PAstd[69,Intercept]"                           
 [875] "r_record_id__PAstd[70,Intercept]"                           
 [876] "r_record_id__PAstd[72,Intercept]"                           
 [877] "r_record_id__PAstd[73,Intercept]"                           
 [878] "r_record_id__PAstd[75,Intercept]"                           
 [879] "r_record_id__PAstd[76,Intercept]"                           
 [880] "r_record_id__PAstd[80,Intercept]"                           
 [881] "r_record_id__PAstd[81,Intercept]"                           
 [882] "r_record_id__PAstd[82,Intercept]"                           
 [883] "r_record_id__PAstd[83,Intercept]"                           
 [884] "r_record_id__PAstd[85,Intercept]"                           
 [885] "r_record_id__PAstd[86,Intercept]"                           
 [886] "r_record_id__PAstd[88,Intercept]"                           
 [887] "r_record_id__PAstd[91,Intercept]"                           
 [888] "r_record_id__PAstd[92,Intercept]"                           
 [889] "r_record_id__PAstd[94,Intercept]"                           
 [890] "r_record_id__PAstd[95,Intercept]"                           
 [891] "r_record_id__PAstd[96,Intercept]"                           
 [892] "r_record_id__PAstd[97,Intercept]"                           
 [893] "r_record_id__PAstd[98,Intercept]"                           
 [894] "r_record_id__PAstd[99,Intercept]"                           
 [895] "r_record_id__PAstd[100,Intercept]"                          
 [896] "r_record_id__PAstd[101,Intercept]"                          
 [897] "r_record_id__PAstd[102,Intercept]"                          
 [898] "r_record_id__PAstd[104,Intercept]"                          
 [899] "r_record_id__PAstd[105,Intercept]"                          
 [900] "r_record_id__PAstd[106,Intercept]"                          
 [901] "r_record_id__PAstd[107,Intercept]"                          
 [902] "r_record_id__PAstd[109,Intercept]"                          
 [903] "r_record_id__PAstd[110,Intercept]"                          
 [904] "r_record_id__PAstd[111,Intercept]"                          
 [905] "r_record_id__PAstd[112,Intercept]"                          
 [906] "r_record_id__PAstd[113,Intercept]"                          
 [907] "r_record_id__PAstd[114,Intercept]"                          
 [908] "r_record_id__PAstd[115,Intercept]"                          
 [909] "r_record_id__PAstd[116,Intercept]"                          
 [910] "r_record_id__PAstd[117,Intercept]"                          
 [911] "r_record_id__PAstd[119,Intercept]"                          
 [912] "r_record_id__PAstd[120,Intercept]"                          
 [913] "r_record_id__PAstd[121,Intercept]"                          
 [914] "r_record_id__PAstd[123,Intercept]"                          
 [915] "r_record_id__PAstd[125,Intercept]"                          
 [916] "r_record_id__PAstd[127,Intercept]"                          
 [917] "r_record_id__PAstd[128,Intercept]"                          
 [918] "r_record_id__PAstd[129,Intercept]"                          
 [919] "r_record_id__PAstd[132,Intercept]"                          
 [920] "r_record_id__PAstd[133,Intercept]"                          
 [921] "r_record_id__PAstd[134,Intercept]"                          
 [922] "r_record_id__PAstd[135,Intercept]"                          
 [923] "r_record_id__PAstd[136,Intercept]"                          
 [924] "r_record_id__PAstd[137,Intercept]"                          
 [925] "r_record_id__PAstd[138,Intercept]"                          
 [926] "r_record_id__PAstd[139,Intercept]"                          
 [927] "r_record_id__PAstd[140,Intercept]"                          
 [928] "r_record_id__PAstd[142,Intercept]"                          
 [929] "r_record_id__PAstd[143,Intercept]"                          
 [930] "r_record_id__PAstd[144,Intercept]"                          
 [931] "r_record_id__PAstd[145,Intercept]"                          
 [932] "r_record_id__PAstd[147,Intercept]"                          
 [933] "r_record_id__PAstd[148,Intercept]"                          
 [934] "r_record_id__PAstd[149,Intercept]"                          
 [935] "r_record_id__PAstd[150,Intercept]"                          
 [936] "r_record_id__PAstd[151,Intercept]"                          
 [937] "r_record_id__PAstd[152,Intercept]"                          
 [938] "r_record_id__PAstd[153,Intercept]"                          
 [939] "r_record_id__PAstd[154,Intercept]"                          
 [940] "r_record_id__PAstd[155,Intercept]"                          
 [941] "r_record_id__PAstd[157,Intercept]"                          
 [942] "r_record_id__PAstd[158,Intercept]"                          
 [943] "r_record_id__PAstd[160,Intercept]"                          
 [944] "r_record_id__PAstd[162,Intercept]"                          
 [945] "r_record_id__PAstd[163,Intercept]"                          
 [946] "r_record_id__PAstd[164,Intercept]"                          
 [947] "r_record_id__PAstd[165,Intercept]"                          
 [948] "r_record_id__PAstd[166,Intercept]"                          
 [949] "r_record_id__PAstd[167,Intercept]"                          
 [950] "r_record_id__PAstd[168,Intercept]"                          
 [951] "r_record_id__PAstd[169,Intercept]"                          
 [952] "r_record_id__PAstd[170,Intercept]"                          
 [953] "r_record_id__PAstd[171,Intercept]"                          
 [954] "r_record_id__PAstd[173,Intercept]"                          
 [955] "r_record_id__PAstd[174,Intercept]"                          
 [956] "r_record_id__PAstd[176,Intercept]"                          
 [957] "r_record_id__PAstd[177,Intercept]"                          
 [958] "r_record_id__PAstd[178,Intercept]"                          
 [959] "r_record_id__PAstd[181,Intercept]"                          
 [960] "r_record_id__PAstd[182,Intercept]"                          
 [961] "r_record_id__PAstd[183,Intercept]"                          
 [962] "r_record_id__PAstd[184,Intercept]"                          
 [963] "r_record_id__PAstd[185,Intercept]"                          
 [964] "r_record_id__PAstd[186,Intercept]"                          
 [965] "r_record_id__PAstd[188,Intercept]"                          
 [966] "r_record_id__PAstd[189,Intercept]"                          
 [967] "r_record_id__PAstd[190,Intercept]"                          
 [968] "r_record_id__PAstd[191,Intercept]"                          
 [969] "r_record_id__PAstd[194,Intercept]"                          
 [970] "r_record_id__PAstd[195,Intercept]"                          
 [971] "r_record_id__PAstd[196,Intercept]"                          
 [972] "r_record_id__PAstd[197,Intercept]"                          
 [973] "r_record_id__PAstd[198,Intercept]"                          
 [974] "r_record_id__PAstd[199,Intercept]"                          
 [975] "r_record_id__PAstd[201,Intercept]"                          
 [976] "r_record_id__PAstd[202,Intercept]"                          
 [977] "r_record_id__PAstd[203,Intercept]"                          
 [978] "r_record_id__PAstd[204,Intercept]"                          
 [979] "r_record_id__PAstd[205,Intercept]"                          
 [980] "r_record_id__PAstd[206,Intercept]"                          
 [981] "r_record_id__PAstd[207,Intercept]"                          
 [982] "r_record_id__PAstd[208,Intercept]"                          
 [983] "r_record_id__PAstd[209,Intercept]"                          
 [984] "r_record_id__PAstd[211,Intercept]"                          
 [985] "r_record_id__PAstd[212,Intercept]"                          
 [986] "r_record_id__PAstd[213,Intercept]"                          
 [987] "r_record_id__PAstd[214,Intercept]"                          
 [988] "r_record_id__PAstd[216,Intercept]"                          
 [989] "r_record_id__PAstd[217,Intercept]"                          
 [990] "r_record_id__PAstd[219,Intercept]"                          
 [991] "r_record_id__PAstd[220,Intercept]"                          
 [992] "r_record_id__PAstd[221,Intercept]"                          
 [993] "r_record_id__PAstd[222,Intercept]"                          
 [994] "r_record_id__PAstd[223,Intercept]"                          
 [995] "r_record_id__PAstd[224,Intercept]"                          
 [996] "r_record_id__PAstd[225,Intercept]"                          
 [997] "r_record_id__PAstd[226,Intercept]"                          
 [998] "r_record_id__PAstd[227,Intercept]"                          
 [999] "r_record_id__PAstd[228,Intercept]"                          
[1000] "r_record_id__PAstd[229,Intercept]"                          
[1001] "r_record_id__PAstd[230,Intercept]"                          
[1002] "r_record_id__PAstd[231,Intercept]"                          
[1003] "r_record_id__PAstd[232,Intercept]"                          
[1004] "r_record_id__PAstd[233,Intercept]"                          
[1005] "r_record_id__PAstd[234,Intercept]"                          
[1006] "r_record_id__PAstd[236,Intercept]"                          
[1007] "r_record_id__PAstd[237,Intercept]"                          
[1008] "r_record_id__PAstd[238,Intercept]"                          
[1009] "r_record_id__PAstd[239,Intercept]"                          
[1010] "r_record_id__PAstd[1,day01]"                                
[1011] "r_record_id__PAstd[2,day01]"                                
[1012] "r_record_id__PAstd[3,day01]"                                
[1013] "r_record_id__PAstd[4,day01]"                                
[1014] "r_record_id__PAstd[5,day01]"                                
[1015] "r_record_id__PAstd[6,day01]"                                
[1016] "r_record_id__PAstd[7,day01]"                                
[1017] "r_record_id__PAstd[8,day01]"                                
[1018] "r_record_id__PAstd[9,day01]"                                
[1019] "r_record_id__PAstd[10,day01]"                               
[1020] "r_record_id__PAstd[11,day01]"                               
[1021] "r_record_id__PAstd[12,day01]"                               
[1022] "r_record_id__PAstd[13,day01]"                               
[1023] "r_record_id__PAstd[14,day01]"                               
[1024] "r_record_id__PAstd[15,day01]"                               
[1025] "r_record_id__PAstd[16,day01]"                               
[1026] "r_record_id__PAstd[17,day01]"                               
[1027] "r_record_id__PAstd[20,day01]"                               
[1028] "r_record_id__PAstd[23,day01]"                               
[1029] "r_record_id__PAstd[24,day01]"                               
[1030] "r_record_id__PAstd[25,day01]"                               
[1031] "r_record_id__PAstd[26,day01]"                               
[1032] "r_record_id__PAstd[27,day01]"                               
[1033] "r_record_id__PAstd[28,day01]"                               
[1034] "r_record_id__PAstd[29,day01]"                               
[1035] "r_record_id__PAstd[30,day01]"                               
[1036] "r_record_id__PAstd[31,day01]"                               
[1037] "r_record_id__PAstd[32,day01]"                               
[1038] "r_record_id__PAstd[33,day01]"                               
[1039] "r_record_id__PAstd[34,day01]"                               
[1040] "r_record_id__PAstd[35,day01]"                               
[1041] "r_record_id__PAstd[36,day01]"                               
[1042] "r_record_id__PAstd[37,day01]"                               
[1043] "r_record_id__PAstd[38,day01]"                               
[1044] "r_record_id__PAstd[39,day01]"                               
[1045] "r_record_id__PAstd[40,day01]"                               
[1046] "r_record_id__PAstd[41,day01]"                               
[1047] "r_record_id__PAstd[42,day01]"                               
[1048] "r_record_id__PAstd[43,day01]"                               
[1049] "r_record_id__PAstd[44,day01]"                               
[1050] "r_record_id__PAstd[46,day01]"                               
[1051] "r_record_id__PAstd[47,day01]"                               
[1052] "r_record_id__PAstd[48,day01]"                               
[1053] "r_record_id__PAstd[49,day01]"                               
[1054] "r_record_id__PAstd[50,day01]"                               
[1055] "r_record_id__PAstd[51,day01]"                               
[1056] "r_record_id__PAstd[52,day01]"                               
[1057] "r_record_id__PAstd[53,day01]"                               
[1058] "r_record_id__PAstd[54,day01]"                               
[1059] "r_record_id__PAstd[55,day01]"                               
[1060] "r_record_id__PAstd[56,day01]"                               
[1061] "r_record_id__PAstd[58,day01]"                               
[1062] "r_record_id__PAstd[60,day01]"                               
[1063] "r_record_id__PAstd[64,day01]"                               
[1064] "r_record_id__PAstd[65,day01]"                               
[1065] "r_record_id__PAstd[67,day01]"                               
[1066] "r_record_id__PAstd[68,day01]"                               
[1067] "r_record_id__PAstd[69,day01]"                               
[1068] "r_record_id__PAstd[70,day01]"                               
[1069] "r_record_id__PAstd[72,day01]"                               
[1070] "r_record_id__PAstd[73,day01]"                               
[1071] "r_record_id__PAstd[75,day01]"                               
[1072] "r_record_id__PAstd[76,day01]"                               
[1073] "r_record_id__PAstd[80,day01]"                               
[1074] "r_record_id__PAstd[81,day01]"                               
[1075] "r_record_id__PAstd[82,day01]"                               
[1076] "r_record_id__PAstd[83,day01]"                               
[1077] "r_record_id__PAstd[85,day01]"                               
[1078] "r_record_id__PAstd[86,day01]"                               
[1079] "r_record_id__PAstd[88,day01]"                               
[1080] "r_record_id__PAstd[91,day01]"                               
[1081] "r_record_id__PAstd[92,day01]"                               
[1082] "r_record_id__PAstd[94,day01]"                               
[1083] "r_record_id__PAstd[95,day01]"                               
[1084] "r_record_id__PAstd[96,day01]"                               
[1085] "r_record_id__PAstd[97,day01]"                               
[1086] "r_record_id__PAstd[98,day01]"                               
[1087] "r_record_id__PAstd[99,day01]"                               
[1088] "r_record_id__PAstd[100,day01]"                              
[1089] "r_record_id__PAstd[101,day01]"                              
[1090] "r_record_id__PAstd[102,day01]"                              
[1091] "r_record_id__PAstd[104,day01]"                              
[1092] "r_record_id__PAstd[105,day01]"                              
[1093] "r_record_id__PAstd[106,day01]"                              
[1094] "r_record_id__PAstd[107,day01]"                              
[1095] "r_record_id__PAstd[109,day01]"                              
[1096] "r_record_id__PAstd[110,day01]"                              
[1097] "r_record_id__PAstd[111,day01]"                              
[1098] "r_record_id__PAstd[112,day01]"                              
[1099] "r_record_id__PAstd[113,day01]"                              
[1100] "r_record_id__PAstd[114,day01]"                              
[1101] "r_record_id__PAstd[115,day01]"                              
[1102] "r_record_id__PAstd[116,day01]"                              
[1103] "r_record_id__PAstd[117,day01]"                              
[1104] "r_record_id__PAstd[119,day01]"                              
[1105] "r_record_id__PAstd[120,day01]"                              
[1106] "r_record_id__PAstd[121,day01]"                              
[1107] "r_record_id__PAstd[123,day01]"                              
[1108] "r_record_id__PAstd[125,day01]"                              
[1109] "r_record_id__PAstd[127,day01]"                              
[1110] "r_record_id__PAstd[128,day01]"                              
[1111] "r_record_id__PAstd[129,day01]"                              
[1112] "r_record_id__PAstd[132,day01]"                              
[1113] "r_record_id__PAstd[133,day01]"                              
[1114] "r_record_id__PAstd[134,day01]"                              
[1115] "r_record_id__PAstd[135,day01]"                              
[1116] "r_record_id__PAstd[136,day01]"                              
[1117] "r_record_id__PAstd[137,day01]"                              
[1118] "r_record_id__PAstd[138,day01]"                              
[1119] "r_record_id__PAstd[139,day01]"                              
[1120] "r_record_id__PAstd[140,day01]"                              
[1121] "r_record_id__PAstd[142,day01]"                              
[1122] "r_record_id__PAstd[143,day01]"                              
[1123] "r_record_id__PAstd[144,day01]"                              
[1124] "r_record_id__PAstd[145,day01]"                              
[1125] "r_record_id__PAstd[147,day01]"                              
[1126] "r_record_id__PAstd[148,day01]"                              
[1127] "r_record_id__PAstd[149,day01]"                              
[1128] "r_record_id__PAstd[150,day01]"                              
[1129] "r_record_id__PAstd[151,day01]"                              
[1130] "r_record_id__PAstd[152,day01]"                              
[1131] "r_record_id__PAstd[153,day01]"                              
[1132] "r_record_id__PAstd[154,day01]"                              
[1133] "r_record_id__PAstd[155,day01]"                              
[1134] "r_record_id__PAstd[157,day01]"                              
[1135] "r_record_id__PAstd[158,day01]"                              
[1136] "r_record_id__PAstd[160,day01]"                              
[1137] "r_record_id__PAstd[162,day01]"                              
[1138] "r_record_id__PAstd[163,day01]"                              
[1139] "r_record_id__PAstd[164,day01]"                              
[1140] "r_record_id__PAstd[165,day01]"                              
[1141] "r_record_id__PAstd[166,day01]"                              
[1142] "r_record_id__PAstd[167,day01]"                              
[1143] "r_record_id__PAstd[168,day01]"                              
[1144] "r_record_id__PAstd[169,day01]"                              
[1145] "r_record_id__PAstd[170,day01]"                              
[1146] "r_record_id__PAstd[171,day01]"                              
[1147] "r_record_id__PAstd[173,day01]"                              
[1148] "r_record_id__PAstd[174,day01]"                              
[1149] "r_record_id__PAstd[176,day01]"                              
[1150] "r_record_id__PAstd[177,day01]"                              
[1151] "r_record_id__PAstd[178,day01]"                              
[1152] "r_record_id__PAstd[181,day01]"                              
[1153] "r_record_id__PAstd[182,day01]"                              
[1154] "r_record_id__PAstd[183,day01]"                              
[1155] "r_record_id__PAstd[184,day01]"                              
[1156] "r_record_id__PAstd[185,day01]"                              
[1157] "r_record_id__PAstd[186,day01]"                              
[1158] "r_record_id__PAstd[188,day01]"                              
[1159] "r_record_id__PAstd[189,day01]"                              
[1160] "r_record_id__PAstd[190,day01]"                              
[1161] "r_record_id__PAstd[191,day01]"                              
[1162] "r_record_id__PAstd[194,day01]"                              
[1163] "r_record_id__PAstd[195,day01]"                              
[1164] "r_record_id__PAstd[196,day01]"                              
[1165] "r_record_id__PAstd[197,day01]"                              
[1166] "r_record_id__PAstd[198,day01]"                              
[1167] "r_record_id__PAstd[199,day01]"                              
[1168] "r_record_id__PAstd[201,day01]"                              
[1169] "r_record_id__PAstd[202,day01]"                              
[1170] "r_record_id__PAstd[203,day01]"                              
[1171] "r_record_id__PAstd[204,day01]"                              
[1172] "r_record_id__PAstd[205,day01]"                              
[1173] "r_record_id__PAstd[206,day01]"                              
[1174] "r_record_id__PAstd[207,day01]"                              
[1175] "r_record_id__PAstd[208,day01]"                              
[1176] "r_record_id__PAstd[209,day01]"                              
[1177] "r_record_id__PAstd[211,day01]"                              
[1178] "r_record_id__PAstd[212,day01]"                              
[1179] "r_record_id__PAstd[213,day01]"                              
[1180] "r_record_id__PAstd[214,day01]"                              
[1181] "r_record_id__PAstd[216,day01]"                              
[1182] "r_record_id__PAstd[217,day01]"                              
[1183] "r_record_id__PAstd[219,day01]"                              
[1184] "r_record_id__PAstd[220,day01]"                              
[1185] "r_record_id__PAstd[221,day01]"                              
[1186] "r_record_id__PAstd[222,day01]"                              
[1187] "r_record_id__PAstd[223,day01]"                              
[1188] "r_record_id__PAstd[224,day01]"                              
[1189] "r_record_id__PAstd[225,day01]"                              
[1190] "r_record_id__PAstd[226,day01]"                              
[1191] "r_record_id__PAstd[227,day01]"                              
[1192] "r_record_id__PAstd[228,day01]"                              
[1193] "r_record_id__PAstd[229,day01]"                              
[1194] "r_record_id__PAstd[230,day01]"                              
[1195] "r_record_id__PAstd[231,day01]"                              
[1196] "r_record_id__PAstd[232,day01]"                              
[1197] "r_record_id__PAstd[233,day01]"                              
[1198] "r_record_id__PAstd[234,day01]"                              
[1199] "r_record_id__PAstd[236,day01]"                              
[1200] "r_record_id__PAstd[237,day01]"                              
[1201] "r_record_id__PAstd[238,day01]"                              
[1202] "r_record_id__PAstd[239,day01]"                              
[1203] "r_record_id__sigma_PAstd[1,Intercept]"                      
[1204] "r_record_id__sigma_PAstd[2,Intercept]"                      
[1205] "r_record_id__sigma_PAstd[3,Intercept]"                      
[1206] "r_record_id__sigma_PAstd[4,Intercept]"                      
[1207] "r_record_id__sigma_PAstd[5,Intercept]"                      
[1208] "r_record_id__sigma_PAstd[6,Intercept]"                      
[1209] "r_record_id__sigma_PAstd[7,Intercept]"                      
[1210] "r_record_id__sigma_PAstd[8,Intercept]"                      
[1211] "r_record_id__sigma_PAstd[9,Intercept]"                      
[1212] "r_record_id__sigma_PAstd[10,Intercept]"                     
[1213] "r_record_id__sigma_PAstd[11,Intercept]"                     
[1214] "r_record_id__sigma_PAstd[12,Intercept]"                     
[1215] "r_record_id__sigma_PAstd[13,Intercept]"                     
[1216] "r_record_id__sigma_PAstd[14,Intercept]"                     
[1217] "r_record_id__sigma_PAstd[15,Intercept]"                     
[1218] "r_record_id__sigma_PAstd[16,Intercept]"                     
[1219] "r_record_id__sigma_PAstd[17,Intercept]"                     
[1220] "r_record_id__sigma_PAstd[20,Intercept]"                     
[1221] "r_record_id__sigma_PAstd[23,Intercept]"                     
[1222] "r_record_id__sigma_PAstd[24,Intercept]"                     
[1223] "r_record_id__sigma_PAstd[25,Intercept]"                     
[1224] "r_record_id__sigma_PAstd[26,Intercept]"                     
[1225] "r_record_id__sigma_PAstd[27,Intercept]"                     
[1226] "r_record_id__sigma_PAstd[28,Intercept]"                     
[1227] "r_record_id__sigma_PAstd[29,Intercept]"                     
[1228] "r_record_id__sigma_PAstd[30,Intercept]"                     
[1229] "r_record_id__sigma_PAstd[31,Intercept]"                     
[1230] "r_record_id__sigma_PAstd[32,Intercept]"                     
[1231] "r_record_id__sigma_PAstd[33,Intercept]"                     
[1232] "r_record_id__sigma_PAstd[34,Intercept]"                     
[1233] "r_record_id__sigma_PAstd[35,Intercept]"                     
[1234] "r_record_id__sigma_PAstd[36,Intercept]"                     
[1235] "r_record_id__sigma_PAstd[37,Intercept]"                     
[1236] "r_record_id__sigma_PAstd[38,Intercept]"                     
[1237] "r_record_id__sigma_PAstd[39,Intercept]"                     
[1238] "r_record_id__sigma_PAstd[40,Intercept]"                     
[1239] "r_record_id__sigma_PAstd[41,Intercept]"                     
[1240] "r_record_id__sigma_PAstd[42,Intercept]"                     
[1241] "r_record_id__sigma_PAstd[43,Intercept]"                     
[1242] "r_record_id__sigma_PAstd[44,Intercept]"                     
[1243] "r_record_id__sigma_PAstd[46,Intercept]"                     
[1244] "r_record_id__sigma_PAstd[47,Intercept]"                     
[1245] "r_record_id__sigma_PAstd[48,Intercept]"                     
[1246] "r_record_id__sigma_PAstd[49,Intercept]"                     
[1247] "r_record_id__sigma_PAstd[50,Intercept]"                     
[1248] "r_record_id__sigma_PAstd[51,Intercept]"                     
[1249] "r_record_id__sigma_PAstd[52,Intercept]"                     
[1250] "r_record_id__sigma_PAstd[53,Intercept]"                     
[1251] "r_record_id__sigma_PAstd[54,Intercept]"                     
[1252] "r_record_id__sigma_PAstd[55,Intercept]"                     
[1253] "r_record_id__sigma_PAstd[56,Intercept]"                     
[1254] "r_record_id__sigma_PAstd[58,Intercept]"                     
[1255] "r_record_id__sigma_PAstd[60,Intercept]"                     
[1256] "r_record_id__sigma_PAstd[64,Intercept]"                     
[1257] "r_record_id__sigma_PAstd[65,Intercept]"                     
[1258] "r_record_id__sigma_PAstd[67,Intercept]"                     
[1259] "r_record_id__sigma_PAstd[68,Intercept]"                     
[1260] "r_record_id__sigma_PAstd[69,Intercept]"                     
[1261] "r_record_id__sigma_PAstd[70,Intercept]"                     
[1262] "r_record_id__sigma_PAstd[72,Intercept]"                     
[1263] "r_record_id__sigma_PAstd[73,Intercept]"                     
[1264] "r_record_id__sigma_PAstd[75,Intercept]"                     
[1265] "r_record_id__sigma_PAstd[76,Intercept]"                     
[1266] "r_record_id__sigma_PAstd[80,Intercept]"                     
[1267] "r_record_id__sigma_PAstd[81,Intercept]"                     
[1268] "r_record_id__sigma_PAstd[82,Intercept]"                     
[1269] "r_record_id__sigma_PAstd[83,Intercept]"                     
[1270] "r_record_id__sigma_PAstd[85,Intercept]"                     
[1271] "r_record_id__sigma_PAstd[86,Intercept]"                     
[1272] "r_record_id__sigma_PAstd[88,Intercept]"                     
[1273] "r_record_id__sigma_PAstd[91,Intercept]"                     
[1274] "r_record_id__sigma_PAstd[92,Intercept]"                     
[1275] "r_record_id__sigma_PAstd[94,Intercept]"                     
[1276] "r_record_id__sigma_PAstd[95,Intercept]"                     
[1277] "r_record_id__sigma_PAstd[96,Intercept]"                     
[1278] "r_record_id__sigma_PAstd[97,Intercept]"                     
[1279] "r_record_id__sigma_PAstd[98,Intercept]"                     
[1280] "r_record_id__sigma_PAstd[99,Intercept]"                     
[1281] "r_record_id__sigma_PAstd[100,Intercept]"                    
[1282] "r_record_id__sigma_PAstd[101,Intercept]"                    
[1283] "r_record_id__sigma_PAstd[102,Intercept]"                    
[1284] "r_record_id__sigma_PAstd[104,Intercept]"                    
[1285] "r_record_id__sigma_PAstd[105,Intercept]"                    
[1286] "r_record_id__sigma_PAstd[106,Intercept]"                    
[1287] "r_record_id__sigma_PAstd[107,Intercept]"                    
[1288] "r_record_id__sigma_PAstd[109,Intercept]"                    
[1289] "r_record_id__sigma_PAstd[110,Intercept]"                    
[1290] "r_record_id__sigma_PAstd[111,Intercept]"                    
[1291] "r_record_id__sigma_PAstd[112,Intercept]"                    
[1292] "r_record_id__sigma_PAstd[113,Intercept]"                    
[1293] "r_record_id__sigma_PAstd[114,Intercept]"                    
[1294] "r_record_id__sigma_PAstd[115,Intercept]"                    
[1295] "r_record_id__sigma_PAstd[116,Intercept]"                    
[1296] "r_record_id__sigma_PAstd[117,Intercept]"                    
[1297] "r_record_id__sigma_PAstd[119,Intercept]"                    
[1298] "r_record_id__sigma_PAstd[120,Intercept]"                    
[1299] "r_record_id__sigma_PAstd[121,Intercept]"                    
[1300] "r_record_id__sigma_PAstd[123,Intercept]"                    
[1301] "r_record_id__sigma_PAstd[125,Intercept]"                    
[1302] "r_record_id__sigma_PAstd[127,Intercept]"                    
[1303] "r_record_id__sigma_PAstd[128,Intercept]"                    
[1304] "r_record_id__sigma_PAstd[129,Intercept]"                    
[1305] "r_record_id__sigma_PAstd[132,Intercept]"                    
[1306] "r_record_id__sigma_PAstd[133,Intercept]"                    
[1307] "r_record_id__sigma_PAstd[134,Intercept]"                    
[1308] "r_record_id__sigma_PAstd[135,Intercept]"                    
[1309] "r_record_id__sigma_PAstd[136,Intercept]"                    
[1310] "r_record_id__sigma_PAstd[137,Intercept]"                    
[1311] "r_record_id__sigma_PAstd[138,Intercept]"                    
[1312] "r_record_id__sigma_PAstd[139,Intercept]"                    
[1313] "r_record_id__sigma_PAstd[140,Intercept]"                    
[1314] "r_record_id__sigma_PAstd[142,Intercept]"                    
[1315] "r_record_id__sigma_PAstd[143,Intercept]"                    
[1316] "r_record_id__sigma_PAstd[144,Intercept]"                    
[1317] "r_record_id__sigma_PAstd[145,Intercept]"                    
[1318] "r_record_id__sigma_PAstd[147,Intercept]"                    
[1319] "r_record_id__sigma_PAstd[148,Intercept]"                    
[1320] "r_record_id__sigma_PAstd[149,Intercept]"                    
[1321] "r_record_id__sigma_PAstd[150,Intercept]"                    
[1322] "r_record_id__sigma_PAstd[151,Intercept]"                    
[1323] "r_record_id__sigma_PAstd[152,Intercept]"                    
[1324] "r_record_id__sigma_PAstd[153,Intercept]"                    
[1325] "r_record_id__sigma_PAstd[154,Intercept]"                    
[1326] "r_record_id__sigma_PAstd[155,Intercept]"                    
[1327] "r_record_id__sigma_PAstd[157,Intercept]"                    
[1328] "r_record_id__sigma_PAstd[158,Intercept]"                    
[1329] "r_record_id__sigma_PAstd[160,Intercept]"                    
[1330] "r_record_id__sigma_PAstd[162,Intercept]"                    
[1331] "r_record_id__sigma_PAstd[163,Intercept]"                    
[1332] "r_record_id__sigma_PAstd[164,Intercept]"                    
[1333] "r_record_id__sigma_PAstd[165,Intercept]"                    
[1334] "r_record_id__sigma_PAstd[166,Intercept]"                    
[1335] "r_record_id__sigma_PAstd[167,Intercept]"                    
[1336] "r_record_id__sigma_PAstd[168,Intercept]"                    
[1337] "r_record_id__sigma_PAstd[169,Intercept]"                    
[1338] "r_record_id__sigma_PAstd[170,Intercept]"                    
[1339] "r_record_id__sigma_PAstd[171,Intercept]"                    
[1340] "r_record_id__sigma_PAstd[173,Intercept]"                    
[1341] "r_record_id__sigma_PAstd[174,Intercept]"                    
[1342] "r_record_id__sigma_PAstd[176,Intercept]"                    
[1343] "r_record_id__sigma_PAstd[177,Intercept]"                    
[1344] "r_record_id__sigma_PAstd[178,Intercept]"                    
[1345] "r_record_id__sigma_PAstd[181,Intercept]"                    
[1346] "r_record_id__sigma_PAstd[182,Intercept]"                    
[1347] "r_record_id__sigma_PAstd[183,Intercept]"                    
[1348] "r_record_id__sigma_PAstd[184,Intercept]"                    
[1349] "r_record_id__sigma_PAstd[185,Intercept]"                    
[1350] "r_record_id__sigma_PAstd[186,Intercept]"                    
[1351] "r_record_id__sigma_PAstd[188,Intercept]"                    
[1352] "r_record_id__sigma_PAstd[189,Intercept]"                    
[1353] "r_record_id__sigma_PAstd[190,Intercept]"                    
[1354] "r_record_id__sigma_PAstd[191,Intercept]"                    
[1355] "r_record_id__sigma_PAstd[194,Intercept]"                    
[1356] "r_record_id__sigma_PAstd[195,Intercept]"                    
[1357] "r_record_id__sigma_PAstd[196,Intercept]"                    
[1358] "r_record_id__sigma_PAstd[197,Intercept]"                    
[1359] "r_record_id__sigma_PAstd[198,Intercept]"                    
[1360] "r_record_id__sigma_PAstd[199,Intercept]"                    
[1361] "r_record_id__sigma_PAstd[201,Intercept]"                    
[1362] "r_record_id__sigma_PAstd[202,Intercept]"                    
[1363] "r_record_id__sigma_PAstd[203,Intercept]"                    
[1364] "r_record_id__sigma_PAstd[204,Intercept]"                    
[1365] "r_record_id__sigma_PAstd[205,Intercept]"                    
[1366] "r_record_id__sigma_PAstd[206,Intercept]"                    
[1367] "r_record_id__sigma_PAstd[207,Intercept]"                    
[1368] "r_record_id__sigma_PAstd[208,Intercept]"                    
[1369] "r_record_id__sigma_PAstd[209,Intercept]"                    
[1370] "r_record_id__sigma_PAstd[211,Intercept]"                    
[1371] "r_record_id__sigma_PAstd[212,Intercept]"                    
[1372] "r_record_id__sigma_PAstd[213,Intercept]"                    
[1373] "r_record_id__sigma_PAstd[214,Intercept]"                    
[1374] "r_record_id__sigma_PAstd[216,Intercept]"                    
[1375] "r_record_id__sigma_PAstd[217,Intercept]"                    
[1376] "r_record_id__sigma_PAstd[219,Intercept]"                    
[1377] "r_record_id__sigma_PAstd[220,Intercept]"                    
[1378] "r_record_id__sigma_PAstd[221,Intercept]"                    
[1379] "r_record_id__sigma_PAstd[222,Intercept]"                    
[1380] "r_record_id__sigma_PAstd[223,Intercept]"                    
[1381] "r_record_id__sigma_PAstd[224,Intercept]"                    
[1382] "r_record_id__sigma_PAstd[225,Intercept]"                    
[1383] "r_record_id__sigma_PAstd[226,Intercept]"                    
[1384] "r_record_id__sigma_PAstd[227,Intercept]"                    
[1385] "r_record_id__sigma_PAstd[228,Intercept]"                    
[1386] "r_record_id__sigma_PAstd[229,Intercept]"                    
[1387] "r_record_id__sigma_PAstd[230,Intercept]"                    
[1388] "r_record_id__sigma_PAstd[231,Intercept]"                    
[1389] "r_record_id__sigma_PAstd[232,Intercept]"                    
[1390] "r_record_id__sigma_PAstd[233,Intercept]"                    
[1391] "r_record_id__sigma_PAstd[234,Intercept]"                    
[1392] "r_record_id__sigma_PAstd[236,Intercept]"                    
[1393] "r_record_id__sigma_PAstd[237,Intercept]"                    
[1394] "r_record_id__sigma_PAstd[238,Intercept]"                    
[1395] "r_record_id__sigma_PAstd[239,Intercept]"                    
[1396] "r_record_id__sigma_PAstd[1,day01]"                          
[1397] "r_record_id__sigma_PAstd[2,day01]"                          
[1398] "r_record_id__sigma_PAstd[3,day01]"                          
[1399] "r_record_id__sigma_PAstd[4,day01]"                          
[1400] "r_record_id__sigma_PAstd[5,day01]"                          
[1401] "r_record_id__sigma_PAstd[6,day01]"                          
[1402] "r_record_id__sigma_PAstd[7,day01]"                          
[1403] "r_record_id__sigma_PAstd[8,day01]"                          
[1404] "r_record_id__sigma_PAstd[9,day01]"                          
[1405] "r_record_id__sigma_PAstd[10,day01]"                         
[1406] "r_record_id__sigma_PAstd[11,day01]"                         
[1407] "r_record_id__sigma_PAstd[12,day01]"                         
[1408] "r_record_id__sigma_PAstd[13,day01]"                         
[1409] "r_record_id__sigma_PAstd[14,day01]"                         
[1410] "r_record_id__sigma_PAstd[15,day01]"                         
[1411] "r_record_id__sigma_PAstd[16,day01]"                         
[1412] "r_record_id__sigma_PAstd[17,day01]"                         
[1413] "r_record_id__sigma_PAstd[20,day01]"                         
[1414] "r_record_id__sigma_PAstd[23,day01]"                         
[1415] "r_record_id__sigma_PAstd[24,day01]"                         
[1416] "r_record_id__sigma_PAstd[25,day01]"                         
[1417] "r_record_id__sigma_PAstd[26,day01]"                         
[1418] "r_record_id__sigma_PAstd[27,day01]"                         
[1419] "r_record_id__sigma_PAstd[28,day01]"                         
[1420] "r_record_id__sigma_PAstd[29,day01]"                         
[1421] "r_record_id__sigma_PAstd[30,day01]"                         
[1422] "r_record_id__sigma_PAstd[31,day01]"                         
[1423] "r_record_id__sigma_PAstd[32,day01]"                         
[1424] "r_record_id__sigma_PAstd[33,day01]"                         
[1425] "r_record_id__sigma_PAstd[34,day01]"                         
[1426] "r_record_id__sigma_PAstd[35,day01]"                         
[1427] "r_record_id__sigma_PAstd[36,day01]"                         
[1428] "r_record_id__sigma_PAstd[37,day01]"                         
[1429] "r_record_id__sigma_PAstd[38,day01]"                         
[1430] "r_record_id__sigma_PAstd[39,day01]"                         
[1431] "r_record_id__sigma_PAstd[40,day01]"                         
[1432] "r_record_id__sigma_PAstd[41,day01]"                         
[1433] "r_record_id__sigma_PAstd[42,day01]"                         
[1434] "r_record_id__sigma_PAstd[43,day01]"                         
[1435] "r_record_id__sigma_PAstd[44,day01]"                         
[1436] "r_record_id__sigma_PAstd[46,day01]"                         
[1437] "r_record_id__sigma_PAstd[47,day01]"                         
[1438] "r_record_id__sigma_PAstd[48,day01]"                         
[1439] "r_record_id__sigma_PAstd[49,day01]"                         
[1440] "r_record_id__sigma_PAstd[50,day01]"                         
[1441] "r_record_id__sigma_PAstd[51,day01]"                         
[1442] "r_record_id__sigma_PAstd[52,day01]"                         
[1443] "r_record_id__sigma_PAstd[53,day01]"                         
[1444] "r_record_id__sigma_PAstd[54,day01]"                         
[1445] "r_record_id__sigma_PAstd[55,day01]"                         
[1446] "r_record_id__sigma_PAstd[56,day01]"                         
[1447] "r_record_id__sigma_PAstd[58,day01]"                         
[1448] "r_record_id__sigma_PAstd[60,day01]"                         
[1449] "r_record_id__sigma_PAstd[64,day01]"                         
[1450] "r_record_id__sigma_PAstd[65,day01]"                         
[1451] "r_record_id__sigma_PAstd[67,day01]"                         
[1452] "r_record_id__sigma_PAstd[68,day01]"                         
[1453] "r_record_id__sigma_PAstd[69,day01]"                         
[1454] "r_record_id__sigma_PAstd[70,day01]"                         
[1455] "r_record_id__sigma_PAstd[72,day01]"                         
[1456] "r_record_id__sigma_PAstd[73,day01]"                         
[1457] "r_record_id__sigma_PAstd[75,day01]"                         
[1458] "r_record_id__sigma_PAstd[76,day01]"                         
[1459] "r_record_id__sigma_PAstd[80,day01]"                         
[1460] "r_record_id__sigma_PAstd[81,day01]"                         
[1461] "r_record_id__sigma_PAstd[82,day01]"                         
[1462] "r_record_id__sigma_PAstd[83,day01]"                         
[1463] "r_record_id__sigma_PAstd[85,day01]"                         
[1464] "r_record_id__sigma_PAstd[86,day01]"                         
[1465] "r_record_id__sigma_PAstd[88,day01]"                         
[1466] "r_record_id__sigma_PAstd[91,day01]"                         
[1467] "r_record_id__sigma_PAstd[92,day01]"                         
[1468] "r_record_id__sigma_PAstd[94,day01]"                         
[1469] "r_record_id__sigma_PAstd[95,day01]"                         
[1470] "r_record_id__sigma_PAstd[96,day01]"                         
[1471] "r_record_id__sigma_PAstd[97,day01]"                         
[1472] "r_record_id__sigma_PAstd[98,day01]"                         
[1473] "r_record_id__sigma_PAstd[99,day01]"                         
[1474] "r_record_id__sigma_PAstd[100,day01]"                        
[1475] "r_record_id__sigma_PAstd[101,day01]"                        
[1476] "r_record_id__sigma_PAstd[102,day01]"                        
[1477] "r_record_id__sigma_PAstd[104,day01]"                        
[1478] "r_record_id__sigma_PAstd[105,day01]"                        
[1479] "r_record_id__sigma_PAstd[106,day01]"                        
[1480] "r_record_id__sigma_PAstd[107,day01]"                        
[1481] "r_record_id__sigma_PAstd[109,day01]"                        
[1482] "r_record_id__sigma_PAstd[110,day01]"                        
[1483] "r_record_id__sigma_PAstd[111,day01]"                        
[1484] "r_record_id__sigma_PAstd[112,day01]"                        
[1485] "r_record_id__sigma_PAstd[113,day01]"                        
[1486] "r_record_id__sigma_PAstd[114,day01]"                        
[1487] "r_record_id__sigma_PAstd[115,day01]"                        
[1488] "r_record_id__sigma_PAstd[116,day01]"                        
[1489] "r_record_id__sigma_PAstd[117,day01]"                        
[1490] "r_record_id__sigma_PAstd[119,day01]"                        
[1491] "r_record_id__sigma_PAstd[120,day01]"                        
[1492] "r_record_id__sigma_PAstd[121,day01]"                        
[1493] "r_record_id__sigma_PAstd[123,day01]"                        
[1494] "r_record_id__sigma_PAstd[125,day01]"                        
[1495] "r_record_id__sigma_PAstd[127,day01]"                        
[1496] "r_record_id__sigma_PAstd[128,day01]"                        
[1497] "r_record_id__sigma_PAstd[129,day01]"                        
[1498] "r_record_id__sigma_PAstd[132,day01]"                        
[1499] "r_record_id__sigma_PAstd[133,day01]"                        
[1500] "r_record_id__sigma_PAstd[134,day01]"                        
[1501] "r_record_id__sigma_PAstd[135,day01]"                        
[1502] "r_record_id__sigma_PAstd[136,day01]"                        
[1503] "r_record_id__sigma_PAstd[137,day01]"                        
[1504] "r_record_id__sigma_PAstd[138,day01]"                        
[1505] "r_record_id__sigma_PAstd[139,day01]"                        
[1506] "r_record_id__sigma_PAstd[140,day01]"                        
[1507] "r_record_id__sigma_PAstd[142,day01]"                        
[1508] "r_record_id__sigma_PAstd[143,day01]"                        
[1509] "r_record_id__sigma_PAstd[144,day01]"                        
[1510] "r_record_id__sigma_PAstd[145,day01]"                        
[1511] "r_record_id__sigma_PAstd[147,day01]"                        
[1512] "r_record_id__sigma_PAstd[148,day01]"                        
[1513] "r_record_id__sigma_PAstd[149,day01]"                        
[1514] "r_record_id__sigma_PAstd[150,day01]"                        
[1515] "r_record_id__sigma_PAstd[151,day01]"                        
[1516] "r_record_id__sigma_PAstd[152,day01]"                        
[1517] "r_record_id__sigma_PAstd[153,day01]"                        
[1518] "r_record_id__sigma_PAstd[154,day01]"                        
[1519] "r_record_id__sigma_PAstd[155,day01]"                        
[1520] "r_record_id__sigma_PAstd[157,day01]"                        
[1521] "r_record_id__sigma_PAstd[158,day01]"                        
[1522] "r_record_id__sigma_PAstd[160,day01]"                        
[1523] "r_record_id__sigma_PAstd[162,day01]"                        
[1524] "r_record_id__sigma_PAstd[163,day01]"                        
[1525] "r_record_id__sigma_PAstd[164,day01]"                        
[1526] "r_record_id__sigma_PAstd[165,day01]"                        
[1527] "r_record_id__sigma_PAstd[166,day01]"                        
[1528] "r_record_id__sigma_PAstd[167,day01]"                        
[1529] "r_record_id__sigma_PAstd[168,day01]"                        
[1530] "r_record_id__sigma_PAstd[169,day01]"                        
[1531] "r_record_id__sigma_PAstd[170,day01]"                        
[1532] "r_record_id__sigma_PAstd[171,day01]"                        
[1533] "r_record_id__sigma_PAstd[173,day01]"                        
[1534] "r_record_id__sigma_PAstd[174,day01]"                        
[1535] "r_record_id__sigma_PAstd[176,day01]"                        
[1536] "r_record_id__sigma_PAstd[177,day01]"                        
[1537] "r_record_id__sigma_PAstd[178,day01]"                        
[1538] "r_record_id__sigma_PAstd[181,day01]"                        
[1539] "r_record_id__sigma_PAstd[182,day01]"                        
[1540] "r_record_id__sigma_PAstd[183,day01]"                        
[1541] "r_record_id__sigma_PAstd[184,day01]"                        
[1542] "r_record_id__sigma_PAstd[185,day01]"                        
[1543] "r_record_id__sigma_PAstd[186,day01]"                        
[1544] "r_record_id__sigma_PAstd[188,day01]"                        
[1545] "r_record_id__sigma_PAstd[189,day01]"                        
[1546] "r_record_id__sigma_PAstd[190,day01]"                        
[1547] "r_record_id__sigma_PAstd[191,day01]"                        
[1548] "r_record_id__sigma_PAstd[194,day01]"                        
[1549] "r_record_id__sigma_PAstd[195,day01]"                        
[1550] "r_record_id__sigma_PAstd[196,day01]"                        
[1551] "r_record_id__sigma_PAstd[197,day01]"                        
[1552] "r_record_id__sigma_PAstd[198,day01]"                        
[1553] "r_record_id__sigma_PAstd[199,day01]"                        
[1554] "r_record_id__sigma_PAstd[201,day01]"                        
[1555] "r_record_id__sigma_PAstd[202,day01]"                        
[1556] "r_record_id__sigma_PAstd[203,day01]"                        
[1557] "r_record_id__sigma_PAstd[204,day01]"                        
[1558] "r_record_id__sigma_PAstd[205,day01]"                        
[1559] "r_record_id__sigma_PAstd[206,day01]"                        
[1560] "r_record_id__sigma_PAstd[207,day01]"                        
[1561] "r_record_id__sigma_PAstd[208,day01]"                        
[1562] "r_record_id__sigma_PAstd[209,day01]"                        
[1563] "r_record_id__sigma_PAstd[211,day01]"                        
[1564] "r_record_id__sigma_PAstd[212,day01]"                        
[1565] "r_record_id__sigma_PAstd[213,day01]"                        
[1566] "r_record_id__sigma_PAstd[214,day01]"                        
[1567] "r_record_id__sigma_PAstd[216,day01]"                        
[1568] "r_record_id__sigma_PAstd[217,day01]"                        
[1569] "r_record_id__sigma_PAstd[219,day01]"                        
[1570] "r_record_id__sigma_PAstd[220,day01]"                        
[1571] "r_record_id__sigma_PAstd[221,day01]"                        
[1572] "r_record_id__sigma_PAstd[222,day01]"                        
[1573] "r_record_id__sigma_PAstd[223,day01]"                        
[1574] "r_record_id__sigma_PAstd[224,day01]"                        
[1575] "r_record_id__sigma_PAstd[225,day01]"                        
[1576] "r_record_id__sigma_PAstd[226,day01]"                        
[1577] "r_record_id__sigma_PAstd[227,day01]"                        
[1578] "r_record_id__sigma_PAstd[228,day01]"                        
[1579] "r_record_id__sigma_PAstd[229,day01]"                        
[1580] "r_record_id__sigma_PAstd[230,day01]"                        
[1581] "r_record_id__sigma_PAstd[231,day01]"                        
[1582] "r_record_id__sigma_PAstd[232,day01]"                        
[1583] "r_record_id__sigma_PAstd[233,day01]"                        
[1584] "r_record_id__sigma_PAstd[234,day01]"                        
[1585] "r_record_id__sigma_PAstd[236,day01]"                        
[1586] "r_record_id__sigma_PAstd[237,day01]"                        
[1587] "r_record_id__sigma_PAstd[238,day01]"                        
[1588] "r_record_id__sigma_PAstd[239,day01]"                        
[1589] "lprior"                                                     
[1590] "lp__"                                                       
[1591] "accept_stat__"                                              
[1592] "treedepth__"                                                
[1593] "stepsize__"                                                 
[1594] "divergent__"                                                
[1595] "n_leapfrog__"                                               
[1596] "energy__"                                                   </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"beta[0]^'NA'"</span>, <span class="st">"beta[1]^'NA'"</span>, <span class="st">"sigma[0]^'NA'"</span>, <span class="st">"sigma[1]^'NA'"</span>,</span>
<span id="cb159-2"><a href="#cb159-2"></a>            <span class="st">"beta[0]^'PA'"</span>, <span class="st">"beta[1]^'PA'"</span>, <span class="st">"sigma[0]^'PA'"</span>, <span class="st">"sigma[1]^'PA'"</span>)</span>
<span id="cb159-3"><a href="#cb159-3"></a></span>
<span id="cb159-4"><a href="#cb159-4"></a><span class="co"># two different options for ordering the parameters</span></span>
<span id="cb159-5"><a href="#cb159-5"></a><span class="co"># levels &lt;- c("beta[0]^'NA'", "beta[1]^'NA'", "beta[0]^'PA'", "beta[1]^'PA'", "eta[0]^'NA'", "eta[1]^'NA'", "eta[0]^'PA'", "eta[1]^'PA'")</span></span>
<span id="cb159-6"><a href="#cb159-6"></a><span class="co"># levels &lt;- c("beta[0]^'NA'", "beta[0]^'PA'", "beta[1]^'NA'", "beta[1]^'PA'","eta[0]^'NA'", "eta[0]^'PA'", "eta[1]^'NA'", "eta[1]^'PA'")</span></span>
<span id="cb159-7"><a href="#cb159-7"></a></span>
<span id="cb159-8"><a href="#cb159-8"></a>rho <span class="ot">&lt;-</span></span>
<span id="cb159-9"><a href="#cb159-9"></a>  <span class="fu">posterior_summary</span>(melsm<span class="fl">.4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-10"><a href="#cb159-10"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb159-11"><a href="#cb159-11"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"param"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-12"><a href="#cb159-12"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(param, <span class="st">"cor_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-13"><a href="#cb159-13"></a>  <span class="fu">mutate</span>(<span class="at">param =</span> <span class="fu">str_remove</span>(param, <span class="st">"cor_record_id__"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-14"><a href="#cb159-14"></a>  <span class="fu">separate</span>(param, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>), <span class="at">sep =</span> <span class="st">"__"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-15"><a href="#cb159-15"></a>  <span class="fu">mutate</span>(</span>
<span id="cb159-16"><a href="#cb159-16"></a>    <span class="at">left =</span> <span class="fu">case_when</span>(</span>
<span id="cb159-17"><a href="#cb159-17"></a>      left <span class="sc">==</span> <span class="st">"NAstd_Intercept"</span>       <span class="sc">~</span> <span class="st">"beta[0]^'NA'"</span>,</span>
<span id="cb159-18"><a href="#cb159-18"></a>      left <span class="sc">==</span> <span class="st">"NAstd_day01"</span>           <span class="sc">~</span> <span class="st">"beta[1]^'NA'"</span>,</span>
<span id="cb159-19"><a href="#cb159-19"></a>      left <span class="sc">==</span> <span class="st">"sigma_NAstd_Intercept"</span> <span class="sc">~</span> <span class="st">"sigma[0]^'NA'"</span>,</span>
<span id="cb159-20"><a href="#cb159-20"></a>      left <span class="sc">==</span> <span class="st">"sigma_NAstd_day01"</span>     <span class="sc">~</span> <span class="st">"sigma[1]^'NA'"</span>,</span>
<span id="cb159-21"><a href="#cb159-21"></a>      left <span class="sc">==</span> <span class="st">"PAstd_Intercept"</span>       <span class="sc">~</span> <span class="st">"beta[0]^'PA'"</span>,</span>
<span id="cb159-22"><a href="#cb159-22"></a>      left <span class="sc">==</span> <span class="st">"PAstd_day01"</span>           <span class="sc">~</span> <span class="st">"beta[1]^'PA'"</span>,</span>
<span id="cb159-23"><a href="#cb159-23"></a>      left <span class="sc">==</span> <span class="st">"sigma_PAstd_Intercept"</span> <span class="sc">~</span> <span class="st">"sigma[0]^'PA'"</span>,</span>
<span id="cb159-24"><a href="#cb159-24"></a>      left <span class="sc">==</span> <span class="st">"sigma_PAstd_day01"</span>     <span class="sc">~</span> <span class="st">"sigma[1]^'PA'"</span></span>
<span id="cb159-25"><a href="#cb159-25"></a>      ),</span>
<span id="cb159-26"><a href="#cb159-26"></a>    <span class="at">right =</span> <span class="fu">case_when</span>(</span>
<span id="cb159-27"><a href="#cb159-27"></a>      right <span class="sc">==</span> <span class="st">"NAstd_Intercept"</span>       <span class="sc">~</span> <span class="st">"beta[0]^'NA'"</span>,</span>
<span id="cb159-28"><a href="#cb159-28"></a>      right <span class="sc">==</span> <span class="st">"NAstd_day01"</span>           <span class="sc">~</span> <span class="st">"beta[1]^'NA'"</span>,</span>
<span id="cb159-29"><a href="#cb159-29"></a>      right <span class="sc">==</span> <span class="st">"sigma_NAstd_Intercept"</span> <span class="sc">~</span> <span class="st">"sigma[0]^'NA'"</span>,</span>
<span id="cb159-30"><a href="#cb159-30"></a>      right <span class="sc">==</span> <span class="st">"sigma_NAstd_day01"</span>     <span class="sc">~</span> <span class="st">"sigma[1]^'NA'"</span>,</span>
<span id="cb159-31"><a href="#cb159-31"></a>      right <span class="sc">==</span> <span class="st">"PAstd_Intercept"</span>       <span class="sc">~</span> <span class="st">"beta[0]^'PA'"</span>,</span>
<span id="cb159-32"><a href="#cb159-32"></a>      right <span class="sc">==</span> <span class="st">"PAstd_day01"</span>           <span class="sc">~</span> <span class="st">"beta[1]^'PA'"</span>,</span>
<span id="cb159-33"><a href="#cb159-33"></a>      right <span class="sc">==</span> <span class="st">"sigma_PAstd_Intercept"</span> <span class="sc">~</span> <span class="st">"sigma[0]^'PA'"</span>,</span>
<span id="cb159-34"><a href="#cb159-34"></a>      right <span class="sc">==</span> <span class="st">"sigma_PAstd_day01"</span>     <span class="sc">~</span> <span class="st">"sigma[1]^'PA'"</span></span>
<span id="cb159-35"><a href="#cb159-35"></a>    )</span>
<span id="cb159-36"><a href="#cb159-36"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb159-37"><a href="#cb159-37"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">formatC</span>(Estimate, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">format =</span> <span class="st">"f"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace</span>(., <span class="st">"0."</span>, <span class="st">"."</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-38"><a href="#cb159-38"></a>  <span class="fu">mutate</span>(<span class="at">left  =</span> <span class="fu">factor</span>(left, <span class="at">levels =</span> levels),</span>
<span id="cb159-39"><a href="#cb159-39"></a>         <span class="at">right =</span> <span class="fu">factor</span>(right, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-40"><a href="#cb159-40"></a>  <span class="fu">mutate</span>(<span class="at">right =</span> <span class="fu">fct_rev</span>(right))</span>
<span id="cb159-41"><a href="#cb159-41"></a></span>
<span id="cb159-42"><a href="#cb159-42"></a>rho <span class="sc">%&gt;%</span> </span>
<span id="cb159-43"><a href="#cb159-43"></a>  <span class="fu">full_join</span>(<span class="fu">rename</span>(rho, <span class="at">right =</span> left, <span class="at">left =</span> right),</span>
<span id="cb159-44"><a href="#cb159-44"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>, <span class="st">"Estimate"</span>, <span class="st">"Est.Error"</span>, <span class="st">"Q2.5"</span>, <span class="st">"Q97.5"</span>, <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb159-45"><a href="#cb159-45"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> left, <span class="at">y =</span> right)) <span class="sc">+</span></span>
<span id="cb159-46"><a href="#cb159-46"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb159-47"><a href="#cb159-47"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"#100F14"</span>) <span class="sc">+</span></span>
<span id="cb159-48"><a href="#cb159-48"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">4.5</span>, <span class="at">color =</span> <span class="st">"#100F14"</span>) <span class="sc">+</span></span>
<span id="cb159-49"><a href="#cb159-49"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb159-50"><a href="#cb159-50"></a>            <span class="at">family =</span> <span class="st">"Courier"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb159-51"><a href="#cb159-51"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="fu">expression</span>(rho),</span>
<span id="cb159-52"><a href="#cb159-52"></a>                       <span class="at">low =</span> <span class="st">"#59708b"</span>, <span class="at">mid =</span> <span class="st">"#FCF9F0"</span>, <span class="at">high =</span> <span class="st">"#A65141"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb159-53"><a href="#cb159-53"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="st">""</span>, <span class="dv">0</span>, <span class="st">""</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb159-54"><a href="#cb159-54"></a>  <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe, <span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb159-55"><a href="#cb159-55"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe) <span class="sc">+</span></span>
<span id="cb159-56"><a href="#cb159-56"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb159-57"><a href="#cb159-57"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb159-58"><a href="#cb159-58"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-109-1.png" width="960" class="r-stretch"></section>
<section id="missing-data" class="slide level2">
<h2>Missing data</h2>
<p>How to solve? 1. Listwise 2. Estimation algorithm eg FIML 3. Multiple Imputation (before you run the model) 4. Bayesian (while you run the model)</p>
</section>
<section id="brms-and-multiple-imputation" class="slide level2">
<h2>brms and multiple imputation</h2>
<p>Each missing value is not imputed N times leading to a total of N fully imputed data sets. The model is fitted to each data sets separately and results are pooled across models.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb160-2"><a href="#cb160-2"></a><span class="co">#multivariate imputation by chained equations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<p>National Health and Nutrition Examination Survey</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="fu">data</span>(<span class="st">"nhanes"</span>)</span>
<span id="cb161-2"><a href="#cb161-2"></a>nhanes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   age  bmi hyp chl
1    1   NA  NA  NA
2    2 22.7   1 187
3    1   NA   1 187
4    3   NA  NA  NA
5    1 20.4   1 113
6    3   NA  NA 184
7    1 22.5   1 118
8    1 30.1   1 187
9    2 22.0   1 238
10   2   NA  NA  NA
11   1   NA  NA  NA
12   2   NA  NA  NA
13   3 21.7   1 206
14   2 28.7   2 204
15   1 29.6   1  NA
16   1   NA  NA  NA
17   3 27.2   2 284
18   2 26.3   2 199
19   1 35.3   1 218
20   3 25.5   2  NA
21   1   NA  NA  NA
22   1 33.2   1 229
23   1 27.5   1 131
24   3 24.9   1  NA
25   2 27.4   1 186</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a>nhanes.imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(nhanes, <span class="at">m =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  bmi  hyp  chl
  1   2  bmi  hyp  chl
  1   3  bmi  hyp  chl
  1   4  bmi  hyp  chl
  1   5  bmi  hyp  chl
  1   6  bmi  hyp  chl
  1   7  bmi  hyp  chl
  1   8  bmi  hyp  chl
  1   9  bmi  hyp  chl
  1   10  bmi  hyp  chl
  2   1  bmi  hyp  chl
  2   2  bmi  hyp  chl
  2   3  bmi  hyp  chl
  2   4  bmi  hyp  chl
  2   5  bmi  hyp  chl
  2   6  bmi  hyp  chl
  2   7  bmi  hyp  chl
  2   8  bmi  hyp  chl
  2   9  bmi  hyp  chl
  2   10  bmi  hyp  chl
  3   1  bmi  hyp  chl
  3   2  bmi  hyp  chl
  3   3  bmi  hyp  chl
  3   4  bmi  hyp  chl
  3   5  bmi  hyp  chl
  3   6  bmi  hyp  chl
  3   7  bmi  hyp  chl
  3   8  bmi  hyp  chl
  3   9  bmi  hyp  chl
  3   10  bmi  hyp  chl
  4   1  bmi  hyp  chl
  4   2  bmi  hyp  chl
  4   3  bmi  hyp  chl
  4   4  bmi  hyp  chl
  4   5  bmi  hyp  chl
  4   6  bmi  hyp  chl
  4   7  bmi  hyp  chl
  4   8  bmi  hyp  chl
  4   9  bmi  hyp  chl
  4   10  bmi  hyp  chl
  5   1  bmi  hyp  chl
  5   2  bmi  hyp  chl
  5   3  bmi  hyp  chl
  5   4  bmi  hyp  chl
  5   5  bmi  hyp  chl
  5   6  bmi  hyp  chl
  5   7  bmi  hyp  chl
  5   8  bmi  hyp  chl
  5   9  bmi  hyp  chl
  5   10  bmi  hyp  chl</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>nhanes.imp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  10 
Imputation methods:
  age   bmi   hyp   chl 
   "" "pmm" "pmm" "pmm" 
PredictorMatrix:
    age bmi hyp chl
age   0   1   1   1
bmi   1   0   1   1
hyp   1   1   0   1
chl   1   1   1   0</code></pre>
</div>
</div>
<p>mids = multiple impudated data set ppm = predictive mean matching. Uses a datapoint from the original, nonmissing data which has a predicted value close to the predicted value of the missing sample</p>
</section>
<section class="slide level2">

<p>One you have the 10 datasets you run the model seperate in each of them.</p>
<p>Then you need to pool your estimates.</p>
<p>Common issue is how to pool? Some options: mice::pool() combines them Rubin’s rules. broom.mixed (another other packages) automatically incorporates the mids and does it for you</p>
</section>
<section id="brm_multiple" class="slide level2">
<h2>brm_multiple</h2>
<p>works well with mice objects, but brm_multiple also takes any list of dataframes. Helpful if you use amelia or mi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a>imp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">brm_multiple</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb167-2"><a href="#cb167-2"></a>                      bmi <span class="sc">~</span> age<span class="sc">*</span>chl, </span>
<span id="cb167-3"><a href="#cb167-3"></a>                      <span class="at">data =</span> nhanes.imp,</span>
<span id="cb167-4"><a href="#cb167-4"></a>                      <span class="at">cores =</span> <span class="dv">4</span>, </span>
<span id="cb167-5"><a href="#cb167-5"></a>                      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb167-6"><a href="#cb167-6"></a>                      <span class="at">file =</span> <span class="st">"imp.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Pooling across models is trivial in a Bayesian framework but not in frequentist. 40 Chains! 40k samples! (10 datasets + default 4 chains and 1k samples)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a><span class="fu">summary</span>(imp<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: bmi ~ age * chl 
   Data: nhanes.imp (Number of observations: 25) 
  Draws: 40 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 40000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    16.44      8.37     0.49    34.03 1.05      504      901
age           0.31      4.95    -9.84    10.12 1.05      476     1163
chl           0.08      0.04    -0.01     0.16 1.10      248      755
age:chl      -0.02      0.02    -0.06     0.03 1.04      568      853

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     3.51      0.74     2.34     5.17 1.33       93      616

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="fu">plot</span>(imp<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-116-1.png" width="960" class="r-stretch"></section>
<section id="revisting-bayesian-updating" class="slide level2">
<h2>Revisting bayesian updating</h2>
<p>Remember the posterior can be thought of as a new prior for your next data aquisition. You could do this one datapoint at a time (remember globe tossing model in SR?), or a dataset at the time.</p>
</section>
<section id="bayesian-imputation-within-brms" class="slide level2">
<h2>Bayesian imputation within brms</h2>
<ol type="1">
<li>Which variables contain missingness? 2) Which variables should predict missingness 3) what imputed variables are used as predictors</li>
</ol>
<p>Taking care of this in brms ends up creating a multivariate model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>bform <span class="ot">&lt;-</span> <span class="fu">bf</span>(bmi <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> age <span class="sc">*</span> <span class="fu">mi</span>(chl)) <span class="sc">+</span></span>
<span id="cb171-2"><a href="#cb171-2"></a>  <span class="fu">bf</span>(chl <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> age) <span class="sc">+</span> <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>)</span>
<span id="cb171-3"><a href="#cb171-3"></a>imp<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(bform, <span class="at">data =</span> nhanes, <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">file =</span> <span class="st">"imp.2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a><span class="fu">summary</span>(imp<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: bmi | mi() ~ age * mi(chl) 
         chl | mi() ~ age 
   Data: nhanes (Number of observations: 25) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
bmi_Intercept    14.46      9.08    -3.20    32.75 1.00     1615     1879
chl_Intercept   141.67     26.14    90.82   194.48 1.00     2559     2482
bmi_age           2.43      5.65    -8.92    13.76 1.00     1452     1899
chl_age          28.52     14.09    -0.10    56.07 1.00     2411     2362
bmi_michl         0.09      0.05    -0.00     0.18 1.00     1748     1726
bmi_michl:age    -0.03      0.03    -0.08     0.02 1.00     1505     1964

Family Specific Parameters: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_bmi     3.42      0.79     2.23     5.31 1.00     1377     2426
sigma_chl    40.58      7.64    28.64    57.87 1.00     2020     2216

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="pro-v-con" class="slide level2">
<h2>pro v con</h2>
<p>Pros: Can use multilevel structure and complex non-linear relationships for the imputation of missing values, which is not achieved as easily in standard multiple imputation software</p>
<p>Cons: cannot impute discrete values within brms/Stan</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a><span class="fu">posterior_summary</span>(imp<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Estimate   Est.Error          Q2.5         Q97.5
b_bmi_Intercept     14.4591074  9.08090469   -3.20165900   32.74867250
b_chl_Intercept    141.6748592 26.14297738   90.82400000  194.47805000
b_bmi_age            2.4251926  5.65200947   -8.91944050   13.75536000
b_chl_age           28.5234038 14.09242769   -0.09612572   56.07263750
bsp_bmi_michl        0.0948538  0.04684183   -0.00323185    0.18366243
bsp_bmi_michl:age   -0.0285184  0.02559316   -0.07924430    0.02316548
sigma_bmi            3.4184732  0.79489880    2.23142050    5.31090025
sigma_chl           40.5833620  7.63844893   28.63949250   57.86753500
Ymi_bmi[1]          28.1447518  4.84885167   18.48626250   37.51875000
Ymi_bmi[3]          29.3169290  3.79252914   21.56832750   36.65267250
Ymi_bmi[4]          23.9270943  4.41025100   14.98178750   32.74964750
Ymi_bmi[6]          23.3925528  4.32257106   14.97056250   32.37035750
Ymi_bmi[10]         26.7795826  4.17377915   18.64247250   35.08256250
Ymi_bmi[11]         28.0841860  4.75509184   18.79971750   37.32064500
Ymi_bmi[12]         26.8586299  4.05632635   18.89402500   34.82299250
Ymi_bmi[16]         28.1227661  4.91823786   18.11951750   37.64864250
Ymi_bmi[21]         28.1432917  4.87059606   18.43097500   37.91461500
Ymi_chl[1]         170.1808358 42.94896613   85.25748250  255.74992500
Ymi_chl[4]         228.0284563 46.18599202  138.88920000  321.38625000
Ymi_chl[10]        198.9250266 41.91403089  115.55302500  281.47977500
Ymi_chl[11]        169.3564533 42.44904610   86.50947000  251.77840000
Ymi_chl[12]        199.2061987 42.98538452  113.78160000  282.11952500
Ymi_chl[15]        178.9986583 34.23943087  109.82895000  248.57720000
Ymi_chl[16]        170.2052876 44.38653129   79.98825750  257.58227500
Ymi_chl[20]        228.6919434 43.75167795  144.83655000  313.97135000
Ymi_chl[21]        169.7353477 42.88077802   85.39599000  253.84697500
Ymi_chl[24]        228.6338315 44.02926029  138.22152500  312.37475000
lprior             -15.3164881  1.03419222  -17.55171000  -13.66898000
lp__              -203.7545315  5.04160926 -214.92505000 -195.12785000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a>imp<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb176-2"><a href="#cb176-2"></a>  <span class="fu">spread_draws</span>(Ymi_chl[ID]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40,000 × 5
# Groups:   ID [10]
      ID Ymi_chl .chain .iteration .draw
   &lt;int&gt;   &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     1   158.       1          1     1
 2     1   145.       1          2     2
 3     1    93.1      1          3     3
 4     1   181.       1          4     4
 5     1   131.       1          5     5
 6     1    93.7      1          6     6
 7     1   137.       1          7     7
 8     1   143.       1          8     8
 9     1   177.       1          9     9
10     1   198.       1         10    10
# ℹ 39,990 more rows</code></pre>
</div>
</div>
<p>4000* * 10 (missing for chl) = 40,000</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a>imp<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="#cb178-2"></a>  <span class="fu">spread_draws</span>(Ymi_chl[ID]) <span class="sc">%&gt;%</span> </span>
<span id="cb178-3"><a href="#cb178-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Ymi_chl, </span>
<span id="cb178-4"><a href="#cb178-4"></a>             <span class="at">y =</span> <span class="fu">reorder</span>(ID, Ymi_chl))) <span class="sc">+</span></span>
<span id="cb178-5"><a href="#cb178-5"></a>  <span class="fu">stat_slab</span>(<span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">height =</span> <span class="fl">1.6</span>, <span class="at">slab_color =</span> <span class="st">"black"</span>, <span class="at">slab_size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb178-6"><a href="#cb178-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chl imputed values"</span>, <span class="at">y =</span> <span class="st">"IDs"</span>) <span class="sc">+</span></span>
<span id="cb178-7"><a href="#cb178-7"></a>  <span class="fu">theme_ggdist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-121-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a>imp<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb179-2"><a href="#cb179-2"></a>  <span class="fu">spread_draws</span>(Ymi_bmi[ID]) <span class="sc">%&gt;%</span> </span>
<span id="cb179-3"><a href="#cb179-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Ymi_bmi, </span>
<span id="cb179-4"><a href="#cb179-4"></a>             <span class="at">y =</span> <span class="fu">reorder</span>(ID, Ymi_bmi))) <span class="sc">+</span></span>
<span id="cb179-5"><a href="#cb179-5"></a>  <span class="fu">stat_slab</span>(<span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">height =</span> <span class="fl">1.6</span>, <span class="at">slab_color =</span> <span class="st">"black"</span>, <span class="at">slab_size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb179-6"><a href="#cb179-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"BMI imputed values"</span>, <span class="at">y =</span> <span class="st">"IDs"</span>) <span class="sc">+</span></span>
<span id="cb179-7"><a href="#cb179-7"></a>  <span class="fu">theme_ggdist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>

<img data-src="adv-9_files/figure-revealjs/unnamed-chunk-122-1.png" width="960" class="r-stretch"><div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>